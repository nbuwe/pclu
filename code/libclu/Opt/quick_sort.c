
/* This file was automatically generated by pclu.*/

#include "pclu_err.h"
#include "pclu_sys.h"



typedef struct {
long count;
} quick_sort_of_t_REQS;

quick_sort_of_t_REQS quick_sort_of_t_reqs_actual = {0};

struct REQS * quick_sort_of_t_reqs = (struct REQS *)&quick_sort_of_t_reqs_actual;


typedef struct {
    long count;
    OWNPTR type_owns;
    OWNPTR op_owns;
    } quick_sort_of_t_OPS;

extern errcode intOPadd();
extern errcode intOPsub();
extern errcode intOPle();
extern errcode intOPequal();
extern errcode arrayOPfetch();
extern errcode arrayOPaddh();
extern errcode arrayOPstore();
extern errcode arrayOPremh();
extern errcode intOPdiv();
extern errcode boolOPnot();
extern errcode quick_sort();
extern struct REQS *quick_sort_of_t_reqs;
extern OWN_req quick_sort_ownreqs;

typedef struct {
    long quick_sort_own_init;
    quick_sort_of_t_OPS *t_ops;
    struct OPS *quick_sort_of_t_table;
    struct OPS *quick_sort_of_t_ops;
    OWNPTR quick_sort_of_t_owns;
    } quick_sort_OWN_DEFN;
OWN_req quick_sort_ownreqs = {sizeof(quick_sort_OWN_DEFN), 1};


/**** BEGIN PROCEDURE quick_sort ****/

errcode quick_sort(a, low, high, less, equal)
CLUREF a;
CLUREF low;
CLUREF high;
CLUREF less;
CLUREF equal;
    {
    errcode err;
    errcode ecode2;
    quick_sort_OWN_DEFN *op_own_ptr;
    CLUREF olow;
    CLUREF ohigh;
    CLUREF size;
    CLUREF split;
    CLUREF mid;
    CLUREF val;
    op_own_ptr = (quick_sort_OWN_DEFN*) CUR_PROC_VAR.proc->op_owns;
        if (op_own_ptr->quick_sort_own_init == 0) {
        add_parm_info_type(0, op_own_ptr->t_ops, quick_sort_of_t_reqs);
        find_prociter_instance(quick_sort, 1, &quick_sort_ownreqs, &(op_own_ptr->quick_sort_of_t_ops));
        }
        if (op_own_ptr->quick_sort_own_init == 0) {
        op_own_ptr->quick_sort_own_init = 1;
    }
    enter_proc(2);

  LINE(6);
    {
        {olow.num = low.num;
        }
        }

  LINE(7);
    {
        {ohigh.num = high.num;
        }
        }

  LINE(8);
    {
        {CLUREF T_1_1;
        CLUREF T_1_2;
        T_1_1.num = high.num - low.num;
         if ((T_1_1.num >= 0 && high.num < 0 && (-low.num) < 0) || 
             (T_1_1.num <= 0 && high.num > 0 && (-low.num) > 0)) {
            err = ERR_overflow;
            goto ex_0;}
        T_1_2.num = T_1_1.num + 1;
         if ((T_1_2.num > 0 && T_1_1.num < 0 && 1 < 0) || 
             (T_1_2.num < 0 && T_1_1.num > 0 && 1 > 0)) {
            err = ERR_overflow;
            goto ex_0;}
        size.num = T_1_2.num;
        }
        }

  LINE(9);
    {
    CLUREF T_1_1;
    T_1_1.num = (size.num <= 1)? true : false;
    if (T_1_1.num == true) {
        {
        {signal (ERR_ok);}}
        }
    else {
    CLUREF T_1_2;
    T_1_2.num = (size.num == 2)? true : false;
    if (T_1_2.num == true) {

  LINE(11);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        if (high.num < a.array->ext_low || high.num > a.array->ext_high ) {
            err = ERR_bounds;
            goto ex_0;}
        T_2_1.num = a.array->store->data[high.num - a.array->ext_low + a.array->int_low];
        if (low.num < a.array->ext_low || low.num > a.array->ext_high ) {
            err = ERR_bounds;
            goto ex_0;}
        T_2_2.num = a.array->store->data[low.num - a.array->ext_low + a.array->int_low];
        CUR_PROC_VAR = less;
        err = less.proc->proc(T_2_1, T_2_2, &T_2_3);
        if (err != ERR_ok) goto ex_0;
        if (T_2_3.num == true) {

  LINE(12);
            {
            CLUREF T_3_1;
            if (low.num < a.array->ext_low || low.num > a.array->ext_high ) {
                err = ERR_bounds;
                goto ex_0;}
            T_3_1.num = a.array->store->data[low.num - a.array->ext_low + a.array->int_low];
            {
            if ((a.array->int_low + a.array->ext_size + 1) < a.array->int_size) {
                a.array->store->data[a.array->int_low + a.array->ext_size] = T_3_1.num;
                a.array->ext_size++; a.array->ext_high++;}
            else {
                err = arrayOPaddh(a, T_3_1);
                if (err != ERR_ok) goto ex_0;}
            }
            }

  LINE(13);
            {
            CLUREF T_3_1;
            if (high.num < a.array->ext_low || high.num > a.array->ext_high ) {
                err = ERR_bounds;
                goto ex_0;}
            T_3_1.num = a.array->store->data[high.num - a.array->ext_low + a.array->int_low];
            {
            if (low.num < a.array->ext_low || low.num > a.array->ext_high) {
                err = ERR_bounds;
                goto ex_0;}
            a.array->store->data[low.num + a.array->int_low - a.array->ext_low] = T_3_1.num;
            }
            }

  LINE(14);
            {
            CLUREF T_3_1;
            err = arrayOPremh(a, &T_3_1);
            if (err != ERR_ok) goto ex_0;
            {
            if (high.num < a.array->ext_low || high.num > a.array->ext_high) {
                err = ERR_bounds;
                goto ex_0;}
            a.array->store->data[high.num + a.array->int_low - a.array->ext_low] = T_3_1.num;
            }
            }
            }
            }/* end if */

  LINE(16);
        {
        {signal (ERR_ok);}}
        }
        }}/* end if */

  LINE(18);
    {
        {CLUREF T_1_1;
        CLUREF T_1_2;
        CLUREF T_1_3;
        err = intOPdiv(size, CLU_2, &T_1_1);
        if (err != ERR_ok) goto ex_0;
        T_1_2.num = low.num + T_1_1.num;
         if ((T_1_2.num > 0 && low.num < 0 && T_1_1.num < 0) || 
             (T_1_2.num < 0 && low.num > 0 && T_1_1.num > 0)) {
            err = ERR_overflow;
            goto ex_0;}
        if (T_1_2.num < a.array->ext_low || T_1_2.num > a.array->ext_high ) {
            err = ERR_bounds;
            goto ex_0;}
        T_1_3.num = a.array->store->data[T_1_2.num - a.array->ext_low + a.array->int_low];
        split.num = T_1_3.num;
        }
        }

  LINE(19);
    {
        {mid.num = low.num;
        }
        }

  LINE(20);
    for (;;) {
        CLUREF T_1_1;
        T_1_1.num = (mid.num <= high.num)? true : false;
        if (T_1_1.num != true) { break; }

  LINE(21);
        {
            {CLUREF T_2_1;
            if (mid.num < a.array->ext_low || mid.num > a.array->ext_high ) {
                err = ERR_bounds;
                goto ex_0;}
            T_2_1.num = a.array->store->data[mid.num - a.array->ext_low + a.array->int_low];
            val.num = T_2_1.num;
            }
            }

  LINE(22);
        {
        CLUREF T_2_1;
        CUR_PROC_VAR = less;
        err = less.proc->proc(val, split, &T_2_1);
        if (err != ERR_ok) goto ex_0;
        if (T_2_1.num == true) {

  LINE(23);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = (low.num == mid.num)? true : false;
            T_3_2.num = T_3_1.num ^ 1;
            if (T_3_2.num == true) {

  LINE(24);
                {
                CLUREF T_4_1;
                if (low.num < a.array->ext_low || low.num > a.array->ext_high ) {
                    err = ERR_bounds;
                    goto ex_0;}
                T_4_1.num = a.array->store->data[low.num - a.array->ext_low + a.array->int_low];
                {
                if ((a.array->int_low + a.array->ext_size + 1) < a.array->int_size) {
                    a.array->store->data[a.array->int_low + a.array->ext_size] = T_4_1.num;
                    a.array->ext_size++; a.array->ext_high++;}
                else {
                    err = arrayOPaddh(a, T_4_1);
                    if (err != ERR_ok) goto ex_0;}
                }
                }

  LINE(25);
                {
                CLUREF T_4_1;
                if (mid.num < a.array->ext_low || mid.num > a.array->ext_high ) {
                    err = ERR_bounds;
                    goto ex_0;}
                T_4_1.num = a.array->store->data[mid.num - a.array->ext_low + a.array->int_low];
                {
                if (low.num < a.array->ext_low || low.num > a.array->ext_high) {
                    err = ERR_bounds;
                    goto ex_0;}
                a.array->store->data[low.num + a.array->int_low - a.array->ext_low] = T_4_1.num;
                }
                }

  LINE(26);
                {
                CLUREF T_4_1;
                err = arrayOPremh(a, &T_4_1);
                if (err != ERR_ok) goto ex_0;
                {
                if (mid.num < a.array->ext_low || mid.num > a.array->ext_high) {
                    err = ERR_bounds;
                    goto ex_0;}
                a.array->store->data[mid.num + a.array->int_low - a.array->ext_low] = T_4_1.num;
                }
                }
                }
                }/* end if */

  LINE(28);
            {
            CLUREF T_3_1;
            T_3_1.num = low.num + 1;
             if ((T_3_1.num > 0 && low.num < 0 && 1 < 0) || 
                 (T_3_1.num < 0 && low.num > 0 && 1 > 0)) {
                err = ERR_overflow;
                goto ex_0;}
            low.num = T_3_1.num;
            }

  LINE(29);
            {
            CLUREF T_3_1;
            T_3_1.num = mid.num + 1;
             if ((T_3_1.num > 0 && mid.num < 0 && 1 < 0) || 
                 (T_3_1.num < 0 && mid.num > 0 && 1 > 0)) {
                err = ERR_overflow;
                goto ex_0;}
            mid.num = T_3_1.num;
            }
            }
        else {
        CLUREF T_2_2;
        CUR_PROC_VAR = equal;
        err = equal.proc->proc(val, split, &T_2_2);
        if (err != ERR_ok) goto ex_0;
        if (T_2_2.num == true) {

  LINE(31);
            {
            CLUREF T_3_1;
            T_3_1.num = mid.num + 1;
             if ((T_3_1.num > 0 && mid.num < 0 && 1 < 0) || 
                 (T_3_1.num < 0 && mid.num > 0 && 1 > 0)) {
                err = ERR_overflow;
                goto ex_0;}
            mid.num = T_3_1.num;
            }
            }
        else {

  LINE(33);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = (mid.num == high.num)? true : false;
            T_3_2.num = T_3_1.num ^ 1;
            if (T_3_2.num == true) {

  LINE(34);
                {
                CLUREF T_4_1;
                if (mid.num < a.array->ext_low || mid.num > a.array->ext_high ) {
                    err = ERR_bounds;
                    goto ex_0;}
                T_4_1.num = a.array->store->data[mid.num - a.array->ext_low + a.array->int_low];
                {
                if ((a.array->int_low + a.array->ext_size + 1) < a.array->int_size) {
                    a.array->store->data[a.array->int_low + a.array->ext_size] = T_4_1.num;
                    a.array->ext_size++; a.array->ext_high++;}
                else {
                    err = arrayOPaddh(a, T_4_1);
                    if (err != ERR_ok) goto ex_0;}
                }
                }

  LINE(35);
                {
                CLUREF T_4_1;
                if (high.num < a.array->ext_low || high.num > a.array->ext_high ) {
                    err = ERR_bounds;
                    goto ex_0;}
                T_4_1.num = a.array->store->data[high.num - a.array->ext_low + a.array->int_low];
                {
                if (mid.num < a.array->ext_low || mid.num > a.array->ext_high) {
                    err = ERR_bounds;
                    goto ex_0;}
                a.array->store->data[mid.num + a.array->int_low - a.array->ext_low] = T_4_1.num;
                }
                }

  LINE(36);
                {
                CLUREF T_4_1;
                err = arrayOPremh(a, &T_4_1);
                if (err != ERR_ok) goto ex_0;
                {
                if (high.num < a.array->ext_low || high.num > a.array->ext_high) {
                    err = ERR_bounds;
                    goto ex_0;}
                a.array->store->data[high.num + a.array->int_low - a.array->ext_low] = T_4_1.num;
                }
                }
                }
                }/* end if */

  LINE(38);
            {
            CLUREF T_3_1;
            T_3_1.num = high.num - 1;
             if ((T_3_1.num >= 0 && high.num < 0 && (-1) < 0) || 
                 (T_3_1.num <= 0 && high.num > 0 && (-1) > 0)) {
                err = ERR_overflow;
                goto ex_0;}
            high.num = T_3_1.num;
            }
            }}}/* end if */
        }
        end_while_1:;

  LINE(41);
    {
    CLUREF T_1_1;
    T_1_1.num = low.num - 1;
     if ((T_1_1.num >= 0 && low.num < 0 && (-1) < 0) || 
         (T_1_1.num <= 0 && low.num > 0 && (-1) > 0)) {
        err = ERR_overflow;
        goto ex_0;}
    generic_CLU_proc.type_owns = 0;
    generic_CLU_proc.op_owns = (long)op_own_ptr->quick_sort_of_t_ops->op_owns;
    generic_CLU_proc.proc = quick_sort;
    CUR_PROC_VAR.proc = &generic_CLU_proc;
    err = quick_sort(a, olow, T_1_1, less, equal);
    if (err != ERR_ok) goto ex_0;
    }

  LINE(42);
    {
    CLUREF T_1_1;
    T_1_1.num = high.num + 1;
     if ((T_1_1.num > 0 && high.num < 0 && 1 < 0) || 
         (T_1_1.num < 0 && high.num > 0 && 1 > 0)) {
        err = ERR_overflow;
        goto ex_0;}
    generic_CLU_proc.type_owns = 0;
    generic_CLU_proc.op_owns = (long)op_own_ptr->quick_sort_of_t_ops->op_owns;
    generic_CLU_proc.proc = quick_sort;
    CUR_PROC_VAR.proc = &generic_CLU_proc;
    err = quick_sort(a, T_1_1, ohigh, less, equal);
    if (err != ERR_ok) goto ex_0;
    }
    goto end_0;
    ex_0:
        {
            if (err == ERR_failure) {signal(ERR_failure);}
            elist[0] = _pclu_erstr(err);
            {signal(ERR_failure);}
        }
    end_0: {signal(ERR_ok);}
    }

/**** END PROCEDURE quick_sort ****/

