
/* This file was automatically generated by pclu.*/

#include "pclu_err.h"
#include "pclu_sys.h"


extern errcode stringOPfetch();
extern errcode charOPequal();
extern errcode charOPge();
extern errcode charOPle();
extern errcode intOPsub();
extern errcode intOPmul();
extern errcode charOPc2i();
extern errcode intOPadd();
extern errcode intOPminus();

/**** BEGIN PROCEDURE i_hparse ****/

errcode i_hparse(s, ret_1)
CLUREF s;
CLUREF *ret_1;
    {
    errcode err;
    errcode ecode2;
    CLUREF num;
    CLUREF i;
    CLUREF sign;
    CLUREF c;
    enter_proc(3);

  LINE(7);
    {
        {num.num = 0;
        }
        }

  LINE(8);
    {
        {i.num = 1;
        }
        }

  LINE(9);
    {
        {CLUREF T_2_1;
        err = stringOPfetch(s, CLU_1, &T_2_1);
        if (err != ERR_ok) goto ex_1;
        sign.num = T_2_1.num;
        }
        }
        goto end_1;
        ex_1:
            if ((err == ERR_bounds)) {

  LINE(10);
                {
                {signal (ERR_bad_format);}}
            }
            else {
                goto ex_0;
            }
        end_1:;

  LINE(11);
    {
        {c.num = sign.num;
        }
        }

  LINE(12);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    CLUREF T_1_5;
    T_1_2.ch = '+';
    T_1_3.num = (sign.ch == T_1_2.ch)? true : false;
    T_1_1.num = T_1_3.num;
    if (!T_1_3.num) {
        T_1_4.ch = '-';
        T_1_5.num = (sign.ch == T_1_4.ch)? true : false;
        T_1_1.num = T_1_5.num;
    }
    if (T_1_1.num == true) {

  LINE(13);
        {
        i.num = 2;
        }

  LINE(14);
        {
        CLUREF T_3_1;
        err = stringOPfetch(s, CLU_2, &T_3_1);
        if (err != ERR_ok) goto ex_2;
        c.num = T_3_1.num;
        }
            goto end_2;
            ex_2:
                if ((err == ERR_bounds)) {

  LINE(15);
                    {
                    {signal (ERR_bad_format);}}
                }
                else {
                    goto ex_0;
                }
            end_2:;
        }
        }/* end if */

  LINE(17);
    for (;;) {
        if (true != true) { break; }

  LINE(18);
        {
        CLUREF T_4_1;
        CLUREF T_4_2;
        CLUREF T_4_3;
        CLUREF T_4_4;
        CLUREF T_4_5;
        T_4_2.ch = '0';
        err = charOPge(c, T_4_2, &T_4_3);
        if (err != ERR_ok) goto ex_4;
        T_4_1.num = T_4_3.num;
        if (T_4_3.num) {
            T_4_4.ch = '9';
            err = charOPle(c, T_4_4, &T_4_5);
            if (err != ERR_ok) goto ex_4;
            T_4_1.num = T_4_5.num;
        }
        if (T_4_1.num == true) {

  LINE(19);
            {
            CLUREF T_5_1;
            CLUREF T_5_2;
            CLUREF T_5_3;
            CLUREF T_5_4;
            err = intOPmul(num, CLU_16, &T_5_1);
            if (err != ERR_ok) goto ex_4;
            T_5_2.num = (long)(c.ch & 0xff);
            T_5_3.num = T_5_2.num - 48;
             if ((T_5_3.num >= 0 && T_5_2.num < 0 && (-48) < 0) || 
                 (T_5_3.num <= 0 && T_5_2.num > 0 && (-48) > 0)) {
                err = ERR_overflow;
                goto ex_4;}
            T_5_4.num = T_5_1.num - T_5_3.num;
             if ((T_5_4.num >= 0 && T_5_1.num < 0 && (-T_5_3.num) < 0) || 
                 (T_5_4.num <= 0 && T_5_1.num > 0 && (-T_5_3.num) > 0)) {
                err = ERR_overflow;
                goto ex_4;}
            num.num = T_5_4.num;
            }
            }
        else {
        CLUREF T_4_6;
        CLUREF T_4_7;
        CLUREF T_4_8;
        CLUREF T_4_9;
        CLUREF T_4_10;
        T_4_7.ch = 'A';
        err = charOPge(c, T_4_7, &T_4_8);
        if (err != ERR_ok) goto ex_4;
        T_4_6.num = T_4_8.num;
        if (T_4_8.num) {
            T_4_9.ch = 'F';
            err = charOPle(c, T_4_9, &T_4_10);
            if (err != ERR_ok) goto ex_4;
            T_4_6.num = T_4_10.num;
        }
        if (T_4_6.num == true) {

  LINE(21);
            {
            CLUREF T_5_1;
            CLUREF T_5_2;
            CLUREF T_5_3;
            CLUREF T_5_4;
            CLUREF T_5_5;
            err = intOPmul(num, CLU_16, &T_5_1);
            if (err != ERR_ok) goto ex_4;
            T_5_2.num = (long)(c.ch & 0xff);
            T_5_3.num = 55;
            T_5_4.num = T_5_2.num - T_5_3.num;
             if ((T_5_4.num >= 0 && T_5_2.num < 0 && (-T_5_3.num) < 0) || 
                 (T_5_4.num <= 0 && T_5_2.num > 0 && (-T_5_3.num) > 0)) {
                err = ERR_overflow;
                goto ex_4;}
            T_5_5.num = T_5_1.num - T_5_4.num;
             if ((T_5_5.num >= 0 && T_5_1.num < 0 && (-T_5_4.num) < 0) || 
                 (T_5_5.num <= 0 && T_5_1.num > 0 && (-T_5_4.num) > 0)) {
                err = ERR_overflow;
                goto ex_4;}
            num.num = T_5_5.num;
            }
            }
        else {
        CLUREF T_4_11;
        CLUREF T_4_12;
        CLUREF T_4_13;
        CLUREF T_4_14;
        CLUREF T_4_15;
        T_4_12.ch = 'a';
        err = charOPge(c, T_4_12, &T_4_13);
        if (err != ERR_ok) goto ex_4;
        T_4_11.num = T_4_13.num;
        if (T_4_13.num) {
            T_4_14.ch = 'f';
            err = charOPle(c, T_4_14, &T_4_15);
            if (err != ERR_ok) goto ex_4;
            T_4_11.num = T_4_15.num;
        }
        if (T_4_11.num == true) {

  LINE(23);
            {
            CLUREF T_5_1;
            CLUREF T_5_2;
            CLUREF T_5_3;
            CLUREF T_5_4;
            CLUREF T_5_5;
            err = intOPmul(num, CLU_16, &T_5_1);
            if (err != ERR_ok) goto ex_4;
            T_5_2.num = (long)(c.ch & 0xff);
            T_5_3.num = 87;
            T_5_4.num = T_5_2.num - T_5_3.num;
             if ((T_5_4.num >= 0 && T_5_2.num < 0 && (-T_5_3.num) < 0) || 
                 (T_5_4.num <= 0 && T_5_2.num > 0 && (-T_5_3.num) > 0)) {
                err = ERR_overflow;
                goto ex_4;}
            T_5_5.num = T_5_1.num - T_5_4.num;
             if ((T_5_5.num >= 0 && T_5_1.num < 0 && (-T_5_4.num) < 0) || 
                 (T_5_5.num <= 0 && T_5_1.num > 0 && (-T_5_4.num) > 0)) {
                err = ERR_overflow;
                goto ex_4;}
            num.num = T_5_5.num;
            }
            }
        else {

  LINE(24);
            {
            {signal (ERR_bad_format);}}
            }}}}/* end if */

  LINE(25);
        {
        CLUREF T_4_1;
        T_4_1.num = i.num + 1;
         if ((T_4_1.num > 0 && i.num < 0 && 1 < 0) || 
             (T_4_1.num < 0 && i.num > 0 && 1 > 0)) {
            err = ERR_overflow;
            goto ex_4;}
        i.num = T_4_1.num;
        }

  LINE(26);
        {
        CLUREF T_4_1;
        err = stringOPfetch(s, i, &T_4_1);
        if (err != ERR_ok) goto ex_4;
        c.num = T_4_1.num;
        }
        }
        end_while_1:;
    goto end_4;
    ex_4:
        if (err == ERR_overflow) {signal(ERR_overflow);}
        else {
            goto ex_3;}
    end_4:;
        goto end_3;
        ex_3:
            if ((err == ERR_bounds)) {
            }
            else {
                goto ex_0;
            }
        end_3:;

  LINE(30);
    {
    CLUREF T_2_1;
    CLUREF T_2_2;
    T_2_1.ch = '-';
    T_2_2.num = (sign.ch == T_2_1.ch)? true : false;
    if (T_2_2.num == true) {

  LINE(31);
        {
        {
        ret_1->num = num.num;
        }
        {signal (ERR_ok);}}
        }
    else {

  LINE(32);
        {
        {
        CLUREF T_3_1;
        err = intOPminus(num, &T_3_1);
        if (err != ERR_ok) goto ex_5;
        ret_1->num = T_3_1.num;
        }
        {signal (ERR_ok);}}
        }}/* end if */
    goto end_5;
    ex_5:
        if (err == ERR_overflow) {signal(ERR_overflow);}
        else {
            goto ex_0;}
    end_5:;
    goto end_0;
    ex_0:
        {
            if (err == ERR_failure) {signal(ERR_failure);}
            elist[0] = _pclu_erstr(err);
            {signal(ERR_failure);}
        }
    end_0: elist[0].str = no_return_values_STRING;
        {signal(ERR_failure);}
    }

/**** END PROCEDURE i_hparse ****/


extern errcode intOPlt();
extern errcode intOPmod();
extern errcode intOPdiv();
extern errcode intOPequal();
extern errcode stringOPconcat();
extern errcode intOPge();
extern errcode stringOPc2s();
extern errcode charOPi2c();
CLUREF STR_;
CLUREF STR__055;
CLUREF STR_0;
static int i_hunparse_own_init = 0;

/**** BEGIN PROCEDURE i_hunparse ****/

errcode i_hunparse(i, ret_1)
CLUREF i;
CLUREF *ret_1;
    {
    errcode err;
    errcode ecode2;
    CLUREF sign;
    CLUREF s;
    CLUREF j;
        if (i_hunparse_own_init == 0) {
        stringOPcons("", CLU_1, CLU_0, &STR_);
        stringOPcons("-", CLU_1, CLU_1, &STR__055);
        stringOPcons("0", CLU_1, CLU_1, &STR_0);
        i_hunparse_own_init = 1;
    }
    enter_proc(36);

  LINE(39);
    {
        {sign = STR_;
        }
        }

  LINE(40);
    {
    CLUREF T_1_1;
    T_1_1.num = (i.num < 0)? true : false;
    if (T_1_1.num == true) {

  LINE(41);
        {
        sign = STR__055;
        }
        }
    else {

  LINE(42);
        {
        CLUREF T_2_1;
        err = intOPminus(i, &T_2_1);
        if (err != ERR_ok) goto ex_0;
        i.num = T_2_1.num;
        }
        }}/* end if */

  LINE(44);
    {
        {s = STR_;
        }
        }

  LINE(45);
    for (;;) {
        if (true != true) { break; }

  LINE(46);
        {
            {CLUREF T_2_1;
            err = intOPmod(i, CLU_16, &T_2_1);
            if (err != ERR_ok) goto ex_0;
            j.num = T_2_1.num;
            }
            }

  LINE(47);
        {
        CLUREF T_2_1;
        err = intOPdiv(i, CLU_16, &T_2_1);
        if (err != ERR_ok) goto ex_0;
        i.num = T_2_1.num;
        }

  LINE(48);
        {
        CLUREF T_2_1;
        T_2_1.num = (j.num == 0)? true : false;
        if (T_2_1.num == true) {

  LINE(49);
            {
            CLUREF T_3_1;
            err = stringOPconcat(STR_0, s, &T_3_1);
            if (err != ERR_ok) goto ex_0;
            s.num = T_3_1.num;
            }
            }
        else {
        CLUREF T_2_2;
        T_2_2.num = (j.num >= 7)? true : false;
        if (T_2_2.num == true) {

  LINE(51);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            CLUREF T_3_5;
            T_3_1.num = 64;
            T_3_2.num = T_3_1.num - j.num;
             if ((T_3_2.num >= 0 && T_3_1.num < 0 && (-j.num) < 0) || 
                 (T_3_2.num <= 0 && T_3_1.num > 0 && (-j.num) > 0)) {
                err = ERR_overflow;
                goto ex_0;}
            err = charOPi2c(T_3_2, &T_3_3);
            if (err != ERR_ok) goto ex_0;
            err = stringOPc2s(T_3_3, &T_3_4);
            if (err != ERR_ok) goto ex_0;
            err = stringOPconcat(T_3_4, s, &T_3_5);
            if (err != ERR_ok) goto ex_0;
            s.num = T_3_5.num;
            }

  LINE(52);
            {
            CLUREF T_3_1;
            T_3_1.num = i.num + 1;
             if ((T_3_1.num > 0 && i.num < 0 && 1 < 0) || 
                 (T_3_1.num < 0 && i.num > 0 && 1 > 0)) {
                err = ERR_overflow;
                goto ex_0;}
            i.num = T_3_1.num;
            }
            }
        else {

  LINE(53);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            CLUREF T_3_5;
            T_3_1.num = 71;
            T_3_2.num = T_3_1.num - j.num;
             if ((T_3_2.num >= 0 && T_3_1.num < 0 && (-j.num) < 0) || 
                 (T_3_2.num <= 0 && T_3_1.num > 0 && (-j.num) > 0)) {
                err = ERR_overflow;
                goto ex_0;}
            err = charOPi2c(T_3_2, &T_3_3);
            if (err != ERR_ok) goto ex_0;
            err = stringOPc2s(T_3_3, &T_3_4);
            if (err != ERR_ok) goto ex_0;
            err = stringOPconcat(T_3_4, s, &T_3_5);
            if (err != ERR_ok) goto ex_0;
            s.num = T_3_5.num;
            }

  LINE(54);
            {
            CLUREF T_3_1;
            T_3_1.num = i.num + 1;
             if ((T_3_1.num > 0 && i.num < 0 && 1 < 0) || 
                 (T_3_1.num < 0 && i.num > 0 && 1 > 0)) {
                err = ERR_overflow;
                goto ex_0;}
            i.num = T_3_1.num;
            }
            }}}/* end if */

  LINE(56);
        {
        CLUREF T_2_1;
        T_2_1.num = (i.num == 0)? true : false;
        if (T_2_1.num == true) {

  LINE(57);
            {
            {
            CLUREF T_3_1;
            err = stringOPconcat(sign, s, &T_3_1);
            if (err != ERR_ok) goto ex_0;
            ret_1->num = T_3_1.num;
            }
            {signal (ERR_ok);}}
            }
            }/* end if */
        }
        end_while_1:;
    goto end_0;
    ex_0:
        {
            if (err == ERR_failure) {signal(ERR_failure);}
            elist[0] = _pclu_erstr(err);
            {signal(ERR_failure);}
        }
    end_0: elist[0].str = no_return_values_STRING;
        {signal(ERR_failure);}
    }

/**** END PROCEDURE i_hunparse ****/

