
/* This file was automatically generated by pclu.*/

#include "pclu_err.h"
#include "pclu_sys.h"


extern errcode _environ();
extern errcode stringOPempty();
extern errcode boolOPnot();
extern errcode charOPequal();
extern errcode stringOPfetch();
extern errcode _termcap_entry();
CLUREF STR_TERMCAP;
CLUREF STR__057etc_057termcap;
CLUREF STR_TERM;
static int _get_termcap_own_init = 0;

/**** BEGIN PROCEDURE _get_termcap ****/

errcode _get_termcap(ret_1)
CLUREF *ret_1;
    {
    errcode err;
    errcode ecode2;
    CLUREF s;
        if (_get_termcap_own_init == 0) {
        stringOPcons("TERMCAP", CLU_1, CLU_7, &STR_TERMCAP);
        stringOPcons("/etc/termcap", CLU_1, CLU_12, &STR__057etc_057termcap);
        stringOPcons("TERM", CLU_1, CLU_4, &STR_TERM);
        _get_termcap_own_init = 1;
    }
    enter_proc(3);

  LINE(5);
    {

  LINE(6);
        {
        CLUREF T_3_1;
        err = _environ(STR_TERMCAP, &T_3_1);
        if (err != ERR_ok) goto ex_1;
        s.num = T_3_1.num;
        }

  LINE(7);
        {
        CLUREF T_3_1;
        CLUREF T_3_2;
        CLUREF T_3_3;
        CLUREF T_3_4;
        CLUREF T_3_5;
        CLUREF T_3_6;
        err = stringOPempty(s, &T_3_2);
        if (err != ERR_ok) goto ex_1;
        T_3_1.num = T_3_2.num;
        if (!T_3_2.num) {
            err = stringOPfetch(s, CLU_1, &T_3_3);
            if (err != ERR_ok) goto ex_1;
            T_3_4.ch = '/';
            T_3_5.num = (T_3_3.ch == T_3_4.ch)? true : false;
            T_3_6.num = T_3_5.num ^ 1;
            T_3_1.num = T_3_6.num;
        }
        if (T_3_1.num == true) {

  LINE(8);
            {
            {
            ret_1->num = s.num;
            }
            {signal (ERR_ok);}}
            }
            }/* end if */
        }
        goto end_1;
        ex_1:
            if ((err == ERR_not_found)) {

  LINE(9);
                {
                s = STR__057etc_057termcap;
                }
            }
            else {
                goto ex_0;
            }
        end_1:;

  LINE(10);
    {
    {
    CLUREF T_2_1;
    CLUREF T_2_2;
    err = _environ(STR_TERM, &T_2_1);
    if (err != ERR_ok) goto ex_2;
    err = _termcap_entry(s, T_2_1, &T_2_2);
    if (err != ERR_ok) goto ex_2;
    ret_1->num = T_2_2.num;
    }
    {signal (ERR_ok);}}
    goto end_2;
    ex_2:
        if (err == ERR_not_found) {signal(ERR_not_found);}
        else {
            goto ex_0;}
    end_2:;
    goto end_0;
    ex_0:
        {
            if (err == ERR_failure) {signal(ERR_failure);}
            elist[0] = _pclu_erstr(err);
            {signal(ERR_failure);}
        }
    end_0: elist[0].str = no_return_values_STRING;
        {signal(ERR_failure);}
    }

/**** END PROCEDURE _get_termcap ****/

