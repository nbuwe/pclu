
/* This file was automatically generated by pclu.*/

#include "pclu_err.h"
#include "pclu_sys.h"


extern errcode stringOPindexc();
extern errcode intOPgt();
extern errcode intOPadd();
extern errcode charOPequal();
extern errcode stringOPfetch();
extern errcode intOPequal();
extern errcode stringOPsubstr();
extern errcode intOPsub();
extern errcode stringOPrest();
CLUREF STR_;
static int _split_name_part_own_init = 0;

/**** BEGIN PROCEDURE _split_name_part ****/

errcode _split_name_part(s, ret_1, ret_2, ret_3)
CLUREF s;
CLUREF *ret_1;
CLUREF *ret_2;
CLUREF *ret_3;
    {
    errcode err;
    errcode ecode2;
    CLUREF i;
    CLUREF j;
    CLUREF name;
    CLUREF suffix;
        if (_split_name_part_own_init == 0) {
        stringOPcons("", CLU_1, CLU_0, &STR_);
        _split_name_part_own_init = 1;
    }
    enter_proc(3);

  LINE(4);
    {
        {CLUREF T_1_1;
        CLUREF T_1_2;
        T_1_1.ch = '.';
        err = stringOPindexc(T_1_1, s, &T_1_2);
        if (err != ERR_ok) goto ex_0;
        i.num = T_1_2.num;
        }
        }

  LINE(5);
    {
    CLUREF T_1_1;
    T_1_1.num = (i.num > 0)? true : false;
    if (T_1_1.num == true) {

  LINE(6);
        {
            {CLUREF T_2_1;
            T_2_1.num = i.num + 1;
             if ((T_2_1.num > 0 && i.num < 0 && 1 < 0) || 
                 (T_2_1.num < 0 && i.num > 0 && 1 > 0)) {
                err = ERR_overflow;
                goto ex_0;}
            j.num = T_2_1.num;
            }
            }

  LINE(7);
        for (;;) {
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            err = stringOPfetch(s, j, &T_3_1);
            if (err != ERR_ok) goto ex_1;
            T_3_2.ch = '.';
            T_3_3.num = (T_3_1.ch == T_3_2.ch)? true : false;
            if (T_3_3.num != true) { break; }

  LINE(8);
            {
            CLUREF T_4_1;
            T_4_1.num = j.num + 1;
             if ((T_4_1.num > 0 && j.num < 0 && 1 < 0) || 
                 (T_4_1.num < 0 && j.num > 0 && 1 > 0)) {
                err = ERR_overflow;
                goto ex_1;}
            j.num = T_4_1.num;
            }
            }
            end_while_1:;
            goto end_1;
            ex_1:
                if ((err == ERR_bounds)) {

  LINE(9);
                    {
                    i.num = 0;
                    }
                }
                else {
                    goto ex_0;
                }
            end_1:;
        }
        }/* end if */

  LINE(11);
    {
    CLUREF T_1_1;
    T_1_1.num = (i.num == 0)? true : false;
    if (T_1_1.num == true) {

  LINE(12);
        {
        {
        ret_1->num = s.num;
        }
        {
        ret_2->str = STR_.str;
        }
        {
        ret_3->str = STR_.str;
        }
        {signal (ERR_ok);}}
        }
        }/* end if */

  LINE(13);
    {
        {CLUREF T_1_1;
        CLUREF T_1_2;
        T_1_1.num = i.num - 1;
         if ((T_1_1.num >= 0 && i.num < 0 && (-1) < 0) || 
             (T_1_1.num <= 0 && i.num > 0 && (-1) > 0)) {
            err = ERR_overflow;
            goto ex_0;}
        err = stringOPsubstr(s, CLU_1, T_1_1, &T_1_2);
        if (err != ERR_ok) goto ex_0;
        name.num = T_1_2.num;
        }
        }

  LINE(14);
    {
        {CLUREF T_1_1;
        CLUREF T_1_2;
        T_1_1.num = i.num + 1;
         if ((T_1_1.num > 0 && i.num < 0 && 1 < 0) || 
             (T_1_1.num < 0 && i.num > 0 && 1 > 0)) {
            err = ERR_overflow;
            goto ex_0;}
        err = stringOPrest(s, T_1_1, &T_1_2);
        if (err != ERR_ok) goto ex_0;
        suffix.num = T_1_2.num;
        }
        }

  LINE(15);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.ch = '.';
    err = stringOPindexc(T_1_1, suffix, &T_1_2);
    if (err != ERR_ok) goto ex_0;
    i.num = T_1_2.num;
    }

  LINE(16);
    {
    CLUREF T_1_1;
    T_1_1.num = (i.num > 0)? true : false;
    if (T_1_1.num == true) {

  LINE(17);
        {
            {CLUREF T_2_1;
            T_2_1.num = i.num + 1;
             if ((T_2_1.num > 0 && i.num < 0 && 1 < 0) || 
                 (T_2_1.num < 0 && i.num > 0 && 1 > 0)) {
                err = ERR_overflow;
                goto ex_0;}
            j.num = T_2_1.num;
            }
            }

  LINE(18);
        for (;;) {
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            err = stringOPfetch(suffix, j, &T_3_1);
            if (err != ERR_ok) goto ex_2;
            T_3_2.ch = '.';
            T_3_3.num = (T_3_1.ch == T_3_2.ch)? true : false;
            if (T_3_3.num != true) { break; }

  LINE(19);
            {
            CLUREF T_4_1;
            T_4_1.num = j.num + 1;
             if ((T_4_1.num > 0 && j.num < 0 && 1 < 0) || 
                 (T_4_1.num < 0 && j.num > 0 && 1 > 0)) {
                err = ERR_overflow;
                goto ex_2;}
            j.num = T_4_1.num;
            }
            }
            end_while_2:;
            goto end_2;
            ex_2:
                if ((err == ERR_bounds)) {

  LINE(20);
                    {
                    i.num = 0;
                    }
                }
                else {
                    goto ex_0;
                }
            end_2:;
        }
        }/* end if */

  LINE(22);
    {
    CLUREF T_1_1;
    T_1_1.num = (i.num == 0)? true : false;
    if (T_1_1.num == true) {

  LINE(23);
        {
        s = STR_;
        }
        }
    else {

  LINE(24);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = i.num + 1;
         if ((T_2_1.num > 0 && i.num < 0 && 1 < 0) || 
             (T_2_1.num < 0 && i.num > 0 && 1 > 0)) {
            err = ERR_overflow;
            goto ex_0;}
        err = stringOPrest(suffix, T_2_1, &T_2_2);
        if (err != ERR_ok) goto ex_0;
        s.num = T_2_2.num;
        }

  LINE(25);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = i.num - 1;
         if ((T_2_1.num >= 0 && i.num < 0 && (-1) < 0) || 
             (T_2_1.num <= 0 && i.num > 0 && (-1) > 0)) {
            err = ERR_overflow;
            goto ex_0;}
        err = stringOPsubstr(suffix, CLU_1, T_2_1, &T_2_2);
        if (err != ERR_ok) goto ex_0;
        suffix.num = T_2_2.num;
        }
        }}/* end if */

  LINE(27);
    {
    {
    ret_1->num = name.num;
    }
    {
    ret_2->num = suffix.num;
    }
    {
    ret_3->num = s.num;
    }
    {signal (ERR_ok);}}
    goto end_0;
    ex_0:
        {
            if (err == ERR_failure) {signal(ERR_failure);}
            elist[0] = _pclu_erstr(err);
            {signal(ERR_failure);}
        }
    end_0: elist[0].str = no_return_values_STRING;
        {signal(ERR_failure);}
    }

/**** END PROCEDURE _split_name_part ****/

