
/* This file was automatically generated by pclu. */

#include "pclu_err.h"
#include "pclu_sys.h"

/**** BEGIN CLUSTER file_name ****/

extern errcode intOPgt();
extern errcode stringOPindexc();
extern errcode intOPadd();
extern errcode boolOPnot();
extern errcode charOPequal();
extern errcode stringOPfetch();
extern errcode intOPequal();
extern errcode _fixup_dir_part();
extern errcode _last_indexc();
extern errcode stringOPsubstr();
extern errcode intOPsub();
extern errcode stringOPrest();
extern errcode _split_name_part();
extern errcode recordOPget_1();
extern errcode stringOPempty();
extern errcode stringOPequal();
extern errcode stringOPappend();
extern errcode stringOPconcat();
extern errcode recordOPget_2();
extern errcode recordOPget_4();
extern errcode recordOPget_3();
extern errcode recordOPcopy1();
extern errcode recordOPset_4();
extern errcode recordOPset_2();
extern errcode intOPunparse();
extern errcode _get_pid();
extern errcode file_nameOPcreate();
extern errcode _dir_ent_size();
extern errcode stringOPsize();
extern errcode recordOPsimilar();
extern errcode pstreamOPtext();
extern errcode pstreamOPtextc();
extern errcode stringOPencode();
extern errcode file_nameOPunparse();
extern errcode file_nameOPparse();
extern errcode stringOPdecode();
extern errcode recordOP_gcd();
extern struct OPS *string_ops;
struct OPS *record_dir_name_other_suffix_ops __CLU_COMMON;
static CLUREF STR__057;
static CLUREF STR_output;
static CLUREF STR__137;
static CLUREF STR_bad_040format;
static int file_name_own_init = 0;
const OWN_req file_name_ownreqs = { 0, 0 };

errcode
file_name_own_init_proc(void)
{
    errcode err;
    enter_own_init_proc();
    if (file_name_own_init == 0) {
        add_selector_info("dir", 0, (struct OPS *)string_ops);
        add_selector_info("name", 1, (struct OPS *)string_ops);
        add_selector_info("other", 2, (struct OPS *)string_ops);
        add_selector_info("suffix", 3, (struct OPS *)string_ops);
        find_selector_ops("record", 4, &(record_dir_name_other_suffix_ops));
        stringOPcons("/", CLU_1, CLUREF_make_num(1), &STR__057);
        stringOPcons("output", CLU_1, CLUREF_make_num(6), &STR_output);
        stringOPcons("_", CLU_1, CLUREF_make_num(1), &STR__137);
        stringOPcons("bad format", CLU_1, CLUREF_make_num(10), &STR_bad_040format);
        file_name_own_init = 1;
        signal(ERR_ok);
      ex_0:
        __CLU_EX_HANDLER;
        pclu_unhandled(err);
        signal(ERR_failure);
    }
    signal(ERR_ok);
}


/**** BEGIN PROCEDURE create ****/


errcode
file_nameOPcreate(CLUREF dir, CLUREF name, CLUREF suffix, CLUREF other, CLUREF *ret_1)
{
    errcode err;
    CLUREF i;
    if (file_name_own_init == 0) {
        err = file_name_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(28);

  LINE(30);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    CLUREF T_1_5;
    CLUREF T_1_6;
    CLUREF T_1_7;
    CLUREF T_1_8;
    CLUREF T_1_9;
    CLUREF T_1_10;
    CLUREF T_1_11;
    CLUREF T_1_12;
    CLUREF T_1_13;
    CLUREF T_1_14;
    CLUREF T_1_15;
    CLUREF T_1_16;
    CLUREF T_1_17;
    CLUREF T_1_18;
    CLUREF T_1_19;
    CLUREF T_1_20;
    CLUREF T_1_21;
    CLUREF T_1_22;
    CLUREF T_1_23;
    CLUREF T_1_24;
    CLUREF T_1_25;
    CLUREF T_1_26;
    CLUREF T_1_27;
    T_1_7.ch = '\000';
    err = stringOPindexc(T_1_7, dir, &T_1_8);
    if (err != ERR_ok)
        goto ex_0;
    T_1_9.num = (T_1_8.num > 0);
    T_1_6.num = T_1_9.num;
    if (!T_1_9.num) {
        T_1_10.ch = '/';
        err = stringOPindexc(T_1_10, name, &T_1_11);
        if (err != ERR_ok)
            goto ex_0;
        T_1_12.num = (T_1_11.num > 0);
        T_1_6.num = T_1_12.num;
    }
    T_1_5.num = T_1_6.num;
    if (!T_1_6.num) {
        T_1_13.ch = '\000';
        err = stringOPindexc(T_1_13, name, &T_1_14);
        if (err != ERR_ok)
            goto ex_0;
        T_1_15.num = (T_1_14.num > 0);
        T_1_5.num = T_1_15.num;
    }
    T_1_4.num = T_1_5.num;
    if (!T_1_5.num) {
        T_1_16.ch = '/';
        err = stringOPindexc(T_1_16, suffix, &T_1_17);
        if (err != ERR_ok)
            goto ex_0;
        T_1_18.num = (T_1_17.num > 0);
        T_1_4.num = T_1_18.num;
    }
    T_1_3.num = T_1_4.num;
    if (!T_1_4.num) {
        T_1_19.ch = '\000';
        err = stringOPindexc(T_1_19, suffix, &T_1_20);
        if (err != ERR_ok)
            goto ex_0;
        T_1_21.num = (T_1_20.num > 0);
        T_1_3.num = T_1_21.num;
    }
    T_1_2.num = T_1_3.num;
    if (!T_1_3.num) {
        T_1_22.ch = '/';
        err = stringOPindexc(T_1_22, other, &T_1_23);
        if (err != ERR_ok)
            goto ex_0;
        T_1_24.num = (T_1_23.num > 0);
        T_1_2.num = T_1_24.num;
    }
    T_1_1.num = T_1_2.num;
    if (!T_1_2.num) {
        T_1_25.ch = '\000';
        err = stringOPindexc(T_1_25, other, &T_1_26);
        if (err != ERR_ok)
            goto ex_0;
        T_1_27.num = (T_1_26.num > 0);
        T_1_1.num = T_1_27.num;
    }
    if (T_1_1.num == true) { /* if */

  LINE(37);
        { /* signal */
            signal(ERR_bad_format);
        }
    }
    } /* end if */

  LINE(38);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.ch = '.';
    err = stringOPindexc(T_1_1, name, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    i.num = T_1_2.num;
    }

  LINE(39);
    { /* if */
    CLUREF T_2_1;
    T_2_1.num = (i.num > 0);
    if (T_2_1.num == true) { /* if */

  LINE(40);
        for (;;) { /* while */
            if (true != true)
                break;

  LINE(41);
            {
            CLUREF T_4_1;
            T_4_1.num = i.num + 1;
            if ((T_4_1.num > 0 && i.num < 0 && 1 < 0) ||
                (T_4_1.num < 0 && i.num > 0 && 1 > 0)) {
                err = ERR_overflow;
                goto ex_1;
            }
            i.num = T_4_1.num;
            }

  LINE(42);
            { /* if */
            CLUREF T_4_1;
            CLUREF T_4_2;
            CLUREF T_4_3;
            CLUREF T_4_4;
            err = stringOPfetch(name, i, &T_4_1);
            if (err != ERR_ok)
                goto ex_1;
            T_4_2.ch = '.';
            T_4_3.num = (T_4_1.ch == T_4_2.ch);
            T_4_4.num = !T_4_3.num;
            if (T_4_4.num == true) { /* if */

  LINE(43);
                { /* signal */
                    signal(ERR_bad_format);
                }
            }
            } /* end if */
        }
        end_while_1:
        __CLU_END_LABEL;
    }
    } /* end if */
    goto end_1;
  ex_1: /* except */
    __CLU_EX_HANDLER;
    if (err == ERR_bounds) {
    }
    else { /* not handled */
        goto ex_0;
    }
  end_1:;

  LINE(46);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.ch = '.';
    err = stringOPindexc(T_1_1, suffix, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    i.num = T_1_2.num;
    }

  LINE(47);
    { /* if */
    CLUREF T_2_1;
    T_2_1.num = (i.num > 0);
    if (T_2_1.num == true) { /* if */

  LINE(48);
        { /* if */
        CLUREF T_3_1;
        T_3_1.num = (i.num == 1);
        if (T_3_1.num == true) { /* if */

  LINE(49);
            { /* signal */
                signal(ERR_bad_format);
            }
        }
        } /* end if */

  LINE(50);
        for (;;) { /* while */
            if (true != true)
                break;

  LINE(51);
            {
            CLUREF T_4_1;
            T_4_1.num = i.num + 1;
            if ((T_4_1.num > 0 && i.num < 0 && 1 < 0) ||
                (T_4_1.num < 0 && i.num > 0 && 1 > 0)) {
                err = ERR_overflow;
                goto ex_2;
            }
            i.num = T_4_1.num;
            }

  LINE(52);
            { /* if */
            CLUREF T_4_1;
            CLUREF T_4_2;
            CLUREF T_4_3;
            CLUREF T_4_4;
            err = stringOPfetch(suffix, i, &T_4_1);
            if (err != ERR_ok)
                goto ex_2;
            T_4_2.ch = '.';
            T_4_3.num = (T_4_1.ch == T_4_2.ch);
            T_4_4.num = !T_4_3.num;
            if (T_4_4.num == true) { /* if */

  LINE(53);
                { /* signal */
                    signal(ERR_bad_format);
                }
            }
            } /* end if */
        }
        end_while_2:
        __CLU_END_LABEL;
    }
    } /* end if */
    goto end_2;
  ex_2: /* except */
    __CLU_EX_HANDLER;
    if (err == ERR_bounds) {
    }
    else { /* not handled */
        goto ex_0;
    }
  end_2:;

  LINE(63);
    { /* return */
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    RecordAlloc(4, T_1_1);
    err = _fixup_dir_part(dir, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    T_1_1.vec->data[0] = T_1_2.num;
    T_1_1.vec->data[1] = name.num;
    T_1_1.vec->data[3] = suffix.num;
    T_1_1.vec->data[2] = other.num;
    ret_1->num = T_1_1.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE create ****/


/**** BEGIN PROCEDURE parse ****/

static int file_nameOPparse_own_init = 0;

errcode
file_nameOPparse(CLUREF s, CLUREF *ret_1)
{
    errcode err;
    CLUREF i;
    CLUREF dir;
    CLUREF name;
    CLUREF suffix;
    if (file_nameOPparse_own_init == 0) {
        if (file_name_own_init == 0) {
            err = file_name_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        file_nameOPparse_own_init = 1;
    }
    enter_proc(69);

  LINE(70);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_1.ch = '\000';
    err = stringOPindexc(T_1_1, s, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    T_1_3.num = (T_1_2.num > 0);
    if (T_1_3.num == true) { /* if */

  LINE(71);
        { /* signal */
            signal(ERR_bad_format);
        }
    }
    } /* end if */

  LINE(72);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.ch = '/';
    err = _last_indexc(T_1_1, s, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    i.num = T_1_2.num;
    }

  LINE(74);
    { /* if */
    CLUREF T_1_1;
    T_1_1.num = (i.num == 0);
    if (T_1_1.num == true) { /* if */

  LINE(75);
        {
        dir = CLU_empty_string;
        }
    }
    else { /* else */

  LINE(76);
        { /* if */
        CLUREF T_2_1;
        T_2_1.num = (i.num == 1);
        if (T_2_1.num == true) { /* if */

  LINE(77);
            {
            dir = STR__057;
            }
        }
        else { /* else */

  LINE(78);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            T_3_1.num = i.num - 1;
            if ((T_3_1.num >= 0 && i.num < 0 && (-1) < 0) ||
                (T_3_1.num <= 0 && i.num > 0 && (-1) > 0)) {
                err = ERR_overflow;
                goto ex_0;
            }
            err = stringOPsubstr(s, CLU_1, T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            err = _fixup_dir_part(T_3_2, &T_3_3);
            if (err != ERR_ok)
                goto ex_0;
            dir.num = T_3_3.num;
            }
        }} /* end if */

  LINE(80);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = i.num + 1;
        if ((T_2_1.num > 0 && i.num < 0 && 1 < 0) ||
            (T_2_1.num < 0 && i.num > 0 && 1 > 0)) {
            err = ERR_overflow;
            goto ex_0;
        }
        err = stringOPrest(s, T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        s.num = T_2_2.num;
        }
    }} /* end if */

  LINE(82);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    err = _split_name_part(s, &T_1_1, &T_1_2, &T_1_3);
    if (err != ERR_ok)
        goto ex_0;
    name.num = T_1_1.num;
    suffix.num = T_1_2.num;
    s.num = T_1_3.num;
    }

  LINE(83);
    { /* return */
    {
    CLUREF T_1_1;
    RecordAlloc(4, T_1_1);
    T_1_1.vec->data[0] = dir.num;
    T_1_1.vec->data[1] = name.num;
    T_1_1.vec->data[3] = suffix.num;
    T_1_1.vec->data[2] = s.num;
    ret_1->num = T_1_1.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE parse ****/


/**** BEGIN PROCEDURE unparse ****/

static int file_nameOPunparse_own_init = 0;

errcode
file_nameOPunparse(CLUREF x, CLUREF *ret_1)
{
    errcode err;
    CLUREF s;
    if (file_nameOPunparse_own_init == 0) {
        if (file_name_own_init == 0) {
            err = file_name_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        file_nameOPunparse_own_init = 1;
    }
    enter_proc(89);

  LINE(90);
    {
    CLUREF T_1_1;
    T_1_1.num = x.vec->data[0];
    s.num = T_1_1.num;
    }

  LINE(91);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    CLUREF T_1_5;
    err = stringOPempty(s, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    T_1_3.num = !T_1_2.num;
    T_1_1.num = T_1_3.num;
    if (T_1_3.num) {
        T_1_4.num = ((s.str->size != STR__057.str->size)? false :
            !(memcmp(s.str->data, STR__057.str->data, s.str->size)));
        T_1_5.num = !T_1_4.num;
        T_1_1.num = T_1_5.num;
    }
    if (T_1_1.num == true) { /* if */

  LINE(92);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.ch = '/';
        err = stringOPappend(s, T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        s.num = T_2_2.num;
        }
    }
    } /* end if */

  LINE(93);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = x.vec->data[1];
    err = stringOPconcat(s, T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    s.num = T_1_2.num;
    }

  LINE(94);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    CLUREF T_1_5;
    CLUREF T_1_6;
    CLUREF T_1_7;
    T_1_2.num = x.vec->data[3];
    err = stringOPempty(T_1_2, &T_1_3);
    if (err != ERR_ok)
        goto ex_0;
    T_1_4.num = !T_1_3.num;
    T_1_1.num = T_1_4.num;
    if (!T_1_4.num) {
        T_1_5.num = x.vec->data[2];
        err = stringOPempty(T_1_5, &T_1_6);
        if (err != ERR_ok)
            goto ex_0;
        T_1_7.num = !T_1_6.num;
        T_1_1.num = T_1_7.num;
    }
    if (T_1_1.num == true) { /* if */

  LINE(95);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        CLUREF T_2_4;
        T_2_1.ch = '.';
        err = stringOPappend(s, T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        T_2_3.num = x.vec->data[3];
        err = stringOPconcat(T_2_2, T_2_3, &T_2_4);
        if (err != ERR_ok)
            goto ex_0;
        s.num = T_2_4.num;
        }
    }
    } /* end if */

  LINE(96);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_1.num = x.vec->data[2];
    err = stringOPempty(T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    T_1_3.num = !T_1_2.num;
    if (T_1_3.num == true) { /* if */

  LINE(97);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        CLUREF T_2_4;
        T_2_1.ch = '.';
        err = stringOPappend(s, T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        T_2_3.num = x.vec->data[2];
        err = stringOPconcat(T_2_2, T_2_3, &T_2_4);
        if (err != ERR_ok)
            goto ex_0;
        s.num = T_2_4.num;
        }
    }
    } /* end if */

  LINE(98);
    { /* return */
    {
    ret_1->num = s.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE unparse ****/


/**** BEGIN PROCEDURE get_dir ****/


errcode
file_nameOPget_dir(CLUREF x, CLUREF *ret_1)
{
    errcode err;
    if (file_name_own_init == 0) {
        err = file_name_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(101);

  LINE(102);
    { /* return */
    {
    CLUREF T_1_1;
    T_1_1.num = x.vec->data[0];
    ret_1->num = T_1_1.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE get_dir ****/


/**** BEGIN PROCEDURE get_name ****/


errcode
file_nameOPget_name(CLUREF x, CLUREF *ret_1)
{
    errcode err;
    if (file_name_own_init == 0) {
        err = file_name_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(105);

  LINE(106);
    { /* return */
    {
    CLUREF T_1_1;
    T_1_1.num = x.vec->data[1];
    ret_1->num = T_1_1.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE get_name ****/


/**** BEGIN PROCEDURE get_suffix ****/


errcode
file_nameOPget_suffix(CLUREF x, CLUREF *ret_1)
{
    errcode err;
    if (file_name_own_init == 0) {
        err = file_name_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(109);

  LINE(110);
    { /* return */
    {
    CLUREF T_1_1;
    T_1_1.num = x.vec->data[3];
    ret_1->num = T_1_1.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE get_suffix ****/


/**** BEGIN PROCEDURE get_other ****/


errcode
file_nameOPget_other(CLUREF x, CLUREF *ret_1)
{
    errcode err;
    if (file_name_own_init == 0) {
        err = file_name_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(113);

  LINE(114);
    { /* return */
    {
    CLUREF T_1_1;
    T_1_1.num = x.vec->data[2];
    ret_1->num = T_1_1.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE get_other ****/


/**** BEGIN PROCEDURE make_output ****/

static int file_nameOPmake_output_own_init = 0;

errcode
file_nameOPmake_output(CLUREF x, CLUREF ext, CLUREF *ret_1)
{
    errcode err;
    if (file_nameOPmake_output_own_init == 0) {
        if (file_name_own_init == 0) {
            err = file_name_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        file_nameOPmake_output_own_init = 1;
    }
    enter_proc(117);

  LINE(118);
    {
    CLUREF T_1_1;
    generic_CLU_proc.type_owns = NULL;
    generic_CLU_proc.proc = recordOPcopy1;
    CUR_PROC_VAR.proc = &generic_CLU_proc;
    err = recordOPcopy1(x, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    x.num = T_1_1.num;
    }

  LINE(119);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    CLUREF T_1_5;
    CLUREF T_1_6;
    CLUREF T_1_7;
    T_1_2.ch = '/';
    err = stringOPindexc(T_1_2, ext, &T_1_3);
    if (err != ERR_ok)
        goto ex_0;
    T_1_4.num = (T_1_3.num > 0);
    T_1_1.num = T_1_4.num;
    if (!T_1_4.num) {
        T_1_5.ch = '.';
        err = stringOPindexc(T_1_5, ext, &T_1_6);
        if (err != ERR_ok)
            goto ex_0;
        T_1_7.num = (T_1_6.num > 0);
        T_1_1.num = T_1_7.num;
    }
    if (T_1_1.num == true) { /* if */

  LINE(120);
        { /* signal */
            signal(ERR_bad_format);
        }
    }
    } /* end if */

  LINE(121);
    {
    x.vec->data[3] = ext.num;
    }

  LINE(122);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = x.vec->data[1];
    err = stringOPempty(T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    if (T_1_2.num == true) { /* if */

  LINE(123);
        {
        x.vec->data[1] = STR_output.num;
        }
    }
    } /* end if */

  LINE(124);
    { /* return */
    {
    ret_1->num = x.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE make_output ****/


/**** BEGIN PROCEDURE make_temp ****/

static int file_nameOPmake_temp_own_init = 0;
CLUREF file_nameOPmake_tempOPextend_number;

errcode
file_nameOPmake_temp(CLUREF tdir, CLUREF prog, CLUREF kind, CLUREF *ret_1)
{
    errcode err;
    if (file_nameOPmake_temp_own_init == 0) {
        if (file_name_own_init == 0) {
            err = file_name_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        file_nameOPmake_temp_own_init = 1;
        {
        file_nameOPmake_tempOPextend_number.num = 0;
        }
    }
    enter_proc(127);

  LINE(130);
    {
    CLUREF T_1_1;
    T_1_1.num = file_nameOPmake_tempOPextend_number.num + 1;
    if ((T_1_1.num > 0 && file_nameOPmake_tempOPextend_number.num < 0 && 1 < 0) ||
        (T_1_1.num < 0 && file_nameOPmake_tempOPextend_number.num > 0 && 1 > 0)) {
        err = ERR_overflow;
        goto ex_0;
    }
    file_nameOPmake_tempOPextend_number.num = T_1_1.num;
    }

  LINE(131);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    err = stringOPconcat(STR__137, prog, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    err = intOPunparse(file_nameOPmake_tempOPextend_number, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    err = stringOPconcat(T_1_1, T_1_2, &T_1_3);
    if (err != ERR_ok)
        goto ex_0;
    err = stringOPconcat(T_1_3, kind, &T_1_4);
    if (err != ERR_ok)
        goto ex_0;
    prog.num = T_1_4.num;
    }

  LINE(132);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    err = _get_pid(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    err = intOPunparse(T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    kind.num = T_1_2.num;
    }

  LINE(133);
    { /* return */
    {
    CLUREF T_2_1;
    CLUREF T_2_2;
    CLUREF T_2_3;
    CLUREF T_2_4;
    CLUREF T_2_5;
    CLUREF T_2_6;
    err = _dir_ent_size(&T_2_1);
    if (err != ERR_ok)
        goto ex_1;
    err = stringOPsize(kind, &T_2_2);
    if (err != ERR_ok)
        goto ex_1;
    T_2_3.num = T_2_1.num - T_2_2.num;
    if ((T_2_3.num >= 0 && T_2_1.num < 0 && (-T_2_2.num) < 0) ||
        (T_2_3.num <= 0 && T_2_1.num > 0 && (-T_2_2.num) > 0)) {
        err = ERR_overflow;
        goto ex_1;
    }
    err = stringOPsubstr(prog, CLU_1, T_2_3, &T_2_4);
    if (err != ERR_ok)
        goto ex_1;
    err = stringOPconcat(T_2_4, kind, &T_2_5);
    if (err != ERR_ok)
        goto ex_1;
    err = file_nameOPcreate(tdir, T_2_5, CLU_empty_string, CLU_empty_string, &T_2_6);
    if (err != ERR_ok)
        goto ex_1;
    ret_1->num = T_2_6.num;
    }
    signal (ERR_ok);
    }
    goto end_1;
  ex_1: /* resignal */
    __CLU_EX_HANDLER;
    if (err == ERR_bad_format)
        signal(err);
    else
        goto ex_0;
  end_1:;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE make_temp ****/


/**** BEGIN PROCEDURE equal ****/

struct OPS *record_dir_name_other_suffix_ops __CLU_COMMON;
static int file_nameOPequal_own_init = 0;

errcode
file_nameOPequal(CLUREF x, CLUREF y, CLUREF *ret_1)
{
    errcode err;
    if (file_nameOPequal_own_init == 0) {
        if (file_name_own_init == 0) {
            err = file_name_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        file_nameOPequal_own_init = 1;
    }
    enter_proc(141);

  LINE(142);
    { /* return */
    {
    CLUREF T_1_1;
    generic_CLU_proc.type_owns = NULL;
    generic_CLU_proc.op_owns = record_dir_name_other_suffix_ops->entry[0].fcn->op_owns;
    generic_CLU_proc.proc = recordOPsimilar;
    CUR_PROC_VAR.proc = &generic_CLU_proc;
    err = recordOPsimilar(x, y, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    ret_1->num = T_1_1.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE equal ****/


/**** BEGIN PROCEDURE similar ****/

struct OPS *record_dir_name_other_suffix_ops __CLU_COMMON;
static int file_nameOPsimilar_own_init = 0;

errcode
file_nameOPsimilar(CLUREF x, CLUREF y, CLUREF *ret_1)
{
    errcode err;
    if (file_nameOPsimilar_own_init == 0) {
        if (file_name_own_init == 0) {
            err = file_name_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        file_nameOPsimilar_own_init = 1;
    }
    enter_proc(145);

  LINE(146);
    { /* return */
    {
    CLUREF T_1_1;
    generic_CLU_proc.type_owns = NULL;
    generic_CLU_proc.op_owns = record_dir_name_other_suffix_ops->entry[0].fcn->op_owns;
    generic_CLU_proc.proc = recordOPsimilar;
    CUR_PROC_VAR.proc = &generic_CLU_proc;
    err = recordOPsimilar(x, y, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    ret_1->num = T_1_1.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE similar ****/


/**** BEGIN PROCEDURE copy ****/


errcode
file_nameOPcopy(CLUREF x, CLUREF *ret_1)
{
    errcode err;
    if (file_name_own_init == 0) {
        err = file_name_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(149);

  LINE(150);
    { /* return */
    {
    ret_1->num = x.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE copy ****/


/**** BEGIN PROCEDURE print ****/

static int file_nameOPprint_own_init = 0;

errcode
file_nameOPprint(CLUREF x, CLUREF ps)
{
    errcode err;
    if (file_nameOPprint_own_init == 0) {
        if (file_name_own_init == 0) {
            err = file_name_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        file_nameOPprint_own_init = 1;
    }
    enter_proc(153);

  LINE(154);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = x.vec->data[0];
    err = pstreamOPtext(ps, T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(155);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    CLUREF T_1_5;
    CLUREF T_1_6;
    CLUREF T_1_7;
    T_1_2.num = x.vec->data[0];
    err = stringOPempty(T_1_2, &T_1_3);
    if (err != ERR_ok)
        goto ex_0;
    T_1_4.num = !T_1_3.num;
    T_1_1.num = T_1_4.num;
    if (T_1_4.num) {
        T_1_5.num = x.vec->data[0];
        T_1_6.num = ((T_1_5.str->size != STR__057.str->size)? false :
            !(memcmp(T_1_5.str->data, STR__057.str->data, T_1_5.str->size)));
        T_1_7.num = !T_1_6.num;
        T_1_1.num = T_1_7.num;
    }
    if (T_1_1.num == true) { /* if */

  LINE(156);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.ch = '/';
        err = pstreamOPtextc(ps, T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        }
    }
    } /* end if */

  LINE(157);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = x.vec->data[1];
    err = pstreamOPtext(ps, T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(158);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    CLUREF T_1_5;
    CLUREF T_1_6;
    CLUREF T_1_7;
    T_1_2.num = x.vec->data[3];
    err = stringOPempty(T_1_2, &T_1_3);
    if (err != ERR_ok)
        goto ex_0;
    T_1_4.num = !T_1_3.num;
    T_1_1.num = T_1_4.num;
    if (!T_1_4.num) {
        T_1_5.num = x.vec->data[2];
        err = stringOPempty(T_1_5, &T_1_6);
        if (err != ERR_ok)
            goto ex_0;
        T_1_7.num = !T_1_6.num;
        T_1_1.num = T_1_7.num;
    }
    if (T_1_1.num == true) { /* if */

  LINE(159);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.ch = '.';
        err = pstreamOPtextc(ps, T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(160);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = x.vec->data[3];
        err = pstreamOPtext(ps, T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        }
    }
    } /* end if */

  LINE(162);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_1.num = x.vec->data[2];
    err = stringOPempty(T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    T_1_3.num = !T_1_2.num;
    if (T_1_3.num == true) { /* if */

  LINE(163);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.ch = '.';
        err = pstreamOPtextc(ps, T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(164);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = x.vec->data[2];
        err = pstreamOPtext(ps, T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        }
    }
    } /* end if */

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE print ****/


/**** BEGIN PROCEDURE encode ****/


errcode
file_nameOPencode(CLUREF fn, CLUREF ist)
{
    errcode err;
    if (file_name_own_init == 0) {
        err = file_name_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(168);

  LINE(169);
    {
    CLUREF T_2_1;
    err = file_nameOPunparse(fn, &T_2_1);
    if (err != ERR_ok)
        goto ex_1;
    err = stringOPencode(T_2_1, ist);
    if (err != ERR_ok)
        goto ex_1;
    }
    goto end_1;
  ex_1: /* resignal */
    __CLU_EX_HANDLER;
    if (err == ERR_not_possible)
        signal(err);
    else
        goto ex_0;
  end_1:;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE encode ****/


/**** BEGIN PROCEDURE decode ****/

static int file_nameOPdecode_own_init = 0;

errcode
file_nameOPdecode(CLUREF ist, CLUREF *ret_1)
{
    errcode err;
    if (file_nameOPdecode_own_init == 0) {
        if (file_name_own_init == 0) {
            err = file_name_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        file_nameOPdecode_own_init = 1;
    }
    enter_proc(173);

  LINE(175);
    { /* return */
    {
    CLUREF T_3_1;
    CLUREF T_3_2;
    err = stringOPdecode(ist, &T_3_1);
    if (err != ERR_ok)
        goto ex_2;
    err = file_nameOPparse(T_3_1, &T_3_2);
    if (err != ERR_ok)
        goto ex_2;
    ret_1->num = T_3_2.num;
    }
    signal (ERR_ok);
    }
    goto end_2;
  ex_2: /* resignal */
    __CLU_EX_HANDLER;
    if (err == ERR_end_of_file)
        signal(err);
    else if (err == ERR_not_possible)
        signal(err);
    else
        goto ex_1;
  end_2:;
    goto end_1;
  ex_1: /* except */
    __CLU_EX_HANDLER;
    if (err == ERR_bad_format) {

  LINE(177);
        { /* signal */
            elist[0] = STR_bad_040format;
            signal(ERR_not_possible);
        }
    }
    else { /* not handled */
        goto ex_0;
    }
  end_1:;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE decode ****/


/**** BEGIN PROCEDURE _gcd ****/

struct OPS *record_dir_name_other_suffix_ops __CLU_COMMON;
static int file_nameOP_gcd_own_init = 0;

errcode
file_nameOP_gcd(CLUREF x, CLUREF tab, CLUREF *ret_1)
{
    errcode err;
    if (file_nameOP_gcd_own_init == 0) {
        if (file_name_own_init == 0) {
            err = file_name_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        file_nameOP_gcd_own_init = 1;
    }
    enter_proc(180);

  LINE(181);
    { /* return */
    {
    CLUREF T_1_1;
    generic_CLU_proc.type_owns = NULL;
    generic_CLU_proc.op_owns = record_dir_name_other_suffix_ops->entry[6].fcn->op_owns;
    generic_CLU_proc.proc = recordOP_gcd;
    CUR_PROC_VAR.proc = &generic_CLU_proc;
    err = recordOP_gcd(x, tab, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    ret_1->num = T_1_1.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE _gcd ****/

typedef struct {
    long count;
    OWNPTR type_owns;
    OWNPTR op_owns;
    struct OP_ENTRY entry[16];
} file_name_OPS;

static CLU_proc file_name_oe__gcd = { .proc = file_nameOP_gcd };
static CLU_proc file_name_oe_copy = { .proc = file_nameOPcopy };
static CLU_proc file_name_oe_create = { .proc = file_nameOPcreate };
static CLU_proc file_name_oe_decode = { .proc = file_nameOPdecode };
static CLU_proc file_name_oe_encode = { .proc = file_nameOPencode };
static CLU_proc file_name_oe_equal = { .proc = file_nameOPequal };
static CLU_proc file_name_oe_get_dir = { .proc = file_nameOPget_dir };
static CLU_proc file_name_oe_get_name = { .proc = file_nameOPget_name };
static CLU_proc file_name_oe_get_other = { .proc = file_nameOPget_other };
static CLU_proc file_name_oe_get_suffix = { .proc = file_nameOPget_suffix };
static CLU_proc file_name_oe_make_output = { .proc = file_nameOPmake_output };
static CLU_proc file_name_oe_make_temp = { .proc = file_nameOPmake_temp };
static CLU_proc file_name_oe_parse = { .proc = file_nameOPparse };
static CLU_proc file_name_oe_print = { .proc = file_nameOPprint };
static CLU_proc file_name_oe_similar = { .proc = file_nameOPsimilar };
static CLU_proc file_name_oe_unparse = { .proc = file_nameOPunparse };

static file_name_OPS file_name_ops_actual = {16, (OWNPTR)&file_name_own_init, (OWNPTR)&file_name_own_init, {
    {&file_name_oe__gcd, "_gcd"},
    {&file_name_oe_copy, "copy"},
    {&file_name_oe_create, "create"},
    {&file_name_oe_decode, "decode"},
    {&file_name_oe_encode, "encode"},
    {&file_name_oe_equal, "equal"},
    {&file_name_oe_get_dir, "get_dir"},
    {&file_name_oe_get_name, "get_name"},
    {&file_name_oe_get_other, "get_other"},
    {&file_name_oe_get_suffix, "get_suffix"},
    {&file_name_oe_make_output, "make_output"},
    {&file_name_oe_make_temp, "make_temp"},
    {&file_name_oe_parse, "parse"},
    {&file_name_oe_print, "print"},
    {&file_name_oe_similar, "similar"},
    {&file_name_oe_unparse, "unparse"}}};

struct OPS *file_name_ops = (struct OPS *)&file_name_ops_actual;

/**** END CLUSTER file_name ****/
