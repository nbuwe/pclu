
/* This file was automatically generated by pclu. */

#include "pclu_err.h"
#include "pclu_sys.h"


/**** BEGIN CLUSTER g_tbl ****/

extern errcode arrayOPnew();
extern errcode intOPequal();
extern errcode arrayOPsize();
extern errcode dbg_infoOPactive();
extern errcode oneofOPis_1();
extern errcode g_tblOPfind_tbls_in_signature();
extern errcode oneofOPvalue_1();
extern errcode sequenceOPelements();
extern errcode recordOPget_1();
extern errcode oneofOPvalue_3();
extern errcode g_tblOPfind_tbls();
extern errcode g_tblOPtbl_uniq();
extern errcode g_tblOPg_field_tables();
extern errcode g_tblOPfind_tbl_decllist();
extern errcode g_tblOPfind_tbl_typelist();
extern errcode recordOPget_11();
extern errcode recordOPget_9();
extern errcode recordOPget_2();
extern errcode stmtOPget_abs();
extern errcode g_tblOPfind_tbl_exprs();
extern errcode recordOPget_3();
extern errcode g_tblOPfind_tbl_exprlist();
extern errcode recordOPget_4();
extern errcode sequenceOPfill();
extern errcode g_tblOPfind_tbl_decl();
extern errcode g_tblOPfind_tbl_type_();
extern errcode typespecOPget_abs();
extern errcode intOPgt();
extern errcode sequenceOPsize();
extern errcode arrayOPaddh();
extern errcode oneofOPmake_4();
extern errcode parmd_dus();
extern errcode g_tblOPfind_tbl_fieldspeclist();
extern errcode oneofOPmake_7();
extern errcode duOPget_common();
extern errcode compiler_logit();
extern errcode typespec_print();
extern errcode g_tblOPfind_tbl_field();
extern errcode exprOPget_abs();
extern errcode boolOPnot();
extern errcode g_tblOPbase_apply_test();
extern errcode parmd_op();
extern errcode oneofOPmake_6();
extern errcode g_tblOPbase_cluster_test();
extern errcode oneofOPis_7();
extern errcode oneofOPvalue_7();
extern errcode oneofOPmake_1();
extern errcode exprOPget_typespec();
extern errcode oneofOPmake_3();
extern errcode oneofOPmake_5();
extern errcode expr_print();
extern errcode arrayOPlow();
extern errcode intOPle();
extern errcode arrayOPfetch();
extern errcode intOPfrom_to();
extern errcode intOPadd();
extern errcode oneofOPvalue_5();
extern errcode pb_formals();
extern errcode pb_actuals();
extern errcode arrayOPelements();
extern errcode oneofOPis_3();
extern errcode oneofOPis_5();
extern errcode sequenceOPsimilar();
extern errcode stringOPequal();
extern errcode typespecOPsimilar();
extern errcode g_tblOPg_sel_extern();
extern errcode g_parm_extern();
extern errcode g_tblOPtest_pb();
extern errcode g_tblOPg_sel_table();
extern errcode g_parm_table();
extern errcode make_sel_name();
extern errcode stringOPconcat();
extern errcode g_def_opsptr();
extern errcode s_name_typespec();
extern errcode g_envOPadd_extern();
extern errcode g_envOPputl();
extern errcode g_parm_table_inst_info();
extern errcode g_tblOPbuild_one_selector_table();
extern errcode g_own_build_one();
extern errcode g_parm_build_one();
extern errcode g_tblOPtest_pb_exprs_asst();
extern errcode g_tblOPtest_pb_fields_asst();
extern errcode pb_print();
extern errcode g_tblOPtest_pb_exprs_type_asst();
extern errcode idnOPget_kind();
extern errcode g_envOPputs();
extern errcode intOPunparse();
extern errcode g_ref_name_typespec();
extern errcode s_owns_prefix_fieldlist();
extern errcode fl_cont_op_parm();
extern errcode type_cont_op_parm();
extern errcode el_cont_op_parm();
extern const struct REQS * const sequence_of_t_reqs;
extern struct OPS *idn_ops;
extern const OWN_req sequence_ownreqs;
extern struct OPS *sequence_ops;
struct OPS *sequence_of_idn_ops __CLU_COMMON;
extern struct OPS *expr_ops;
struct OPS *sequence_of_expr_ops __CLU_COMMON;
extern struct OPS *string_ops;
extern struct OPS *typespec_ops;
struct OPS *record_sel_type__ops __CLU_COMMON;
extern struct OPS *record_sel_type__ops;
struct OPS *sequence_of_record_sel_type__ops __CLU_COMMON;
static CLUREF STR_find_137tbl_137type_137_072_040others;
static CLUREF STR_find_137tbl_137exprs_072_040s_137cons_040not_040select;
static CLUREF STR_type_137_072_040unhandled_040typespec;
static CLUREF STR_type_137of_137;
static CLUREF STR__137;
static CLUREF STR__137ops;
static CLUREF STR_g_137sel_137table;
static CLUREF STR_extern_040struct_040OPS_040_052;
static CLUREF STR__073;
static CLUREF STR_test_137pb_072_040others;
static CLUREF STR_test_137pb_072_040force_072_040others;
static CLUREF STR_test_137pb_137expr_137asst_072_040exprabs_040not_040type_137_040or_040constant;
static CLUREF STR_array;
static CLUREF STR_sequence;
static CLUREF STR__137vec;
static CLUREF STR__137cvt;
static CLUREF STR_test_137pb_137fields_137asst_072_040unexpected_040typespec;
static CLUREF STR_add_137selector_137info_050;
static CLUREF STR__042;
static CLUREF STR__042_054_040;
static CLUREF STR__054_040;
static CLUREF STR__050struct_040OPS_040_052_051;
static CLUREF STR__137ops_051_073;
static CLUREF STR_find_137selector_137ops_050_042;
static CLUREF STR__054_040_046_050;
static CLUREF STR__137ops_051_051_073;
static int g_tbl_own_init = 0;
const OWN_req g_tbl_ownreqs = { 0, 0 };
CLUREF g_tblOPcum_pbl;

errcode
g_tbl_own_init_proc(void)
{
    errcode err;
    enter_own_init_proc();
    if (g_tbl_own_init == 0) {
        add_parm_info_type(0, (const struct OPS *)idn_ops, sequence_of_t_reqs);
        find_type_instance(sequence_ops, 1, &sequence_ownreqs, &(sequence_of_idn_ops));
        add_parm_info_type(0, (const struct OPS *)expr_ops, sequence_of_t_reqs);
        find_type_instance(sequence_ops, 1, &sequence_ownreqs, &(sequence_of_expr_ops));
        add_selector_info("sel", 0, (struct OPS *)string_ops);
        add_selector_info("type_", 1, (struct OPS *)typespec_ops);
        find_selector_ops("record", 2, &(record_sel_type__ops));
        add_parm_info_type(0, (const struct OPS *)record_sel_type__ops, sequence_of_t_reqs);
        find_type_instance(sequence_ops, 1, &sequence_ownreqs, &(sequence_of_record_sel_type__ops));
        stringOPcons("find_tbl_type_: others", CLU_1, CLUREF_make_num(22), &STR_find_137tbl_137type_137_072_040others);
        stringOPcons("find_tbl_exprs: s_cons not select", CLU_1, CLUREF_make_num(33), &STR_find_137tbl_137exprs_072_040s_137cons_040not_040select);
        stringOPcons("type_: unhandled typespec", CLU_1, CLUREF_make_num(25), &STR_type_137_072_040unhandled_040typespec);
        stringOPcons("type_of_", CLU_1, CLUREF_make_num(8), &STR_type_137of_137);
        stringOPcons("_", CLU_1, CLUREF_make_num(1), &STR__137);
        stringOPcons("_ops", CLU_1, CLUREF_make_num(4), &STR__137ops);
        stringOPcons("g_sel_table", CLU_1, CLUREF_make_num(11), &STR_g_137sel_137table);
        stringOPcons("extern struct OPS *", CLU_1, CLUREF_make_num(19), &STR_extern_040struct_040OPS_040_052);
        stringOPcons(";", CLU_1, CLUREF_make_num(1), &STR__073);
        stringOPcons("test_pb: others", CLU_1, CLUREF_make_num(15), &STR_test_137pb_072_040others);
        stringOPcons("test_pb: force: others", CLU_1, CLUREF_make_num(22), &STR_test_137pb_072_040force_072_040others);
        stringOPcons("test_pb_expr_asst: exprabs not type_ or constant", CLU_1, CLUREF_make_num(48), &STR_test_137pb_137expr_137asst_072_040exprabs_040not_040type_137_040or_040constant);
        stringOPcons("array", CLU_1, CLUREF_make_num(5), &STR_array);
        stringOPcons("sequence", CLU_1, CLUREF_make_num(8), &STR_sequence);
        stringOPcons("_vec", CLU_1, CLUREF_make_num(4), &STR__137vec);
        stringOPcons("_cvt", CLU_1, CLUREF_make_num(4), &STR__137cvt);
        stringOPcons("test_pb_fields_asst: unexpected typespec", CLU_1, CLUREF_make_num(40), &STR_test_137pb_137fields_137asst_072_040unexpected_040typespec);
        stringOPcons("add_selector_info(", CLU_1, CLUREF_make_num(18), &STR_add_137selector_137info_050);
        stringOPcons("\"", CLU_1, CLUREF_make_num(1), &STR__042);
        stringOPcons("\", ", CLU_1, CLUREF_make_num(3), &STR__042_054_040);
        stringOPcons(", ", CLU_1, CLUREF_make_num(2), &STR__054_040);
        stringOPcons("(struct OPS *)", CLU_1, CLUREF_make_num(14), &STR__050struct_040OPS_040_052_051);
        stringOPcons("_ops);", CLU_1, CLUREF_make_num(6), &STR__137ops_051_073);
        stringOPcons("find_selector_ops(\"", CLU_1, CLUREF_make_num(19), &STR_find_137selector_137ops_050_042);
        stringOPcons(", &(", CLU_1, CLUREF_make_num(4), &STR__054_040_046_050);
        stringOPcons("_ops));", CLU_1, CLUREF_make_num(7), &STR__137ops_051_051_073);
        g_tbl_own_init = 1;
        {
        CLUREF T_0_1;
        err = arrayOPnew(&T_0_1);
        if (err != ERR_ok)
            goto ex_0;
        g_tblOPcum_pbl.num = T_0_1.num;
        }
        signal(ERR_ok);
      ex_0:
        __CLU_EX_HANDLER;
        pclu_unhandled(err);
        signal(ERR_failure);
    }
    signal(ERR_ok);
}


/**** BEGIN PROCEDURE exist ****/


errcode
g_tblOPexist(CLUREF *ret_1)
{
    errcode err;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(13);

  LINE(14);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = g_tblOPcum_pbl.array->ext_size;
    T_1_2.num = (T_1_1.num == 0);
    if (T_1_2.num == true) { /* if */

  LINE(16);
        { /* return */
        {
        ret_1->tf = false;
        }
        signal (ERR_ok);
        }
    }
    else { /* else */

  LINE(18);
        { /* return */
        {
        ret_1->tf = true;
        }
        signal (ERR_ok);
        }
    }} /* end if */

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE exist ****/


/**** BEGIN PROCEDURE find_tables ****/


errcode
g_tblOPfind_tables(CLUREF e, CLUREF bod, CLUREF d)
{
    errcode err;
    CLUREF pbl;
    CLUREF each_ap;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(24);

  LINE(25);
    {
    CLUREF T_1_1;
    err = arrayOPnew(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    pbl.num = T_1_1.num;
    }

  LINE(26);
    { /* if */
    CLUREF T_1_1;
    err = dbg_infoOPactive(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    if (T_1_1.num == true) { /* if */

  LINE(27);
        { /* if */
        CLUREF T_2_1;
        if (d.cell->tag == 1) T_2_1.num = true; else T_2_1.num = false;
        if (T_2_1.num == true) { /* if */

  LINE(28);
            {
            CLUREF T_3_1;
            if (d.cell->tag != 1) {
                err = ERR_wrong_tag;
                goto ex_0;
            }
            T_3_1.num = d.cell->value;
            err = g_tblOPfind_tbls_in_signature(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
        }
        else { /* else */

  LINE(30);
            { /* for sequence$elements */
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            CLUREF T_3_5;
            if (d.cell->tag != 3) {
                err = ERR_wrong_tag;
                goto ex_0;
            }
            T_3_1.num = d.cell->value;
            T_3_2.num = T_3_1.vec->data[0];
            T_3_4.num = T_3_2.vec->size;
            T_3_5 = T_3_2;
            for (T_3_3.num = 1; T_3_3.num <= T_3_4.num; T_3_3.num++) {
                each_ap.num = T_3_5.vec->data[T_3_3.num - 1];

  LINE(32);
                {
                err = g_tblOPfind_tbls_in_signature(each_ap, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }
            }
            }
            end_inline_for_1:
            __CLU_END_LABEL;
        }} /* end if */
    }
    } /* end if */

  LINE(36);
    {
    err = g_tblOPfind_tbls(bod, pbl);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(37);
    {
    CLUREF T_1_1;
    err = g_tblOPtbl_uniq(pbl, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    pbl.num = T_1_1.num;
    }

  LINE(38);
    {
    g_tblOPcum_pbl.num = pbl.num;
    }

  LINE(40);
    {
    err = g_tblOPg_field_tables(e, CLU_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(41);
    { /* return */
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE find_tables ****/


/**** BEGIN PROCEDURE find_tbls_in_signature ****/


errcode
g_tblOPfind_tbls_in_signature(CLUREF ap, CLUREF pbl)
{
    errcode err;
    CLUREF e;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(44);

  LINE(45);
    {
    CLUREF T_1_1;
    T_1_1.num = ap.vec->data[0];
    err = g_tblOPfind_tbl_decllist(T_1_1, pbl);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(47);
    { /* if */
    CLUREF T_1_1;
    err = dbg_infoOPactive(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    if (T_1_1.num == true) { /* if */

  LINE(51);
        {
        CLUREF T_2_1;
        T_2_1.num = ap.vec->data[10];
        err = g_tblOPfind_tbl_typelist(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(52);
        { /* for sequence$elements */
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        CLUREF T_2_4;
        T_2_1.num = ap.vec->data[8];
        T_2_3.num = T_2_1.vec->size;
        T_2_4 = T_2_1;
        for (T_2_2.num = 1; T_2_2.num <= T_2_3.num; T_2_2.num++) {
            e.num = T_2_4.vec->data[T_2_2.num - 1];

  LINE(53);
            {
            CLUREF T_3_1;
            T_3_1.num = e.vec->data[1];
            err = g_tblOPfind_tbl_typelist(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
        }
        }
        end_inline_for_1:
        __CLU_END_LABEL;
    }
    } /* end if */

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE find_tbls_in_signature ****/


/**** BEGIN PROCEDURE find_tbls ****/


errcode
g_tblOPfind_tbls(CLUREF bod, CLUREF pbl)
{
    errcode err;
    CLUREF s;
    CLUREF di;
    CLUREF as;
    CLUREF inv;
    CLUREF w;
    CLUREF f;
    CLUREF dl;
    CLUREF i;
    CLUREF arm;
    CLUREF b;
    CLUREF t;
    CLUREF el;
    CLUREF c;
    CLUREF e;
    CLUREF a;
    CLUREF r;
    CLUREF d;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(61);

  LINE(62);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = bod.vec->size;
    T_1_3 = bod;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        s.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(65);
        { /* qtagcase */
        CLUREF T_2_1;
        err = stmtOPget_abs(s, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        switch (T_2_1.cell->tag) {
        case 7: /* declinit */ {
            CLUREF T_2_2;
            T_2_2.num = T_2_1.cell->value;
            di.num = T_2_2.num;

  LINE(67);
            {
            CLUREF T_3_1;
            T_3_1.num = di.vec->data[2];
            err = g_tblOPfind_tbl_exprs(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(68);
            {
            CLUREF T_3_1;
            T_3_1.num = di.vec->data[0];
            err = g_tblOPfind_tbl_decllist(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        case 1: /* assn */ {
            CLUREF T_2_3;
            T_2_3.num = T_2_1.cell->value;
            as.num = T_2_3.num;

  LINE(70);
            {
            CLUREF T_3_1;
            T_3_1.num = as.vec->data[2];
            err = g_tblOPfind_tbl_exprlist(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        case 17: /* sugarassn */ {
            CLUREF T_2_4;
            T_2_4.num = T_2_1.cell->value;
            as.num = T_2_4.num;

  LINE(72);
            {
            CLUREF T_3_1;
            T_3_1.num = as.vec->data[0];
            err = g_tblOPfind_tbl_exprs(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(73);
            {
            CLUREF T_3_1;
            T_3_1.num = as.vec->data[1];
            err = g_tblOPfind_tbl_exprs(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        case 13: /* invoke */ {
            CLUREF T_2_5;
            T_2_5.num = T_2_1.cell->value;
            inv.num = T_2_5.num;

  LINE(75);
            {
            CLUREF T_3_1;
            T_3_1.num = inv.vec->data[0];
            err = g_tblOPfind_tbl_exprs(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(76);
            {
            CLUREF T_3_1;
            T_3_1.num = inv.vec->data[1];
            err = g_tblOPfind_tbl_exprlist(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        case 19: /* while_ */ {
            CLUREF T_2_6;
            T_2_6.num = T_2_1.cell->value;
            w.num = T_2_6.num;

  LINE(78);
            {
            CLUREF T_3_1;
            T_3_1.num = w.vec->data[1];
            err = g_tblOPfind_tbl_exprs(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(79);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = w.vec->data[0];
            T_3_2.num = T_3_1.vec->data[1];
            err = g_tblOPfind_tbls(T_3_2, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        case 10: /* for_ */ {
            CLUREF T_2_7;
            T_2_7.num = T_2_1.cell->value;
            f.num = T_2_7.num;

  LINE(81);
            { /* if */
            CLUREF T_3_1;
            err = dbg_infoOPactive(&T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_1.num == true) { /* if */

  LINE(82);
                { /* qtagcase */
                CLUREF T_4_1;
                T_4_1.num = f.vec->data[3];
                switch (T_4_1.cell->tag) {
                case 1: /* new */ {
                    CLUREF T_4_2;
                    T_4_2.num = T_4_1.cell->value;
                    dl.num = T_4_2.num;

  LINE(84);
                    {
                    err = g_tblOPfind_tbl_decllist(dl, pbl);
                    if (err != ERR_ok)
                        goto ex_0;
                    }
                    break;
                }
                case 2: /* old */ {
                    break;
                }
                }
                } /* end qtagcase */
            }
            } /* end if */

  LINE(88);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = f.vec->data[2];
            T_3_2.num = T_3_1.vec->data[0];
            err = g_tblOPfind_tbl_exprs(T_3_2, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(89);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = f.vec->data[2];
            T_3_2.num = T_3_1.vec->data[1];
            err = g_tblOPfind_tbl_exprlist(T_3_2, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(90);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = f.vec->data[1];
            T_3_2.num = T_3_1.vec->data[1];
            err = g_tblOPfind_tbls(T_3_2, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        case 12: /* if_ */ {
            CLUREF T_2_8;
            T_2_8.num = T_2_1.cell->value;
            i.num = T_2_8.num;

  LINE(92);
            { /* for sequence$elements */
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            T_3_1.num = i.vec->data[0];
            T_3_3.num = T_3_1.vec->size;
            T_3_4 = T_3_1;
            for (T_3_2.num = 1; T_3_2.num <= T_3_3.num; T_3_2.num++) {
                arm.num = T_3_4.vec->data[T_3_2.num - 1];

  LINE(93);
                {
                CLUREF T_4_1;
                T_4_1.num = arm.vec->data[2];
                err = g_tblOPfind_tbl_exprs(T_4_1, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }

  LINE(94);
                {
                CLUREF T_4_1;
                CLUREF T_4_2;
                T_4_1.num = arm.vec->data[0];
                T_4_2.num = T_4_1.vec->data[1];
                err = g_tblOPfind_tbls(T_4_2, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }
            }
            }
            end_inline_for_2:
            __CLU_END_LABEL;

  LINE(96);
            { /* qtagcase */
            CLUREF T_3_1;
            T_3_1.num = i.vec->data[1];
            switch (T_3_1.cell->tag) {
            case 1: /* body */ {
                CLUREF T_3_2;
                T_3_2.num = T_3_1.cell->value;
                b.num = T_3_2.num;

  LINE(98);
                {
                CLUREF T_4_1;
                T_4_1.num = b.vec->data[1];
                err = g_tblOPfind_tbls(T_4_1, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }
                break;
            }
            }
            } /* end qtagcase */
            break;
        }
        case 18: /* tag_ */ {
            CLUREF T_2_9;
            T_2_9.num = T_2_1.cell->value;
            t.num = T_2_9.num;

  LINE(102);
            {
            CLUREF T_3_1;
            T_3_1.num = t.vec->data[1];
            err = g_tblOPfind_tbl_exprs(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(103);
            { /* for sequence$elements */
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            T_3_1.num = t.vec->data[0];
            T_3_3.num = T_3_1.vec->size;
            T_3_4 = T_3_1;
            for (T_3_2.num = 1; T_3_2.num <= T_3_3.num; T_3_2.num++) {
                arm.num = T_3_4.vec->data[T_3_2.num - 1];

  LINE(104);
                {
                CLUREF T_4_1;
                CLUREF T_4_2;
                T_4_1.num = arm.vec->data[0];
                T_4_2.num = T_4_1.vec->data[1];
                err = g_tblOPfind_tbls(T_4_2, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }
            }
            }
            end_inline_for_3:
            __CLU_END_LABEL;

  LINE(106);
            { /* qtagcase */
            CLUREF T_3_1;
            T_3_1.num = t.vec->data[2];
            switch (T_3_1.cell->tag) {
            case 1: /* body */ {
                CLUREF T_3_2;
                T_3_2.num = T_3_1.cell->value;
                b.num = T_3_2.num;

  LINE(108);
                {
                CLUREF T_4_1;
                T_4_1.num = b.vec->data[1];
                err = g_tblOPfind_tbls(T_4_1, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }
                break;
            }
            }
            } /* end qtagcase */
            break;
        }
        case 15: /* return_ */ {
            CLUREF T_2_10;
            T_2_10.num = T_2_1.cell->value;
            el.num = T_2_10.num;

  LINE(112);
            {
            err = g_tblOPfind_tbl_exprlist(el, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        case 20: /* yield_ */ {
            CLUREF T_2_11;
            T_2_11.num = T_2_1.cell->value;
            el.num = T_2_11.num;

  LINE(114);
            {
            err = g_tblOPfind_tbl_exprlist(el, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        case 16: /* signal_ */ {
            CLUREF T_2_12;
            T_2_12.num = T_2_1.cell->value;
            c.num = T_2_12.num;

  LINE(116);
            {
            CLUREF T_3_1;
            T_3_1.num = c.vec->data[0];
            err = g_tblOPfind_tbl_exprlist(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        case 9: /* exit_ */ {
            CLUREF T_2_13;
            T_2_13.num = T_2_1.cell->value;
            c.num = T_2_13.num;

  LINE(118);
            {
            CLUREF T_3_1;
            T_3_1.num = c.vec->data[0];
            err = g_tblOPfind_tbl_exprlist(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        case 3: /* body */ {
            CLUREF T_2_14;
            T_2_14.num = T_2_1.cell->value;
            b.num = T_2_14.num;

  LINE(120);
            {
            CLUREF T_3_1;
            T_3_1.num = b.vec->data[1];
            err = g_tblOPfind_tbls(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        case 8: /* except_ */ {
            CLUREF T_2_15;
            T_2_15.num = T_2_1.cell->value;
            e.num = T_2_15.num;

  LINE(122);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = e.vec->data[2];
            err = sequenceOPfill(CLU_1, T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            err = g_tblOPfind_tbls(T_3_2, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(123);
            { /* for sequence$elements */
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            T_3_1.num = e.vec->data[0];
            T_3_3.num = T_3_1.vec->size;
            T_3_4 = T_3_1;
            for (T_3_2.num = 1; T_3_2.num <= T_3_3.num; T_3_2.num++) {
                a.num = T_3_4.vec->data[T_3_2.num - 1];

  LINE(124);
                {
                CLUREF T_4_1;
                CLUREF T_4_2;
                T_4_1.num = a.vec->data[0];
                T_4_2.num = T_4_1.vec->data[1];
                err = g_tblOPfind_tbls(T_4_2, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }
            }
            }
            end_inline_for_4:
            __CLU_END_LABEL;

  LINE(127);
            { /* qtagcase */
            CLUREF T_3_1;
            T_3_1.num = e.vec->data[1];
            switch (T_3_1.cell->tag) {
            case 1: /* arm */ {
                CLUREF T_3_2;
                T_3_2.num = T_3_1.cell->value;
                a.num = T_3_2.num;

  LINE(129);
                {
                CLUREF T_4_1;
                CLUREF T_4_2;
                T_4_1.num = a.vec->data[0];
                T_4_2.num = T_4_1.vec->data[1];
                err = g_tblOPfind_tbls(T_4_2, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }
                break;
            }
            }
            } /* end qtagcase */
            break;
        }
        case 14: /* resignal_ */ {
            CLUREF T_2_16;
            T_2_16.num = T_2_1.cell->value;
            r.num = T_2_16.num;

  LINE(133);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = r.vec->data[1];
            err = sequenceOPfill(CLU_1, T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            err = g_tblOPfind_tbls(T_3_2, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        case 11: /* force_ */ {
            CLUREF T_2_17;
            T_2_17.num = T_2_1.cell->value;
            f.num = T_2_17.num;

  LINE(135);
            {
            CLUREF T_3_1;
            T_3_1.num = f.vec->data[0];
            err = g_tblOPfind_tbl_exprs(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        case 6: /* decl */ {
            CLUREF T_2_18;
            T_2_18.num = T_2_1.cell->value;
            d.num = T_2_18.num;

  LINE(137);
            { /* if */
            CLUREF T_3_1;
            err = dbg_infoOPactive(&T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_1.num == true) { /* if */

  LINE(138);
                {
                err = g_tblOPfind_tbl_decl(d, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }
            }
            } /* end if */
            break;
        }
        }
        } /* end qtagcase */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE find_tbls ****/


/**** BEGIN PROCEDURE find_tbl_decllist ****/


errcode
g_tblOPfind_tbl_decllist(CLUREF dl, CLUREF pbl)
{
    errcode err;
    CLUREF each_d;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(145);

  LINE(146);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = dl.vec->size;
    T_1_3 = dl;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        each_d.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(147);
        {
        err = g_tblOPfind_tbl_decl(each_d, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE find_tbl_decllist ****/


/**** BEGIN PROCEDURE find_tbl_decl ****/


errcode
g_tblOPfind_tbl_decl(CLUREF d, CLUREF pbl)
{
    errcode err;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(151);

  LINE(152);
    {
    CLUREF T_1_1;
    T_1_1.num = d.vec->data[1];
    err = g_tblOPfind_tbl_type_(T_1_1, pbl);
    if (err != ERR_ok)
        goto ex_0;
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE find_tbl_decl ****/


/**** BEGIN PROCEDURE find_tbl_typelist ****/


errcode
g_tblOPfind_tbl_typelist(CLUREF tys, CLUREF pbl)
{
    errcode err;
    CLUREF ty;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(155);

  LINE(156);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = tys.vec->size;
    T_1_3 = tys;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        ty.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(157);
        {
        err = g_tblOPfind_tbl_type_(ty, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE find_tbl_typelist ****/


/**** BEGIN PROCEDURE find_tbl_type_ ****/

static int g_tblOPfind_tbl_type__own_init = 0;

errcode
g_tblOPfind_tbl_type_(CLUREF type_, CLUREF pbl)
{
    errcode err;
    CLUREF ct;
    CLUREF xt;
    CLUREF ap;
    CLUREF i;
    if (g_tblOPfind_tbl_type__own_init == 0) {
        if (g_tbl_own_init == 0) {
            err = g_tbl_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        g_tblOPfind_tbl_type__own_init = 1;
    }
    enter_proc(161);

  LINE(162);
    { /* qtagcase */
    CLUREF T_1_1;
    err = typespecOPget_abs(type_, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    switch (T_1_1.cell->tag) {
    case 3: /* cluster_ */ {
        CLUREF T_1_2;
        T_1_2.num = T_1_1.cell->value;
        ct.num = T_1_2.num;

  LINE(164);
        {
        CLUREF T_2_1;
        T_2_1.num = ct.vec->data[1];
        err = g_tblOPfind_tbl_exprlist(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(165);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        T_2_1.num = ct.vec->data[1];
        T_2_2.num = T_2_1.vec->size;
        T_2_3.num = (T_2_2.num > 0);
        if (T_2_3.num == true) { /* if */

  LINE(167);
            {
            CLUREF T_3_1;
            CellAlloc(4, ct.num, T_3_1);
            {
            if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_3_1.num;
                pbl.array->ext_size++;
                pbl.array->ext_high++;
            }
            else {
                err = arrayOPaddh(pbl, T_3_1);
                if (err != ERR_ok)
                    goto ex_0;
            }
            }
            }
        }
        else { /* else */

  LINE(170);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = ct.vec->data[0];
            err = parmd_dus(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_2.num == true) { /* if */

  LINE(173);
                {
                CLUREF T_4_1;
                CellAlloc(4, ct.num, T_4_1);
                {
                if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                    pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_4_1.num;
                    pbl.array->ext_size++;
                    pbl.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(pbl, T_4_1);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }
            }
            } /* end if */
        }} /* end if */
        break;
    }
    case 7: /* select */ {
        CLUREF T_1_3;
        T_1_3.num = T_1_1.cell->value;
        xt.num = T_1_3.num;

  LINE(176);
        {
        CLUREF T_2_1;
        T_2_1.num = xt.vec->data[1];
        err = g_tblOPfind_tbl_fieldspeclist(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(177);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        CLUREF T_2_4;
        CLUREF T_2_5;
        RecordAlloc(2, T_2_1);
        T_2_2.num = xt.vec->data[0];
        err = duOPget_common(T_2_2, &T_2_3);
        if (err != ERR_ok)
            goto ex_0;
        T_2_1.vec->data[1] = T_2_3.num;
        T_2_4.num = xt.vec->data[1];
        T_2_1.vec->data[0] = T_2_4.num;
        CellAlloc(7, T_2_1.num, T_2_5);
        {
        if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
            pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_2_5.num;
            pbl.array->ext_size++;
            pbl.array->ext_high++;
        }
        else {
            err = arrayOPaddh(pbl, T_2_5);
            if (err != ERR_ok)
                goto ex_0;
        }
        }
        }
        break;
    }
    case 2: /* apply */ {
        CLUREF T_1_4;
        T_1_4.num = T_1_1.cell->value;
        ap.num = T_1_4.num;
        break;
    }
    case 5: /* idn */ {
        CLUREF T_1_5;
        T_1_5.num = T_1_1.cell->value;
        i.num = T_1_5.num;
        break;
    }
    case 8: /* type_ */ {
        CLUREF T_1_6;
        T_1_6.num = T_1_1.cell->value;
        ct.num = T_1_6.num;

  LINE(201);
        {
        CLUREF T_2_1;
        T_2_1.num = ct.vec->data[1];
        err = g_tblOPfind_tbl_exprlist(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(203);
        {
        CLUREF T_2_1;
        CellAlloc(4, ct.num, T_2_1);
        {
        if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
            pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_2_1.num;
            pbl.array->ext_size++;
            pbl.array->ext_high++;
        }
        else {
            err = arrayOPaddh(pbl, T_2_1);
            if (err != ERR_ok)
                goto ex_0;
        }
        }
        }
        break;
    }
    case 4: /* cvt_ */ {
        break;
    }
    case 1: /* any_ */ {
        break;
    }
    default: {

  LINE(217);
        {
        CLUREF T_2_1;
        T_2_1.num = 700;
        err = compiler_logit(T_2_1, STR_find_137tbl_137type_137_072_040others);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(218);
        {
        err = typespec_print(type_);
        if (err != ERR_ok)
            goto ex_0;
        }
        break;
    }
    }
    } /* end qtagcase */

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE find_tbl_type_ ****/


/**** BEGIN PROCEDURE find_tbl_exprlist ****/


errcode
g_tblOPfind_tbl_exprlist(CLUREF el, CLUREF pbl)
{
    errcode err;
    CLUREF each_e;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(224);

  LINE(225);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = el.vec->size;
    T_1_3 = el;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        each_e.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(226);
        {
        err = g_tblOPfind_tbl_exprs(each_e, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE find_tbl_exprlist ****/


/**** BEGIN PROCEDURE find_tbl_fieldspeclist ****/


errcode
g_tblOPfind_tbl_fieldspeclist(CLUREF fl, CLUREF pbl)
{
    errcode err;
    CLUREF each_f;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(232);

  LINE(233);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = fl.vec->size;
    T_1_3 = fl;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        each_f.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(234);
        {
        err = g_tblOPfind_tbl_field(each_f, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE find_tbl_fieldspeclist ****/


/**** BEGIN PROCEDURE find_tbl_exprs ****/

static int g_tblOPfind_tbl_exprs_own_init = 0;

errcode
g_tblOPfind_tbl_exprs(CLUREF exp, CLUREF pbl)
{
    errcode err;
    CLUREF ct;
    CLUREF cop;
    CLUREF sel;
    CLUREF a;
    CLUREF s;
    CLUREF this_field;
    CLUREF c;
    CLUREF inv;
    CLUREF e;
    CLUREF t;
    CLUREF ex;
    CLUREF ty;
    if (g_tblOPfind_tbl_exprs_own_init == 0) {
        if (g_tbl_own_init == 0) {
            err = g_tbl_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        g_tblOPfind_tbl_exprs_own_init = 1;
    }
    enter_proc(241);

  LINE(246);
    { /* qtagcase */
    CLUREF T_1_1;
    err = exprOPget_abs(exp, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    switch (T_1_1.cell->tag) {
    case 3: /* apply */ {
        CLUREF T_1_2;
        T_1_2.num = T_1_1.cell->value;
        ct.num = T_1_2.num;

  LINE(248);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        err = g_tblOPbase_apply_test(ct, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        T_2_2.num = !T_2_1.num;
        if (T_2_2.num == true) { /* if */

  LINE(249);
            {
            CLUREF T_3_1;
            T_3_1.num = ct.vec->data[1];
            err = g_tblOPfind_tbl_exprlist(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(250);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            T_3_1.num = ct.vec->data[1];
            T_3_2.num = T_3_1.vec->size;
            T_3_3.num = (T_3_2.num > 0);
            if (T_3_3.num == true) { /* if */

  LINE(253);
                {
                CLUREF T_4_1;
                CellAlloc(4, ct.num, T_4_1);
                {
                if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                    pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_4_1.num;
                    pbl.array->ext_size++;
                    pbl.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(pbl, T_4_1);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }
            }
            else { /* else */

  LINE(256);
                { /* if */
                CLUREF T_4_1;
                CLUREF T_4_2;
                T_4_1.num = ct.vec->data[0];
                err = parmd_dus(T_4_1, &T_4_2);
                if (err != ERR_ok)
                    goto ex_0;
                if (T_4_2.num == true) { /* if */

  LINE(259);
                    {
                    CLUREF T_5_1;
                    CellAlloc(4, ct.num, T_5_1);
                    {
                    if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                        pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_5_1.num;
                        pbl.array->ext_size++;
                        pbl.array->ext_high++;
                    }
                    else {
                        err = arrayOPaddh(pbl, T_5_1);
                        if (err != ERR_ok)
                            goto ex_0;
                    }
                    }
                    }
                }
                } /* end if */
            }} /* end if */
        }
        } /* end if */
        break;
    }
    case 20: /* op */ {
        CLUREF T_1_3;
        T_1_3.num = T_1_1.cell->value;
        cop.num = T_1_3.num;

  LINE(263);
        { /* qtagcase */
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = cop.vec->data[2];
        err = typespecOPget_abs(T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        switch (T_2_2.cell->tag) {
        case 7: /* select */ {
            CLUREF T_2_3;
            T_2_3.num = T_2_2.cell->value;
            sel.num = T_2_3.num;

  LINE(265);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            CLUREF T_3_5;
            err = dbg_infoOPactive(&T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            T_3_1.num = T_3_2.num;
            if (!T_3_2.num) {
                T_3_3.num = sel.vec->data[0];
                T_3_4.num = cop.vec->data[0];
                err = parmd_op(T_3_3, T_3_4, &T_3_5);
                if (err != ERR_ok)
                    goto ex_0;
                T_3_1.num = T_3_5.num;
            }
            if (T_3_1.num == true) { /* if */

  LINE(266);
                {
                CLUREF T_4_1;
                T_4_1.num = sel.vec->data[1];
                err = g_tblOPfind_tbl_fieldspeclist(T_4_1, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }

  LINE(268);
                {
                CLUREF T_4_1;
                CLUREF T_4_2;
                CLUREF T_4_3;
                CLUREF T_4_4;
                CLUREF T_4_5;
                RecordAlloc(2, T_4_1);
                T_4_2.num = sel.vec->data[0];
                err = duOPget_common(T_4_2, &T_4_3);
                if (err != ERR_ok)
                    goto ex_0;
                T_4_1.vec->data[1] = T_4_3.num;
                T_4_4.num = sel.vec->data[1];
                T_4_1.vec->data[0] = T_4_4.num;
                CellAlloc(7, T_4_1.num, T_4_5);
                {
                if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                    pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_4_5.num;
                    pbl.array->ext_size++;
                    pbl.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(pbl, T_4_5);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }
            }
            } /* end if */
            break;
        }
        case 2: /* apply */ {
            CLUREF T_2_4;
            T_2_4.num = T_2_2.cell->value;
            a.num = T_2_4.num;

  LINE(273);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = a.vec->data[1];
            err = parmd_op(T_3_1, CLU_empty_string, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_2.num == true) { /* if */

  LINE(274);
                {
                CLUREF T_4_1;
                T_4_1.num = cop.vec->data[1];
                err = g_tblOPfind_tbl_exprlist(T_4_1, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }

  LINE(276);
                {
                CLUREF T_4_1;
                CellAlloc(6, cop.num, T_4_1);
                {
                if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                    pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_4_1.num;
                    pbl.array->ext_size++;
                    pbl.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(pbl, T_4_1);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }
            }
            } /* end if */
            break;
        }
        case 3: /* cluster_ */ /* FALLTHROUGH */
        case 8: /* type_ */ {
            CLUREF T_2_5;
            T_2_5.num = T_2_2.cell->value;
            ct.num = T_2_5.num;

  LINE(278);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            CLUREF T_3_5;
            CLUREF T_3_6;
            CLUREF T_3_7;
            err = dbg_infoOPactive(&T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            T_3_1.num = T_3_2.num;
            if (!T_3_2.num) {
                T_3_4.num = ct.vec->data[0];
                err = parmd_dus(T_3_4, &T_3_5);
                if (err != ERR_ok)
                    goto ex_0;
                T_3_3.num = T_3_5.num;
                if (T_3_5.num) {
                    err = g_tblOPbase_cluster_test(cop, ct, &T_3_6);
                    if (err != ERR_ok)
                        goto ex_0;
                    T_3_7.num = !T_3_6.num;
                    T_3_3.num = T_3_7.num;
                }
                T_3_1.num = T_3_3.num;
            }
            if (T_3_1.num == true) { /* if */

  LINE(281);
                {
                CLUREF T_4_1;
                T_4_1.num = cop.vec->data[1];
                err = g_tblOPfind_tbl_exprlist(T_4_1, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }

  LINE(282);
                {
                CLUREF T_4_1;
                T_4_1.num = ct.vec->data[1];
                err = g_tblOPfind_tbl_exprlist(T_4_1, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }

  LINE(284);
                {
                CLUREF T_4_1;
                CellAlloc(4, ct.num, T_4_1);
                {
                if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                    pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_4_1.num;
                    pbl.array->ext_size++;
                    pbl.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(pbl, T_4_1);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }

  LINE(285);
                {
                CLUREF T_4_1;
                CellAlloc(6, cop.num, T_4_1);
                {
                if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                    pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_4_1.num;
                    pbl.array->ext_size++;
                    pbl.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(pbl, T_4_1);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }
            }
            } /* end if */
            break;
        }
        case 5: /* idn */ {
            break;
        }
        }
        } /* end qtagcase */
        break;
    }
    case 23: /* s_cons */ {
        CLUREF T_1_4;
        T_1_4.num = T_1_1.cell->value;
        s.num = T_1_4.num;

  LINE(293);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        T_2_1.num = s.vec->data[1];
        err = typespecOPget_abs(T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_2.cell->tag == 7) T_2_3.num = true; else T_2_3.num = false;
        if (T_2_3.num == true) { /* if */

  LINE(294);
            { /* if */
            CLUREF T_3_1;
            err = dbg_infoOPactive(&T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_1.num == true) { /* if */

  LINE(295);
                {
                CLUREF T_4_1;
                T_4_1.num = s.vec->data[1];
                err = g_tblOPfind_tbl_type_(T_4_1, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }
            }
            } /* end if */

  LINE(296);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            T_3_1.num = s.vec->data[1];
            err = typespecOPget_abs(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_2.cell->tag != 7) {
                err = ERR_wrong_tag;
                goto ex_0;
            }
            T_3_3.num = T_3_2.cell->value;
            sel.num = T_3_3.num;
            }

  LINE(297);
            { /* for sequence$elements */
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            T_3_1.num = s.vec->data[0];
            T_3_3.num = T_3_1.vec->size;
            T_3_4 = T_3_1;
            for (T_3_2.num = 1; T_3_2.num <= T_3_3.num; T_3_2.num++) {
                this_field.num = T_3_4.vec->data[T_3_2.num - 1];

  LINE(298);
                {
                CLUREF T_4_1;
                T_4_1.num = this_field.vec->data[2];
                err = g_tblOPfind_tbl_exprs(T_4_1, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }
            }
            }
            end_inline_for_1:
            __CLU_END_LABEL;

  LINE(303);
            { /* if */
            CLUREF T_3_1;
            err = dbg_infoOPactive(&T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_1.num == true) { /* if */

  LINE(304);
                {
                CLUREF T_4_1;
                CLUREF T_4_2;
                CLUREF T_4_3;
                CLUREF T_4_4;
                CLUREF T_4_5;
                CLUREF T_4_6;
                CLUREF T_4_7;
                CLUREF T_4_8;
                RecordAlloc(2, T_4_1);
                T_4_2.num = sel.vec->data[0];
                err = duOPget_common(T_4_2, &T_4_3);
                if (err != ERR_ok)
                    goto ex_0;
                T_4_1.vec->data[1] = T_4_3.num;
                T_4_4.num = s.vec->data[1];
                err = typespecOPget_abs(T_4_4, &T_4_5);
                if (err != ERR_ok)
                    goto ex_0;
                if (T_4_5.cell->tag != 7) {
                    err = ERR_wrong_tag;
                    goto ex_0;
                }
                T_4_6.num = T_4_5.cell->value;
                T_4_7.num = T_4_6.vec->data[1];
                T_4_1.vec->data[0] = T_4_7.num;
                CellAlloc(7, T_4_1.num, T_4_8);
                {
                if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                    pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_4_8.num;
                    pbl.array->ext_size++;
                    pbl.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(pbl, T_4_8);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }
            }
            } /* end if */
        }
        else { /* else */

  LINE(308);
            {
            CLUREF T_3_1;
            T_3_1.num = 701;
            err = compiler_logit(T_3_1, STR_find_137tbl_137exprs_072_040s_137cons_040not_040select);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(309);
            {
            CLUREF T_3_1;
            T_3_1.num = s.vec->data[1];
            err = typespec_print(T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            }
        }} /* end if */
        break;
    }
    case 1: /* a_cons */ {
        CLUREF T_1_5;
        T_1_5.num = T_1_1.cell->value;
        a.num = T_1_5.num;

  LINE(312);
        { /* if */
        CLUREF T_2_1;
        err = dbg_infoOPactive(&T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_1.num == true) { /* if */

  LINE(313);
            {
            CLUREF T_3_1;
            T_3_1.num = a.vec->data[2];
            err = g_tblOPfind_tbl_type_(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
        }
        } /* end if */

  LINE(314);
        {
        CLUREF T_2_1;
        T_2_1.num = a.vec->data[0];
        err = g_tblOPfind_tbl_exprlist(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(315);
        { /* if */
        CLUREF T_2_1;
        err = dbg_infoOPactive(&T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_1.num == true) { /* if */

  LINE(316);
            {
            CLUREF T_3_1;
            CellAlloc(1, a.num, T_3_1);
            {
            if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_3_1.num;
                pbl.array->ext_size++;
                pbl.array->ext_high++;
            }
            else {
                err = arrayOPaddh(pbl, T_3_1);
                if (err != ERR_ok)
                    goto ex_0;
            }
            }
            }
        }
        } /* end if */
        break;
    }
    case 6: /* cand_ */ {
        CLUREF T_1_6;
        T_1_6.num = T_1_1.cell->value;
        c.num = T_1_6.num;

  LINE(318);
        {
        CLUREF T_2_1;
        T_2_1.num = c.vec->data[0];
        err = g_tblOPfind_tbl_exprs(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(319);
        {
        CLUREF T_2_1;
        T_2_1.num = c.vec->data[1];
        err = g_tblOPfind_tbl_exprs(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }
        break;
    }
    case 8: /* cor_ */ {
        CLUREF T_1_7;
        T_1_7.num = T_1_1.cell->value;
        c.num = T_1_7.num;

  LINE(321);
        {
        CLUREF T_2_1;
        T_2_1.num = c.vec->data[0];
        err = g_tblOPfind_tbl_exprs(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(322);
        {
        CLUREF T_2_1;
        T_2_1.num = c.vec->data[1];
        err = g_tblOPfind_tbl_exprs(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }
        break;
    }
    case 16: /* invoke */ {
        CLUREF T_1_8;
        T_1_8.num = T_1_1.cell->value;
        inv.num = T_1_8.num;

  LINE(324);
        {
        CLUREF T_2_1;
        T_2_1.num = inv.vec->data[0];
        err = g_tblOPfind_tbl_exprs(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(325);
        {
        CLUREF T_2_1;
        T_2_1.num = inv.vec->data[1];
        err = g_tblOPfind_tbl_exprlist(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }
        break;
    }
    case 27: /* up_ */ {
        CLUREF T_1_9;
        T_1_9.num = T_1_1.cell->value;
        e.num = T_1_9.num;

  LINE(327);
        {
        err = g_tblOPfind_tbl_exprs(e, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }
        break;
    }
    case 9: /* down_ */ {
        CLUREF T_1_10;
        T_1_10.num = T_1_1.cell->value;
        e.num = T_1_10.num;

  LINE(329);
        {
        err = g_tblOPfind_tbl_exprs(e, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }
        break;
    }
    case 25: /* type_ */ {
        CLUREF T_1_11;
        T_1_11.num = T_1_1.cell->value;
        t.num = T_1_11.num;

  LINE(331);
        { /* qtagcase */
        CLUREF T_2_1;
        err = typespecOPget_abs(t, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        switch (T_2_1.cell->tag) {
        case 7: /* select */ {
            CLUREF T_2_2;
            T_2_2.num = T_2_1.cell->value;
            sel.num = T_2_2.num;

  LINE(333);
            {
            CLUREF T_3_1;
            T_3_1.num = sel.vec->data[1];
            err = g_tblOPfind_tbl_fieldspeclist(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(335);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            CLUREF T_3_5;
            RecordAlloc(2, T_3_1);
            T_3_2.num = sel.vec->data[0];
            err = duOPget_common(T_3_2, &T_3_3);
            if (err != ERR_ok)
                goto ex_0;
            T_3_1.vec->data[1] = T_3_3.num;
            T_3_4.num = sel.vec->data[1];
            T_3_1.vec->data[0] = T_3_4.num;
            CellAlloc(7, T_3_1.num, T_3_5);
            {
            if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_3_5.num;
                pbl.array->ext_size++;
                pbl.array->ext_high++;
            }
            else {
                err = arrayOPaddh(pbl, T_3_5);
                if (err != ERR_ok)
                    goto ex_0;
            }
            }
            }
            break;
        }
        case 2: /* apply */ {
            CLUREF T_2_3;
            T_2_3.num = T_2_1.cell->value;
            a.num = T_2_3.num;

  LINE(339);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = a.vec->data[1];
            err = parmd_dus(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_2.num == true) { /* if */
            }
            } /* end if */
            break;
        }
        case 3: /* cluster_ */ /* FALLTHROUGH */
        case 8: /* type_ */ {
            CLUREF T_2_4;
            T_2_4.num = T_2_1.cell->value;
            ct.num = T_2_4.num;

  LINE(347);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            err = dbg_infoOPactive(&T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            T_3_1.num = T_3_2.num;
            if (!T_3_2.num) {
                T_3_3.num = ct.vec->data[0];
                err = parmd_dus(T_3_3, &T_3_4);
                if (err != ERR_ok)
                    goto ex_0;
                T_3_1.num = T_3_4.num;
            }
            if (T_3_1.num == true) { /* if */

  LINE(348);
                {
                CLUREF T_4_1;
                T_4_1.num = ct.vec->data[1];
                err = g_tblOPfind_tbl_exprlist(T_4_1, pbl);
                if (err != ERR_ok)
                    goto ex_0;
                }

  LINE(351);
                {
                CLUREF T_4_1;
                CellAlloc(4, ct.num, T_4_1);
                {
                if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                    pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_4_1.num;
                    pbl.array->ext_size++;
                    pbl.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(pbl, T_4_1);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }
            }
            } /* end if */
            break;
        }
        case 5: /* idn */ {
            break;
        }
        case 1: /* any_ */ {
            break;
        }
        default: {

  LINE(356);
            {
            CLUREF T_3_1;
            T_3_1.num = 703;
            err = compiler_logit(T_3_1, STR_type_137_072_040unhandled_040typespec);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(357);
            {
            err = typespec_print(t);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        }
        } /* end qtagcase */
        break;
    }
    case 2: /* any_ */ {
        CLUREF T_1_12;
        T_1_12.num = T_1_1.cell->value;
        ex.num = T_1_12.num;

  LINE(360);
        {
        err = g_tblOPfind_tbl_exprs(ex, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(361);
        {
        CLUREF T_2_1;
        err = exprOPget_typespec(ex, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        err = g_tblOPfind_tbl_type_(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(362);
        {
        CLUREF T_2_1;
        CellAlloc(3, ex.num, T_2_1);
        {
        if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
            pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_2_1.num;
            pbl.array->ext_size++;
            pbl.array->ext_high++;
        }
        else {
            err = arrayOPaddh(pbl, T_2_1);
            if (err != ERR_ok)
                goto ex_0;
        }
        }
        }
        break;
    }
    case 11: /* force_ */ {
        CLUREF T_1_13;
        T_1_13.num = T_1_1.cell->value;
        ty.num = T_1_13.num;

  LINE(364);
        {
        err = g_tblOPfind_tbl_type_(ty, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(367);
        {
        CLUREF T_2_1;
        CellAlloc(5, ty.num, T_2_1);
        {
        if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
            pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_2_1.num;
            pbl.array->ext_size++;
            pbl.array->ext_high++;
        }
        else {
            err = arrayOPaddh(pbl, T_2_1);
            if (err != ERR_ok)
                goto ex_0;
        }
        }
        }
        break;
    }
    case 26: /* type_of_ */ {
        CLUREF T_1_14;
        T_1_14.num = T_1_1.cell->value;
        ex.num = T_1_14.num;

  LINE(369);
        {
        CLUREF T_2_1;
        T_2_1.num = 705;
        err = compiler_logit(T_2_1, STR_type_137of_137);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(370);
        {
        err = expr_print(exp, CLU_9);
        if (err != ERR_ok)
            goto ex_0;
        }
        break;
    }
    case 13: /* idn */ {

  LINE(372);
        { /* if */
        CLUREF T_2_1;
        err = dbg_infoOPactive(&T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_1.num == true) { /* if */

  LINE(373);
            {
            CLUREF T_3_1;
            err = exprOPget_typespec(exp, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            err = g_tblOPfind_tbl_type_(T_3_1, pbl);
            if (err != ERR_ok)
                goto ex_0;
            }
        }
        } /* end if */
        break;
    }
    }
    } /* end qtagcase */

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE find_tbl_exprs ****/


/**** BEGIN PROCEDURE find_tbl_field ****/


errcode
g_tblOPfind_tbl_field(CLUREF f, CLUREF pbl)
{
    errcode err;
    CLUREF ct;
    CLUREF sel;
    CLUREF a;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(382);

  LINE(383);
    { /* qtagcase */
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = f.vec->data[1];
    err = typespecOPget_abs(T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    switch (T_1_2.cell->tag) {
    case 3: /* cluster_ */ /* FALLTHROUGH */
    case 8: /* type_ */ {
        CLUREF T_1_3;
        T_1_3.num = T_1_2.cell->value;
        ct.num = T_1_3.num;

  LINE(385);
        {
        CLUREF T_2_1;
        T_2_1.num = ct.vec->data[1];
        err = g_tblOPfind_tbl_exprlist(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(386);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        T_2_1.num = ct.vec->data[1];
        T_2_2.num = T_2_1.vec->size;
        T_2_3.num = (T_2_2.num > 0);
        if (T_2_3.num == true) { /* if */

  LINE(390);
            {
            CLUREF T_3_1;
            CellAlloc(4, ct.num, T_3_1);
            {
            if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_3_1.num;
                pbl.array->ext_size++;
                pbl.array->ext_high++;
            }
            else {
                err = arrayOPaddh(pbl, T_3_1);
                if (err != ERR_ok)
                    goto ex_0;
            }
            }
            }
        }
        else { /* else */

  LINE(392);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            T_3_2.num = ct.vec->data[0];
            err = parmd_dus(T_3_2, &T_3_3);
            if (err != ERR_ok)
                goto ex_0;
            T_3_1.num = T_3_3.num;
            if (!T_3_3.num) {
                err = dbg_infoOPactive(&T_3_4);
                if (err != ERR_ok)
                    goto ex_0;
                T_3_1.num = T_3_4.num;
            }
            if (T_3_1.num == true) { /* if */

  LINE(396);
                {
                CLUREF T_4_1;
                CellAlloc(4, ct.num, T_4_1);
                {
                if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
                    pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_4_1.num;
                    pbl.array->ext_size++;
                    pbl.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(pbl, T_4_1);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }
            }
            } /* end if */
        }} /* end if */
        break;
    }
    case 7: /* select */ {
        CLUREF T_1_4;
        T_1_4.num = T_1_2.cell->value;
        sel.num = T_1_4.num;

  LINE(401);
        {
        CLUREF T_2_1;
        T_2_1.num = sel.vec->data[1];
        err = g_tblOPfind_tbl_fieldspeclist(T_2_1, pbl);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(403);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        CLUREF T_2_4;
        CLUREF T_2_5;
        RecordAlloc(2, T_2_1);
        T_2_2.num = sel.vec->data[0];
        err = duOPget_common(T_2_2, &T_2_3);
        if (err != ERR_ok)
            goto ex_0;
        T_2_1.vec->data[1] = T_2_3.num;
        T_2_4.num = sel.vec->data[1];
        T_2_1.vec->data[0] = T_2_4.num;
        CellAlloc(7, T_2_1.num, T_2_5);
        {
        if ((pbl.array->int_low + pbl.array->ext_size + 1) < pbl.array->int_size) {
            pbl.array->store->data[pbl.array->int_low + pbl.array->ext_size] = T_2_5.num;
            pbl.array->ext_size++;
            pbl.array->ext_high++;
        }
        else {
            err = arrayOPaddh(pbl, T_2_5);
            if (err != ERR_ok)
                goto ex_0;
        }
        }
        }
        break;
    }
    case 2: /* apply */ {
        CLUREF T_1_5;
        T_1_5.num = T_1_2.cell->value;
        a.num = T_1_5.num;
        break;
    }
    case 5: /* idn */ /* FALLTHROUGH */
    case 1: /* any_ */ /* FALLTHROUGH */
    case 4: /* cvt_ */ /* FALLTHROUGH */
    case 9: /* unknown */ /* FALLTHROUGH */
    case 11: /* xsel */ /* FALLTHROUGH */
    case 10: /* xclu */ /* FALLTHROUGH */
    case 6: /* other */ {
        break;
    }
    }
    } /* end qtagcase */

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE find_tbl_field ****/


/**** BEGIN PROCEDURE tbl_uniq ****/

struct OPS *sequence_of_idn_ops __CLU_COMMON;
struct OPS *sequence_of_expr_ops __CLU_COMMON;
struct OPS *record_sel_type__ops __CLU_COMMON;
struct OPS *sequence_of_record_sel_type__ops __CLU_COMMON;
static int g_tblOPtbl_uniq_own_init = 0;

errcode
g_tblOPtbl_uniq(CLUREF pbl, CLUREF *ret_1)
{
    errcode err;
    CLUREF low;
    CLUREF size;
    CLUREF newpbl;
    CLUREF index;
    CLUREF possible_pb;
    CLUREF possible_formals;
    CLUREF possible_actuals;
    CLUREF possible_fl;
    CLUREF possible_name;
    CLUREF possible_type;
    CLUREF each_pb;
    CLUREF formals;
    CLUREF actuals;
    CLUREF s;
    CLUREF each_fl;
    CLUREF ex;
    CLUREF ty;
    if (g_tblOPtbl_uniq_own_init == 0) {
        if (g_tbl_own_init == 0) {
            err = g_tbl_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        g_tblOPtbl_uniq_own_init = 1;
    }
    enter_proc(412);

  LINE(413);
    {
    CLUREF T_1_1;
    T_1_1.num = pbl.array->ext_low;
    low.num = T_1_1.num;
    }

  LINE(414);
    {
    CLUREF T_1_1;
    T_1_1.num = pbl.array->ext_size;
    size.num = T_1_1.num;
    }

  LINE(415);
    { /* if */
    CLUREF T_1_1;
    T_1_1.num = (size.num <= 1);
    if (T_1_1.num == true) { /* if */
        { /* return */
        {
        ret_1->num = pbl.num;
        }
        signal (ERR_ok);
        }
    }
    } /* end if */

  LINE(416);
    {
    CLUREF T_1_1;
    err = arrayOPnew(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    newpbl.num = T_1_1.num;
    }

  LINE(417);
    {
    CLUREF T_1_1;
    if (low.num < pbl.array->ext_low || low.num > pbl.array->ext_high) {
        err = ERR_bounds;
        goto ex_0;
    }
    T_1_1.num = pbl.array->store->data[low.num - pbl.array->ext_low + pbl.array->int_low];
    {
    if ((newpbl.array->int_low + newpbl.array->ext_size + 1) < newpbl.array->int_size) {
        newpbl.array->store->data[newpbl.array->int_low + newpbl.array->ext_size] = T_1_1.num;
        newpbl.array->ext_size++;
        newpbl.array->ext_high++;
    }
    else {
        err = arrayOPaddh(newpbl, T_1_1);
        if (err != ERR_ok)
            goto ex_0;
    }
    }
    }

  LINE(420);
    { /* for int$from_to */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_1.num = low.num + 1;
    if ((T_1_1.num > 0 && low.num < 0 && 1 < 0) ||
        (T_1_1.num < 0 && low.num > 0 && 1 > 0)) {
        err = ERR_overflow;
        goto ex_0;
    }
    T_1_3.num = size.num;
    for (T_1_2.num = T_1_1.num; T_1_2.num <= T_1_3.num; T_1_2.num++
    ) {
        index.num = T_1_2.num;

  LINE(422);
        {
        CLUREF T_2_1;
        if (index.num < pbl.array->ext_low || index.num > pbl.array->ext_high) {
            err = ERR_bounds;
            goto ex_0;
        }
        T_2_1.num = pbl.array->store->data[index.num - pbl.array->ext_low + pbl.array->int_low];
        possible_pb.num = T_2_1.num;
        }

  LINE(428);
        { /* qtagcase */
        switch (possible_pb.cell->tag) {
        case 7: /* selinfo */ {

  LINE(430);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            if (possible_pb.cell->tag != 7) {
                err = ERR_wrong_tag;
                goto ex_0;
            }
            T_3_1.num = possible_pb.cell->value;
            T_3_2.num = T_3_1.vec->data[0];
            possible_fl.num = T_3_2.num;
            }

  LINE(431);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            if (possible_pb.cell->tag != 7) {
                err = ERR_wrong_tag;
                goto ex_0;
            }
            T_3_1.num = possible_pb.cell->value;
            T_3_2.num = T_3_1.vec->data[1];
            possible_name.num = T_3_2.num;
            }
            break;
        }
        case 3: /* any_ */ {

  LINE(433);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            if (possible_pb.cell->tag != 3) {
                err = ERR_wrong_tag;
                goto ex_0;
            }
            T_3_1.num = possible_pb.cell->value;
            err = exprOPget_typespec(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            possible_type.num = T_3_2.num;
            }
            break;
        }
        case 5: /* force_ */ {

  LINE(435);
            {
            CLUREF T_3_1;
            if (possible_pb.cell->tag != 5) {
                err = ERR_wrong_tag;
                goto ex_0;
            }
            T_3_1.num = possible_pb.cell->value;
            possible_type.num = T_3_1.num;
            }
            break;
        }
        default: {

  LINE(437);
            {
            CLUREF T_3_1;
            err = pb_formals(possible_pb, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            possible_formals.num = T_3_1.num;
            }

  LINE(438);
            {
            CLUREF T_3_1;
            err = pb_actuals(possible_pb, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            possible_actuals.num = T_3_1.num;
            }
            break;
        }
        }
        } /* end qtagcase */

  LINE(440);
        { /* for array$elements */
        CLUREF T_3_1;
        CLUREF T_3_2;
        CLUREF T_3_3;
        T_3_2.num = newpbl.array->ext_high;
        T_3_3 = newpbl;
        for (T_3_1.num = newpbl.array->ext_low; T_3_1.num <= T_3_2.num; T_3_1.num++) {
            if (T_3_1.num > T_3_3.array->ext_high || T_3_1.num < T_3_3.array->ext_low) {
                err = ERR_failure;
                elist[0] = array_bounds_exception_STRING;
                goto ex_1;
            }
            each_pb.num = T_3_3.array->store->data[T_3_1.num - T_3_3.array->ext_low + T_3_3.array->int_low];

  LINE(441);
            { /* qtagcase */
            switch (each_pb.cell->tag) {
            case 6: /* op */ /* FALLTHROUGH */
            case 1: /* a_cons */ /* FALLTHROUGH */
            case 4: /* apply */ /* FALLTHROUGH */
            case 2: /* ainfo */ /* FALLTHROUGH */
            case 8: /* tinfo */ {

  LINE(443);
                { /* if */
                CLUREF T_5_1;
                if (possible_pb.cell->tag == 7) T_5_1.num = true; else T_5_1.num = false;
                if (T_5_1.num == true) { /* if */
                    continue;
                }
                } /* end if */

  LINE(444);
                { /* if */
                CLUREF T_5_1;
                if (possible_pb.cell->tag == 3) T_5_1.num = true; else T_5_1.num = false;
                if (T_5_1.num == true) { /* if */
                    continue;
                }
                } /* end if */

  LINE(445);
                { /* if */
                CLUREF T_5_1;
                if (possible_pb.cell->tag == 5) T_5_1.num = true; else T_5_1.num = false;
                if (T_5_1.num == true) { /* if */
                    continue;
                }
                } /* end if */

  LINE(446);
                {
                CLUREF T_5_1;
                err = pb_formals(each_pb, &T_5_1);
                if (err != ERR_ok)
                    goto ex_1;
                formals.num = T_5_1.num;
                }

  LINE(447);
                {
                CLUREF T_5_1;
                err = pb_actuals(each_pb, &T_5_1);
                if (err != ERR_ok)
                    goto ex_1;
                actuals.num = T_5_1.num;
                }

  LINE(448);
                { /* if */
                CLUREF T_5_1;
                CLUREF T_5_2;
                CLUREF T_5_3;
                generic_CLU_proc.type_owns = sequence_of_idn_ops->type_owns;
                generic_CLU_proc.proc = sequenceOPsimilar;
                CUR_PROC_VAR.proc = &generic_CLU_proc;
                err = sequenceOPsimilar(possible_formals, formals, &T_5_2);
                if (err != ERR_ok)
                    goto ex_1;
                T_5_1.num = T_5_2.num;
                if (T_5_2.num) {
                    generic_CLU_proc.type_owns = sequence_of_expr_ops->type_owns;
                    generic_CLU_proc.proc = sequenceOPsimilar;
                    CUR_PROC_VAR.proc = &generic_CLU_proc;
                    err = sequenceOPsimilar(possible_actuals, actuals, &T_5_3);
                    if (err != ERR_ok)
                        goto ex_1;
                    T_5_1.num = T_5_3.num;
                }
                if (T_5_1.num == true) { /* if */

  LINE(450);
                    { /* exit */
                        err = ERR_cont;
                        goto ex_1;
                    }
                }
                } /* end if */
                break;
            }
            case 7: /* selinfo */ {
                CLUREF T_4_1;
                T_4_1.num = each_pb.cell->value;
                s.num = T_4_1.num;

  LINE(452);
                { /* if */
                CLUREF T_5_1;
                CLUREF T_5_2;
                if (possible_pb.cell->tag == 7) T_5_1.num = true; else T_5_1.num = false;
                T_5_2.num = !T_5_1.num;
                if (T_5_2.num == true) { /* if */
                    continue;
                }
                } /* end if */

  LINE(453);
                { /* if */
                CLUREF T_5_1;
                CLUREF T_5_2;
                CLUREF T_5_3;
                T_5_1.num = s.vec->data[1];
                T_5_2.num = ((T_5_1.str->size != possible_name.str->size)? false :
                    !(memcmp(T_5_1.str->data, possible_name.str->data, T_5_1.str->size)));
                T_5_3.num = !T_5_2.num;
                if (T_5_3.num == true) { /* if */
                    continue;
                }
                } /* end if */

  LINE(454);
                {
                CLUREF T_5_1;
                T_5_1.num = s.vec->data[0];
                each_fl.num = T_5_1.num;
                }

  LINE(455);
                { /* if */
                CLUREF T_5_1;
                generic_CLU_proc.type_owns = sequence_of_record_sel_type__ops->type_owns;
                generic_CLU_proc.proc = sequenceOPsimilar;
                CUR_PROC_VAR.proc = &generic_CLU_proc;
                err = sequenceOPsimilar(possible_fl, each_fl, &T_5_1);
                if (err != ERR_ok)
                    goto ex_1;
                if (T_5_1.num == true) { /* if */

  LINE(456);
                    { /* exit */
                        err = ERR_cont;
                        goto ex_1;
                    }
                }
                } /* end if */
                break;
            }
            case 3: /* any_ */ {
                CLUREF T_4_2;
                T_4_2.num = each_pb.cell->value;
                ex.num = T_4_2.num;

  LINE(458);
                { /* if */
                CLUREF T_5_1;
                CLUREF T_5_2;
                if (possible_pb.cell->tag == 3) T_5_1.num = true; else T_5_1.num = false;
                T_5_2.num = !T_5_1.num;
                if (T_5_2.num == true) { /* if */
                    continue;
                }
                } /* end if */

  LINE(459);
                { /* if */
                CLUREF T_5_1;
                CLUREF T_5_2;
                err = exprOPget_typespec(ex, &T_5_1);
                if (err != ERR_ok)
                    goto ex_1;
                err = typespecOPsimilar(T_5_1, possible_type, &T_5_2);
                if (err != ERR_ok)
                    goto ex_1;
                if (T_5_2.num == true) { /* if */

  LINE(460);
                    { /* exit */
                        err = ERR_cont;
                        goto ex_1;
                    }
                }
                } /* end if */
                break;
            }
            case 5: /* force_ */ {
                CLUREF T_4_3;
                T_4_3.num = each_pb.cell->value;
                ty.num = T_4_3.num;

  LINE(462);
                { /* if */
                CLUREF T_5_1;
                CLUREF T_5_2;
                if (possible_pb.cell->tag == 5) T_5_1.num = true; else T_5_1.num = false;
                T_5_2.num = !T_5_1.num;
                if (T_5_2.num == true) { /* if */
                    continue;
                }
                } /* end if */

  LINE(463);
                { /* if */
                CLUREF T_5_1;
                err = typespecOPsimilar(ty, possible_type, &T_5_1);
                if (err != ERR_ok)
                    goto ex_1;
                if (T_5_1.num == true) { /* if */

  LINE(464);
                    { /* exit */
                        err = ERR_cont;
                        goto ex_1;
                    }
                }
                } /* end if */
                break;
            }
            }
            } /* end qtagcase */
        }
        }
        end_inline_for_2:
        __CLU_END_LABEL;
        goto end_1;
      ex_1: /* except */
        __CLU_EX_HANDLER;
        if (err == ERR_cont) {

  LINE(467);
            continue;
        }
        else { /* not handled */
            goto ex_0;
        }
      end_1:;

  LINE(468);
        {
        {
        if ((newpbl.array->int_low + newpbl.array->ext_size + 1) < newpbl.array->int_size) {
            newpbl.array->store->data[newpbl.array->int_low + newpbl.array->ext_size] = possible_pb.num;
            newpbl.array->ext_size++;
            newpbl.array->ext_high++;
        }
        else {
            err = arrayOPaddh(newpbl, possible_pb);
            if (err != ERR_ok)
                goto ex_0;
        }
        }
        }
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(470);
    { /* return */
    {
    ret_1->num = newpbl.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE tbl_uniq ****/


/**** BEGIN PROCEDURE g_field_tables ****/


errcode
g_tblOPg_field_tables(CLUREF e, CLUREF pass)
{
    errcode err;
    CLUREF each_pb;
    CLUREF s;
    CLUREF test;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(476);

  LINE(479);
    { /* for array$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = g_tblOPcum_pbl.array->ext_high;
    T_1_3 = g_tblOPcum_pbl;
    for (T_1_1.num = g_tblOPcum_pbl.array->ext_low; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        if (T_1_1.num > T_1_3.array->ext_high || T_1_1.num < T_1_3.array->ext_low) {
            err = ERR_failure;
            elist[0] = array_bounds_exception_STRING;
            goto ex_0;
        }
        each_pb.num = T_1_3.array->store->data[T_1_1.num - T_1_3.array->ext_low + T_1_3.array->int_low];

  LINE(481);
        { /* if */
        CLUREF T_2_1;
        T_2_1.num = (pass.num == 1);
        if (T_2_1.num == true) { /* if */

  LINE(483);
            { /* qtagcase */
            switch (each_pb.cell->tag) {
            case 7: /* selinfo */ {
                CLUREF T_3_1;
                T_3_1.num = each_pb.cell->value;
                s.num = T_3_1.num;

  LINE(485);
                {
                CLUREF T_4_1;
                T_4_1.num = s.vec->data[0];
                err = g_tblOPg_sel_extern(e, T_4_1);
                if (err != ERR_ok)
                    goto ex_0;
                }
                break;
            }
            default: {

  LINE(487);
                {
                err = g_parm_extern(e, each_pb);
                if (err != ERR_ok)
                    goto ex_0;
                }
                break;
            }
            }
            } /* end qtagcase */
        }
        } /* end if */

  LINE(490);
        {
        CLUREF T_2_1;
        err = g_tblOPtest_pb(each_pb, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        test.num = T_2_1.num;
        }

  LINE(497);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = test.num;
        if (test.num) {
            T_2_2.num = (pass.num == 1);
            T_2_1.num = T_2_2.num;
        }
        if (T_2_1.num == true) { /* if */
            continue;
        }
        } /* end if */

  LINE(498);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        T_2_2.num = !test.num;
        T_2_1.num = T_2_2.num;
        if (T_2_2.num) {
            T_2_3.num = (pass.num == 2);
            T_2_1.num = T_2_3.num;
        }
        if (T_2_1.num == true) { /* if */
            continue;
        }
        } /* end if */

  LINE(499);
        { /* qtagcase */
        switch (each_pb.cell->tag) {
        case 7: /* selinfo */ {
            CLUREF T_2_1;
            T_2_1.num = each_pb.cell->value;
            s.num = T_2_1.num;

  LINE(501);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = s.vec->data[1];
            T_3_2.num = s.vec->data[0];
            err = g_tblOPg_sel_table(e, T_3_1, T_3_2, pass);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        default: {

  LINE(503);
            {
            err = g_parm_table(e, each_pb, pass);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        }
        } /* end qtagcase */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE g_field_tables ****/


/**** BEGIN PROCEDURE g_sel_table ****/

static int g_tblOPg_sel_table_own_init = 0;

errcode
g_tblOPg_sel_table(CLUREF e, CLUREF fn, CLUREF fl, CLUREF pass)
{
    errcode err;
    CLUREF sel_name;
    CLUREF nm;
    if (g_tblOPg_sel_table_own_init == 0) {
        if (g_tbl_own_init == 0) {
            err = g_tbl_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        g_tblOPg_sel_table_own_init = 1;
    }
    enter_proc(508);

  LINE(509);
    {
    CLUREF T_1_1;
    err = make_sel_name(fl, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    sel_name.num = T_1_1.num;
    }

  LINE(510);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    err = stringOPconcat(fn, STR__137, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    err = stringOPconcat(T_1_1, sel_name, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    err = stringOPconcat(T_1_2, STR__137ops, &T_1_3);
    if (err != ERR_ok)
        goto ex_0;
    nm.num = T_1_3.num;
    }

  LINE(511);
    {
    err = g_def_opsptr(e, nm, pass, STR_g_137sel_137table);
    if (err != ERR_ok)
        goto ex_0;
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE g_sel_table ****/


/**** BEGIN PROCEDURE g_sel_extern ****/

static int g_tblOPg_sel_extern_own_init = 0;

errcode
g_tblOPg_sel_extern(CLUREF e, CLUREF each_fl)
{
    errcode err;
    CLUREF each_field;
    CLUREF doit;
    CLUREF tname;
    if (g_tblOPg_sel_extern_own_init == 0) {
        if (g_tbl_own_init == 0) {
            err = g_tbl_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        g_tblOPg_sel_extern_own_init = 1;
    }
    enter_proc(516);

  LINE(517);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = each_fl.vec->size;
    T_1_3 = each_fl;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        each_field.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(518);
        {
        doit.tf = true;
        }

  LINE(519);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        T_2_1.num = each_field.vec->data[1];
        err = typespecOPget_abs(T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_2.cell->tag == 5) T_2_3.num = true; else T_2_3.num = false;
        if (T_2_3.num == true) { /* if */
            {
            doit.tf = false;
            }
        }
        } /* end if */

  LINE(520);
        { /* if */
        if (doit.num == true) { /* if */

  LINE(522);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            T_3_1.num = each_field.vec->data[1];
            err = s_name_typespec(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            err = stringOPconcat(T_3_2, STR__137ops, &T_3_3);
            if (err != ERR_ok)
                goto ex_0;
            tname.num = T_3_3.num;
            }

  LINE(523);
            { /* if */
            CLUREF T_3_1;
            err = g_envOPadd_extern(tname, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_1.num == true) { /* if */

  LINE(524);
                {
                CLUREF T_4_1;
                CLUREF T_4_2;
                err = stringOPconcat(STR_extern_040struct_040OPS_040_052, tname, &T_4_1);
                if (err != ERR_ok)
                    goto ex_0;
                err = stringOPconcat(T_4_1, STR__073, &T_4_2);
                if (err != ERR_ok)
                    goto ex_0;
                err = g_envOPputl(e, T_4_2);
                if (err != ERR_ok)
                    goto ex_0;
                }
            }
            } /* end if */
        }
        } /* end if */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE g_sel_extern ****/


/**** BEGIN PROCEDURE build_tables ****/


errcode
g_tblOPbuild_tables(CLUREF e, CLUREF pass)
{
    errcode err;
    CLUREF each_pb;
    CLUREF test;
    CLUREF s;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(530);

  LINE(533);
    { /* for array$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = g_tblOPcum_pbl.array->ext_high;
    T_1_3 = g_tblOPcum_pbl;
    for (T_1_1.num = g_tblOPcum_pbl.array->ext_low; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        if (T_1_1.num > T_1_3.array->ext_high || T_1_1.num < T_1_3.array->ext_low) {
            err = ERR_failure;
            elist[0] = array_bounds_exception_STRING;
            goto ex_0;
        }
        each_pb.num = T_1_3.array->store->data[T_1_1.num - T_1_3.array->ext_low + T_1_3.array->int_low];

  LINE(535);
        { /* if */
        CLUREF T_2_1;
        T_2_1.num = (pass.num == 0);
        if (T_2_1.num == true) { /* if */
            {
            err = g_parm_table_inst_info(e, each_pb);
            if (err != ERR_ok)
                goto ex_0;
            }
            continue;
        }
        } /* end if */

  LINE(537);
        {
        CLUREF T_2_1;
        err = g_tblOPtest_pb(each_pb, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        test.num = T_2_1.num;
        }

  LINE(542);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = test.num;
        if (test.num) {
            T_2_2.num = (pass.num == 1);
            T_2_1.num = T_2_2.num;
        }
        if (T_2_1.num == true) { /* if */
            continue;
        }
        } /* end if */

  LINE(543);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        T_2_2.num = !test.num;
        T_2_1.num = T_2_2.num;
        if (T_2_2.num) {
            T_2_3.num = (pass.num == 2);
            T_2_1.num = T_2_3.num;
        }
        if (T_2_1.num == true) { /* if */
            continue;
        }
        } /* end if */

  LINE(544);
        { /* qtagcase */
        switch (each_pb.cell->tag) {
        case 7: /* selinfo */ {
            CLUREF T_2_1;
            T_2_1.num = each_pb.cell->value;
            s.num = T_2_1.num;

  LINE(546);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = s.vec->data[1];
            T_3_2.num = s.vec->data[0];
            err = g_tblOPbuild_one_selector_table(e, T_3_1, T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        default: {

  LINE(549);
            {
            err = g_own_build_one(e, each_pb);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(550);
            {
            err = g_parm_build_one(e, each_pb);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        }
        } /* end qtagcase */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(553);
    { /* if */
    CLUREF T_1_1;
    T_1_1.num = (pass.num == 2);
    if (T_1_1.num == true) { /* if */
        {
        CLUREF T_2_1;
        err = arrayOPnew(&T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        g_tblOPcum_pbl.num = T_2_1.num;
        }
    }
    } /* end if */

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE build_tables ****/


/**** BEGIN PROCEDURE test_pb ****/

static int g_tblOPtest_pb_own_init = 0;

errcode
g_tblOPtest_pb(CLUREF p, CLUREF *ret_1)
{
    errcode err;
    CLUREF cop;
    CLUREF ct;
    CLUREF a;
    CLUREF s;
    CLUREF ex;
    CLUREF ty;
    if (g_tblOPtest_pb_own_init == 0) {
        if (g_tbl_own_init == 0) {
            err = g_tbl_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        g_tblOPtest_pb_own_init = 1;
    }
    enter_proc(558);

  LINE(559);
    { /* qtagcase */
    switch (p.cell->tag) {
    case 6: /* op */ {
        CLUREF T_1_1;
        T_1_1.num = p.cell->value;
        cop.num = T_1_1.num;

  LINE(562);
        { /* return */
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = cop.vec->data[1];
        err = g_tblOPtest_pb_exprs_asst(T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        ret_1->num = T_2_2.num;
        }
        signal (ERR_ok);
        }
        break;
    }
    case 4: /* apply */ {
        CLUREF T_1_2;
        T_1_2.num = p.cell->value;
        ct.num = T_1_2.num;

  LINE(565);
        { /* return */
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = ct.vec->data[1];
        err = g_tblOPtest_pb_exprs_asst(T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        ret_1->num = T_2_2.num;
        }
        signal (ERR_ok);
        }
        break;
    }
    case 1: /* a_cons */ {
        CLUREF T_1_3;
        T_1_3.num = p.cell->value;
        a.num = T_1_3.num;

  LINE(568);
        { /* if */
        CLUREF T_2_1;
        err = dbg_infoOPactive(&T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_1.num == true) { /* if */

  LINE(569);
            { /* qtagcase */
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = a.vec->data[2];
            err = typespecOPget_abs(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            switch (T_3_2.cell->tag) {
            case 3: /* cluster_ */ /* FALLTHROUGH */
            case 8: /* type_ */ {
                CLUREF T_3_3;
                T_3_3.num = T_3_2.cell->value;
                ct.num = T_3_3.num;

  LINE(571);
                { /* if */
                CLUREF T_4_1;
                CLUREF T_4_2;
                T_4_1.num = ct.vec->data[1];
                err = g_tblOPtest_pb_exprs_asst(T_4_1, &T_4_2);
                if (err != ERR_ok)
                    goto ex_0;
                if (T_4_2.num == true) { /* if */

  LINE(572);
                    { /* return */
                    {
                    ret_1->tf = true;
                    }
                    signal (ERR_ok);
                    }
                }
                } /* end if */
                break;
            }
            default: {

  LINE(574);
                {
                CLUREF T_4_1;
                T_4_1.num = 707;
                err = compiler_logit(T_4_1, STR_test_137pb_072_040others);
                if (err != ERR_ok)
                    goto ex_0;
                }
                break;
            }
            }
            } /* end qtagcase */
        }
        } /* end if */

  LINE(577);
        { /* return */
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = a.vec->data[0];
        err = g_tblOPtest_pb_exprs_asst(T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        ret_1->num = T_2_2.num;
        }
        signal (ERR_ok);
        }
        break;
    }
    case 7: /* selinfo */ {
        CLUREF T_1_4;
        T_1_4.num = p.cell->value;
        s.num = T_1_4.num;

  LINE(580);
        { /* return */
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = s.vec->data[0];
        err = g_tblOPtest_pb_fields_asst(T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        ret_1->num = T_2_2.num;
        }
        signal (ERR_ok);
        }
        break;
    }
    case 3: /* any_ */ {
        CLUREF T_1_5;
        T_1_5.num = p.cell->value;
        ex.num = T_1_5.num;

  LINE(582);
        { /* return */
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        err = sequenceOPfill(CLU_1, ex, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        err = g_tblOPtest_pb_exprs_asst(T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        ret_1->num = T_2_2.num;
        }
        signal (ERR_ok);
        }
        break;
    }
    case 5: /* force_ */ {
        CLUREF T_1_6;
        T_1_6.num = p.cell->value;
        ty.num = T_1_6.num;

  LINE(584);
        { /* qtagcase */
        CLUREF T_2_1;
        err = typespecOPget_abs(ty, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        switch (T_2_1.cell->tag) {
        case 5: /* idn */ {

  LINE(586);
            { /* return */
            {
            ret_1->tf = true;
            }
            signal (ERR_ok);
            }
            break;
        }
        case 8: /* type_ */ /* FALLTHROUGH */
        case 3: /* cluster_ */ {
            CLUREF T_2_2;
            T_2_2.num = T_2_1.cell->value;
            ct.num = T_2_2.num;

  LINE(588);
            { /* return */
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = ct.vec->data[1];
            err = g_tblOPtest_pb_exprs_asst(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            ret_1->num = T_3_2.num;
            }
            signal (ERR_ok);
            }
            break;
        }
        case 7: /* select */ {
            CLUREF T_2_3;
            T_2_3.num = T_2_1.cell->value;
            s.num = T_2_3.num;

  LINE(590);
            { /* return */
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = s.vec->data[1];
            err = g_tblOPtest_pb_fields_asst(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            ret_1->num = T_3_2.num;
            }
            signal (ERR_ok);
            }
            break;
        }
        default: {

  LINE(592);
            {
            CLUREF T_3_1;
            T_3_1.num = 708;
            err = compiler_logit(T_3_1, STR_test_137pb_072_040force_072_040others);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(593);
            {
            err = typespec_print(ty);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(594);
            { /* return */
            {
            ret_1->tf = false;
            }
            signal (ERR_ok);
            }
            break;
        }
        }
        } /* end qtagcase */
        break;
    }
    default: {

  LINE(597);
        {
        CLUREF T_2_1;
        T_2_1.num = 709;
        err = compiler_logit(T_2_1, STR_test_137pb_072_040others);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(598);
        {
        err = pb_print(p);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(599);
        { /* return */
        {
        ret_1->tf = false;
        }
        signal (ERR_ok);
        }
        break;
    }
    }
    } /* end qtagcase */

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE test_pb ****/


/**** BEGIN PROCEDURE test_pb_exprs_asst ****/

static int g_tblOPtest_pb_exprs_asst_own_init = 0;

errcode
g_tblOPtest_pb_exprs_asst(CLUREF el, CLUREF *ret_1)
{
    errcode err;
    CLUREF each_e;
    CLUREF ty;
    CLUREF i;
    CLUREF sc;
    CLUREF each_field;
    CLUREF new_el;
    CLUREF ex;
    CLUREF inv;
    if (g_tblOPtest_pb_exprs_asst_own_init == 0) {
        if (g_tbl_own_init == 0) {
            err = g_tbl_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        g_tblOPtest_pb_exprs_asst_own_init = 1;
    }
    enter_proc(607);

  LINE(611);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = el.vec->size;
    T_1_3 = el;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        each_e.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(614);
        { /* qtagcase */
        CLUREF T_2_1;
        err = exprOPget_abs(each_e, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        switch (T_2_1.cell->tag) {
        case 25: /* type_ */ {
            CLUREF T_2_2;
            T_2_2.num = T_2_1.cell->value;
            ty.num = T_2_2.num;

  LINE(616);
            { /* if */
            CLUREF T_3_1;
            err = g_tblOPtest_pb_exprs_type_asst(ty, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_1.num == true) { /* if */
                { /* return */
                {
                ret_1->tf = true;
                }
                signal (ERR_ok);
                }
            }
            } /* end if */
            break;
        }
        case 19: /* null_ */ {
            break;
        }
        case 15: /* int_ */ /* FALLTHROUGH */
        case 24: /* str */ /* FALLTHROUGH */
        case 5: /* bool_ */ /* FALLTHROUGH */
        case 7: /* char_ */ /* FALLTHROUGH */
        case 21: /* real_ */ {
            break;
        }
        case 13: /* idn */ {
            CLUREF T_2_3;
            T_2_3.num = T_2_1.cell->value;
            i.num = T_2_3.num;

  LINE(624);
            { /* qtagcase */
            CLUREF T_3_1;
            err = idnOPget_kind(i, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            switch (T_3_1.cell->tag) {
            case 6: /* tparm */ /* FALLTHROUGH */
            case 10: /* vparm */ {

  LINE(628);
                { /* return */
                {
                ret_1->tf = true;
                }
                signal (ERR_ok);
                }
                break;
            }
            }
            } /* end qtagcase */
            break;
        }
        case 23: /* s_cons */ {
            CLUREF T_2_4;
            T_2_4.num = T_2_1.cell->value;
            sc.num = T_2_4.num;

  LINE(632);
            { /* for sequence$elements */
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            T_3_1.num = sc.vec->data[0];
            T_3_3.num = T_3_1.vec->size;
            T_3_4 = T_3_1;
            for (T_3_2.num = 1; T_3_2.num <= T_3_3.num; T_3_2.num++) {
                each_field.num = T_3_4.vec->data[T_3_2.num - 1];

  LINE(633);
                {
                CLUREF T_4_1;
                CLUREF T_4_2;
                T_4_1.num = each_field.vec->data[2];
                err = sequenceOPfill(CLU_1, T_4_1, &T_4_2);
                if (err != ERR_ok)
                    goto ex_0;
                new_el.num = T_4_2.num;
                }

  LINE(634);
                { /* if */
                CLUREF T_4_1;
                err = g_tblOPtest_pb_exprs_asst(new_el, &T_4_1);
                if (err != ERR_ok)
                    goto ex_0;
                if (T_4_1.num == true) { /* if */

  LINE(636);
                    { /* return */
                    {
                    ret_1->tf = true;
                    }
                    signal (ERR_ok);
                    }
                }
                } /* end if */
            }
            }
            end_inline_for_2:
            __CLU_END_LABEL;
            break;
        }
        case 27: /* up_ */ /* FALLTHROUGH */
        case 9: /* down_ */ {
            CLUREF T_2_5;
            T_2_5.num = T_2_1.cell->value;
            ex.num = T_2_5.num;

  LINE(639);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            err = exprOPget_typespec(each_e, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            err = g_tblOPtest_pb_exprs_type_asst(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_2.num == true) { /* if */
                { /* return */
                {
                ret_1->tf = true;
                }
                signal (ERR_ok);
                }
            }
            } /* end if */
            break;
        }
        case 16: /* invoke */ {
            CLUREF T_2_6;
            T_2_6.num = T_2_1.cell->value;
            inv.num = T_2_6.num;

  LINE(642);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = inv.vec->data[1];
            err = g_tblOPtest_pb_exprs_asst(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_2.num == true) { /* if */
                { /* return */
                {
                ret_1->tf = true;
                }
                signal (ERR_ok);
                }
            }
            } /* end if */

  LINE(643);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = inv.vec->data[0];
            err = sequenceOPfill(CLU_1, T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            new_el.num = T_3_2.num;
            }

  LINE(644);
            { /* return */
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            err = exprOPget_typespec(each_e, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            err = g_tblOPtest_pb_exprs_type_asst(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            ret_1->num = T_3_2.num;
            }
            signal (ERR_ok);
            }
            break;
        }
        default: {

  LINE(646);
            {
            CLUREF T_3_1;
            T_3_1.num = 710;
            err = compiler_logit(T_3_1, STR_test_137pb_137expr_137asst_072_040exprabs_040not_040type_137_040or_040constant);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(647);
            {
            err = expr_print(each_e, CLU_40);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(649);
            { /* return */
            {
            ret_1->tf = false;
            }
            signal (ERR_ok);
            }
            break;
        }
        }
        } /* end qtagcase */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(653);
    { /* return */
    {
    ret_1->tf = false;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE test_pb_exprs_asst ****/


/**** BEGIN PROCEDURE test_pb_exprs_type_asst ****/


errcode
g_tblOPtest_pb_exprs_type_asst(CLUREF ty, CLUREF *ret_1)
{
    errcode err;
    CLUREF i;
    CLUREF ct;
    CLUREF s;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(657);

  LINE(658);
    { /* qtagcase */
    CLUREF T_1_1;
    err = typespecOPget_abs(ty, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    switch (T_1_1.cell->tag) {
    case 5: /* idn */ {
        CLUREF T_1_2;
        T_1_2.num = T_1_1.cell->value;
        i.num = T_1_2.num;

  LINE(661);
        { /* return */
        {
        ret_1->tf = true;
        }
        signal (ERR_ok);
        }
        break;
    }
    case 8: /* type_ */ /* FALLTHROUGH */
    case 3: /* cluster_ */ {
        CLUREF T_1_3;
        T_1_3.num = T_1_1.cell->value;
        ct.num = T_1_3.num;

  LINE(663);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = ct.vec->data[1];
        err = g_tblOPtest_pb_exprs_asst(T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_2.num == true) { /* if */

  LINE(665);
            { /* return */
            {
            ret_1->tf = true;
            }
            signal (ERR_ok);
            }
        }
        } /* end if */
        break;
    }
    case 7: /* select */ {
        CLUREF T_1_4;
        T_1_4.num = T_1_1.cell->value;
        s.num = T_1_4.num;

  LINE(667);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = s.vec->data[1];
        err = g_tblOPtest_pb_fields_asst(T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_2.num == true) { /* if */

  LINE(669);
            { /* return */
            {
            ret_1->tf = true;
            }
            signal (ERR_ok);
            }
        }
        } /* end if */
        break;
    }
    }
    } /* end qtagcase */

  LINE(672);
    { /* return */
    {
    ret_1->tf = false;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE test_pb_exprs_type_asst ****/


/**** BEGIN PROCEDURE base_cluster_test ****/

static int g_tblOPbase_cluster_test_own_init = 0;

errcode
g_tblOPbase_cluster_test(CLUREF cop, CLUREF ct, CLUREF *ret_1)
{
    errcode err;
    if (g_tblOPbase_cluster_test_own_init == 0) {
        if (g_tbl_own_init == 0) {
            err = g_tbl_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        g_tblOPbase_cluster_test_own_init = 1;
    }
    enter_proc(677);

  LINE(678);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    CLUREF T_1_5;
    CLUREF T_1_6;
    CLUREF T_1_7;
    CLUREF T_1_8;
    CLUREF T_1_9;
    CLUREF T_1_10;
    CLUREF T_1_11;
    CLUREF T_1_12;
    CLUREF T_1_13;
    CLUREF T_1_14;
    CLUREF T_1_15;
    CLUREF T_1_16;
    T_1_4.num = ct.vec->data[0];
    err = duOPget_common(T_1_4, &T_1_5);
    if (err != ERR_ok)
        goto ex_0;
    T_1_6.num = ((T_1_5.str->size != STR_array.str->size)? false :
        !(memcmp(T_1_5.str->data, STR_array.str->data, T_1_5.str->size)));
    T_1_3.num = T_1_6.num;
    if (!T_1_6.num) {
        T_1_7.num = ct.vec->data[0];
        err = duOPget_common(T_1_7, &T_1_8);
        if (err != ERR_ok)
            goto ex_0;
        T_1_9.num = ((T_1_8.str->size != STR_sequence.str->size)? false :
            !(memcmp(T_1_8.str->data, STR_sequence.str->data, T_1_8.str->size)));
        T_1_3.num = T_1_9.num;
    }
    T_1_2.num = T_1_3.num;
    if (!T_1_3.num) {
        T_1_10.num = ct.vec->data[0];
        err = duOPget_common(T_1_10, &T_1_11);
        if (err != ERR_ok)
            goto ex_0;
        T_1_12.num = ((T_1_11.str->size != STR__137vec.str->size)? false :
            !(memcmp(T_1_11.str->data, STR__137vec.str->data, T_1_11.str->size)));
        T_1_2.num = T_1_12.num;
    }
    T_1_1.num = T_1_2.num;
    if (T_1_2.num) {
        T_1_13.num = ct.vec->data[0];
        T_1_14.num = cop.vec->data[0];
        err = parmd_op(T_1_13, T_1_14, &T_1_15);
        if (err != ERR_ok)
            goto ex_0;
        T_1_16.num = !T_1_15.num;
        T_1_1.num = T_1_16.num;
    }
    if (T_1_1.num == true) { /* if */

  LINE(682);
        { /* return */
        {
        ret_1->tf = true;
        }
        signal (ERR_ok);
        }
    }
    } /* end if */

  LINE(683);
    { /* return */
    {
    ret_1->tf = false;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE base_cluster_test ****/


/**** BEGIN PROCEDURE base_apply_test ****/

static int g_tblOPbase_apply_test_own_init = 0;

errcode
g_tblOPbase_apply_test(CLUREF ct, CLUREF *ret_1)
{
    errcode err;
    if (g_tblOPbase_apply_test_own_init == 0) {
        if (g_tbl_own_init == 0) {
            err = g_tbl_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        g_tblOPbase_apply_test_own_init = 1;
    }
    enter_proc(686);

  LINE(687);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_1.num = ct.vec->data[0];
    err = duOPget_common(T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    T_1_3.num = ((T_1_2.str->size != STR__137cvt.str->size)? false :
        !(memcmp(T_1_2.str->data, STR__137cvt.str->data, T_1_2.str->size)));
    if (T_1_3.num == true) { /* if */

  LINE(688);
        { /* return */
        {
        ret_1->tf = true;
        }
        signal (ERR_ok);
        }
    }
    } /* end if */

  LINE(690);
    { /* return */
    {
    ret_1->tf = false;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE base_apply_test ****/


/**** BEGIN PROCEDURE test_pb_fields_asst ****/

static int g_tblOPtest_pb_fields_asst_own_init = 0;

errcode
g_tblOPtest_pb_fields_asst(CLUREF fl, CLUREF *ret_1)
{
    errcode err;
    CLUREF each_f;
    CLUREF ty;
    CLUREF i;
    CLUREF ct;
    CLUREF s;
    if (g_tblOPtest_pb_fields_asst_own_init == 0) {
        if (g_tbl_own_init == 0) {
            err = g_tbl_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        g_tblOPtest_pb_fields_asst_own_init = 1;
    }
    enter_proc(696);

  LINE(698);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = fl.vec->size;
    T_1_3 = fl;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        each_f.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(699);
        {
        CLUREF T_2_1;
        T_2_1.num = each_f.vec->data[1];
        ty.num = T_2_1.num;
        }

  LINE(700);
        { /* qtagcase */
        CLUREF T_2_1;
        err = typespecOPget_abs(ty, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        switch (T_2_1.cell->tag) {
        case 5: /* idn */ {
            CLUREF T_2_2;
            T_2_2.num = T_2_1.cell->value;
            i.num = T_2_2.num;

  LINE(703);
            { /* return */
            {
            ret_1->tf = true;
            }
            signal (ERR_ok);
            }
            break;
        }
        case 8: /* type_ */ /* FALLTHROUGH */
        case 3: /* cluster_ */ {
            CLUREF T_2_3;
            T_2_3.num = T_2_1.cell->value;
            ct.num = T_2_3.num;

  LINE(706);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = ct.vec->data[1];
            err = g_tblOPtest_pb_exprs_asst(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_2.num == true) { /* if */
                { /* return */
                {
                ret_1->tf = true;
                }
                signal (ERR_ok);
                }
            }
            } /* end if */
            break;
        }
        case 7: /* select */ {
            CLUREF T_2_4;
            T_2_4.num = T_2_1.cell->value;
            s.num = T_2_4.num;

  LINE(709);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = s.vec->data[1];
            err = g_tblOPtest_pb_fields_asst(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_2.num == true) { /* if */
                { /* return */
                {
                ret_1->tf = true;
                }
                signal (ERR_ok);
                }
            }
            } /* end if */
            break;
        }
        case 1: /* any_ */ {
            break;
        }
        case 2: /* apply */ {
            break;
        }
        default: {

  LINE(713);
            {
            CLUREF T_3_1;
            T_3_1.num = 711;
            err = compiler_logit(T_3_1, STR_test_137pb_137fields_137asst_072_040unexpected_040typespec);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(714);
            {
            CLUREF T_3_1;
            T_3_1.num = each_f.vec->data[1];
            err = typespec_print(T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        }
        } /* end qtagcase */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(717);
    { /* return */
    {
    ret_1->tf = false;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE test_pb_fields_asst ****/


/**** BEGIN PROCEDURE build_one_selector_table ****/

static int g_tblOPbuild_one_selector_table_own_init = 0;

errcode
g_tblOPbuild_one_selector_table(CLUREF e, CLUREF each_fn, CLUREF each_fl)
{
    errcode err;
    CLUREF ind;
    CLUREF each_field;
    CLUREF prefix;
    CLUREF sel_name;
    if (g_tblOPbuild_one_selector_table_own_init == 0) {
        if (g_tbl_own_init == 0) {
            err = g_tbl_own_init_proc();
            if (err != ERR_ok)
                goto ex_0;
        }
        g_tblOPbuild_one_selector_table_own_init = 1;
    }
    enter_proc(724);

  LINE(725);
    {
    ind.num = 0;
    }

  LINE(726);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = each_fl.vec->size;
    T_1_3 = each_fl;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        each_field.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(727);
        {
        err = g_envOPputs(e, STR_add_137selector_137info_050);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(730);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        T_2_1.num = each_field.vec->data[0];
        err = stringOPconcat(STR__042, T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        err = stringOPconcat(T_2_2, STR__042_054_040, &T_2_3);
        if (err != ERR_ok)
            goto ex_0;
        err = g_envOPputs(e, T_2_3);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(733);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        err = intOPunparse(ind, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        err = stringOPconcat(T_2_1, STR__054_040, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        err = g_envOPputs(e, T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(736);
        {
        err = g_envOPputs(e, STR__050struct_040OPS_040_052_051);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(737);
        {
        CLUREF T_2_1;
        T_2_1.num = each_field.vec->data[1];
        err = g_ref_name_typespec(e, T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(738);
        {
        err = g_envOPputl(e, STR__137ops_051_073);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(740);
        {
        CLUREF T_2_1;
        T_2_1.num = ind.num + 1;
        if ((T_2_1.num > 0 && ind.num < 0 && 1 < 0) ||
            (T_2_1.num < 0 && ind.num > 0 && 1 > 0)) {
            err = ERR_overflow;
            goto ex_0;
        }
        ind.num = T_2_1.num;
        }
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(742);
    {
    CLUREF T_1_1;
    err = s_owns_prefix_fieldlist(each_fl, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    prefix.num = T_1_1.num;
    }

  LINE(743);
    {
    CLUREF T_1_1;
    err = make_sel_name(each_fl, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    sel_name.num = T_1_1.num;
    }

  LINE(744);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    CLUREF T_1_5;
    CLUREF T_1_6;
    CLUREF T_1_7;
    CLUREF T_1_8;
    CLUREF T_1_9;
    CLUREF T_1_10;
    CLUREF T_1_11;
    err = stringOPconcat(STR_find_137selector_137ops_050_042, each_fn, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    err = stringOPconcat(T_1_1, STR__042_054_040, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    T_1_3.num = each_fl.vec->size;
    err = intOPunparse(T_1_3, &T_1_4);
    if (err != ERR_ok)
        goto ex_0;
    err = stringOPconcat(T_1_2, T_1_4, &T_1_5);
    if (err != ERR_ok)
        goto ex_0;
    err = stringOPconcat(T_1_5, STR__054_040_046_050, &T_1_6);
    if (err != ERR_ok)
        goto ex_0;
    err = stringOPconcat(T_1_6, prefix, &T_1_7);
    if (err != ERR_ok)
        goto ex_0;
    err = stringOPconcat(T_1_7, each_fn, &T_1_8);
    if (err != ERR_ok)
        goto ex_0;
    err = stringOPconcat(T_1_8, STR__137, &T_1_9);
    if (err != ERR_ok)
        goto ex_0;
    err = stringOPconcat(T_1_9, sel_name, &T_1_10);
    if (err != ERR_ok)
        goto ex_0;
    err = stringOPconcat(T_1_10, STR__137ops_051_051_073, &T_1_11);
    if (err != ERR_ok)
        goto ex_0;
    err = g_envOPputl(e, T_1_11);
    if (err != ERR_ok)
        goto ex_0;
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE build_one_selector_table ****/


/**** BEGIN PROCEDURE prune ****/


errcode
g_tblOPprune(void)
{
    errcode err;
    CLUREF new;
    CLUREF each_pb;
    CLUREF si;
    CLUREF ac;
    CLUREF cop;
    CLUREF xt;
    CLUREF ap;
    CLUREF ct;
    CLUREF ai;
    CLUREF ti;
    CLUREF ex;
    CLUREF ty;
    if (g_tbl_own_init == 0) {
        err = g_tbl_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(751);

  LINE(752);
    {
    CLUREF T_1_1;
    err = arrayOPnew(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    new.num = T_1_1.num;
    }

  LINE(753);
    { /* for array$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = g_tblOPcum_pbl.array->ext_high;
    T_1_3 = g_tblOPcum_pbl;
    for (T_1_1.num = g_tblOPcum_pbl.array->ext_low; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        if (T_1_1.num > T_1_3.array->ext_high || T_1_1.num < T_1_3.array->ext_low) {
            err = ERR_failure;
            elist[0] = array_bounds_exception_STRING;
            goto ex_0;
        }
        each_pb.num = T_1_3.array->store->data[T_1_1.num - T_1_3.array->ext_low + T_1_3.array->int_low];

  LINE(755);
        { /* qtagcase */
        switch (each_pb.cell->tag) {
        case 7: /* selinfo */ {
            CLUREF T_2_1;
            T_2_1.num = each_pb.cell->value;
            si.num = T_2_1.num;

  LINE(757);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = si.vec->data[0];
            err = fl_cont_op_parm(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_2.num == true) { /* if */
                continue;
            }
            else { /* else */

  LINE(758);
                {
                {
                if ((new.array->int_low + new.array->ext_size + 1) < new.array->int_size) {
                    new.array->store->data[new.array->int_low + new.array->ext_size] = each_pb.num;
                    new.array->ext_size++;
                    new.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(new, each_pb);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }
            }} /* end if */
            break;
        }
        case 1: /* a_cons */ {
            CLUREF T_2_2;
            T_2_2.num = each_pb.cell->value;
            ac.num = T_2_2.num;

  LINE(760);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            CLUREF T_3_5;
            T_3_2.num = ac.vec->data[2];
            err = type_cont_op_parm(T_3_2, &T_3_3);
            if (err != ERR_ok)
                goto ex_0;
            T_3_1.num = T_3_3.num;
            if (!T_3_3.num) {
                T_3_4.num = ac.vec->data[0];
                err = el_cont_op_parm(T_3_4, &T_3_5);
                if (err != ERR_ok)
                    goto ex_0;
                T_3_1.num = T_3_5.num;
            }
            if (T_3_1.num == true) { /* if */

  LINE(762);
                continue;
            }
            else { /* else */

  LINE(763);
                {
                {
                if ((new.array->int_low + new.array->ext_size + 1) < new.array->int_size) {
                    new.array->store->data[new.array->int_low + new.array->ext_size] = each_pb.num;
                    new.array->ext_size++;
                    new.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(new, each_pb);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }
            }} /* end if */
            break;
        }
        case 6: /* op */ {
            CLUREF T_2_3;
            T_2_3.num = each_pb.cell->value;
            cop.num = T_2_3.num;

  LINE(765);
            { /* qtagcase */
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = cop.vec->data[2];
            err = typespecOPget_abs(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            switch (T_3_2.cell->tag) {
            case 7: /* select */ {
                CLUREF T_3_3;
                T_3_3.num = T_3_2.cell->value;
                xt.num = T_3_3.num;

  LINE(767);
                { /* if */
                CLUREF T_4_1;
                CLUREF T_4_2;
                T_4_1.num = xt.vec->data[1];
                err = fl_cont_op_parm(T_4_1, &T_4_2);
                if (err != ERR_ok)
                    goto ex_0;
                if (T_4_2.num == true) { /* if */
                    continue;
                }
                else { /* else */

  LINE(768);
                    {
                    {
                    if ((new.array->int_low + new.array->ext_size + 1) < new.array->int_size) {
                        new.array->store->data[new.array->int_low + new.array->ext_size] = each_pb.num;
                        new.array->ext_size++;
                        new.array->ext_high++;
                    }
                    else {
                        err = arrayOPaddh(new, each_pb);
                        if (err != ERR_ok)
                            goto ex_0;
                    }
                    }
                    }
                }} /* end if */
                break;
            }
            case 2: /* apply */ {
                CLUREF T_3_4;
                T_3_4.num = T_3_2.cell->value;
                ap.num = T_3_4.num;

  LINE(770);
                { /* if */
                CLUREF T_4_1;
                CLUREF T_4_2;
                T_4_1.num = cop.vec->data[1];
                err = el_cont_op_parm(T_4_1, &T_4_2);
                if (err != ERR_ok)
                    goto ex_0;
                if (T_4_2.num == true) { /* if */
                    continue;
                }
                else { /* else */

  LINE(771);
                    {
                    {
                    if ((new.array->int_low + new.array->ext_size + 1) < new.array->int_size) {
                        new.array->store->data[new.array->int_low + new.array->ext_size] = each_pb.num;
                        new.array->ext_size++;
                        new.array->ext_high++;
                    }
                    else {
                        err = arrayOPaddh(new, each_pb);
                        if (err != ERR_ok)
                            goto ex_0;
                    }
                    }
                    }
                }} /* end if */
                break;
            }
            case 3: /* cluster_ */ /* FALLTHROUGH */
            case 8: /* type_ */ {
                CLUREF T_3_5;
                T_3_5.num = T_3_2.cell->value;
                ct.num = T_3_5.num;

  LINE(773);
                { /* if */
                CLUREF T_4_1;
                CLUREF T_4_2;
                CLUREF T_4_3;
                CLUREF T_4_4;
                CLUREF T_4_5;
                T_4_2.num = cop.vec->data[1];
                err = el_cont_op_parm(T_4_2, &T_4_3);
                if (err != ERR_ok)
                    goto ex_0;
                T_4_1.num = T_4_3.num;
                if (!T_4_3.num) {
                    T_4_4.num = ct.vec->data[1];
                    err = el_cont_op_parm(T_4_4, &T_4_5);
                    if (err != ERR_ok)
                        goto ex_0;
                    T_4_1.num = T_4_5.num;
                }
                if (T_4_1.num == true) { /* if */

  LINE(775);
                    continue;
                }
                else { /* else */

  LINE(776);
                    {
                    {
                    if ((new.array->int_low + new.array->ext_size + 1) < new.array->int_size) {
                        new.array->store->data[new.array->int_low + new.array->ext_size] = each_pb.num;
                        new.array->ext_size++;
                        new.array->ext_high++;
                    }
                    else {
                        err = arrayOPaddh(new, each_pb);
                        if (err != ERR_ok)
                            goto ex_0;
                    }
                    }
                    }
                }} /* end if */
                break;
            }
            case 5: /* idn */ {
                break;
            }
            }
            } /* end qtagcase */
            break;
        }
        case 4: /* apply */ {
            CLUREF T_2_4;
            T_2_4.num = each_pb.cell->value;
            ct.num = T_2_4.num;

  LINE(781);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = ct.vec->data[1];
            err = el_cont_op_parm(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_2.num == true) { /* if */

  LINE(782);
                continue;
            }
            else { /* else */

  LINE(783);
                {
                {
                if ((new.array->int_low + new.array->ext_size + 1) < new.array->int_size) {
                    new.array->store->data[new.array->int_low + new.array->ext_size] = each_pb.num;
                    new.array->ext_size++;
                    new.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(new, each_pb);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }
            }} /* end if */
            break;
        }
        case 2: /* ainfo */ {
            CLUREF T_2_5;
            T_2_5.num = each_pb.cell->value;
            ai.num = T_2_5.num;
            break;
        }
        case 8: /* tinfo */ {
            CLUREF T_2_6;
            T_2_6.num = each_pb.cell->value;
            ti.num = T_2_6.num;
            break;
        }
        case 3: /* any_ */ {
            CLUREF T_2_7;
            T_2_7.num = each_pb.cell->value;
            ex.num = T_2_7.num;

  LINE(789);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            err = sequenceOPfill(CLU_1, ex, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            err = el_cont_op_parm(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_2.num == true) { /* if */
                continue;
            }
            else { /* else */

  LINE(790);
                {
                {
                if ((new.array->int_low + new.array->ext_size + 1) < new.array->int_size) {
                    new.array->store->data[new.array->int_low + new.array->ext_size] = each_pb.num;
                    new.array->ext_size++;
                    new.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(new, each_pb);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }
            }} /* end if */
            break;
        }
        case 5: /* force_ */ {
            CLUREF T_2_8;
            T_2_8.num = each_pb.cell->value;
            ty.num = T_2_8.num;

  LINE(792);
            { /* if */
            CLUREF T_3_1;
            err = type_cont_op_parm(ty, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_1.num == true) { /* if */
                continue;
            }
            else { /* else */

  LINE(793);
                {
                {
                if ((new.array->int_low + new.array->ext_size + 1) < new.array->int_size) {
                    new.array->store->data[new.array->int_low + new.array->ext_size] = each_pb.num;
                    new.array->ext_size++;
                    new.array->ext_high++;
                }
                else {
                    err = arrayOPaddh(new, each_pb);
                    if (err != ERR_ok)
                        goto ex_0;
                }
                }
                }
            }} /* end if */
            break;
        }
        }
        } /* end qtagcase */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(796);
    {
    g_tblOPcum_pbl.num = new.num;
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE prune ****/

typedef struct{
    long count;
    OWNPTR type_owns;
    OWNPTR op_owns;
    struct OP_ENTRY entry[5];
} g_tbl_OPS;

static CLU_proc g_tbl_oe_build_tables = { .proc = g_tblOPbuild_tables };
static CLU_proc g_tbl_oe_exist = { .proc = g_tblOPexist };
static CLU_proc g_tbl_oe_find_tables = { .proc = g_tblOPfind_tables };
static CLU_proc g_tbl_oe_g_field_tables = { .proc = g_tblOPg_field_tables };
static CLU_proc g_tbl_oe_prune = { .proc = g_tblOPprune };

static g_tbl_OPS g_tbl_ops_actual = {5, (OWNPTR)&g_tbl_own_init, (OWNPTR)&g_tbl_own_init, {
    {&g_tbl_oe_build_tables, "build_tables"},
    {&g_tbl_oe_exist, "exist"},
    {&g_tbl_oe_find_tables, "find_tables"},
    {&g_tbl_oe_g_field_tables, "g_field_tables"},
    {&g_tbl_oe_prune, "prune"}}};

struct OPS *g_tbl_ops = (struct OPS *)&g_tbl_ops_actual;

/**** END CLUSTER g_tbl ****/


/**** BEGIN PROCEDURE make_sel_name ****/

extern errcode arrayOPpredict();
extern errcode sequenceOPindexes();
extern errcode sequenceOPfetch();
struct OPS *record_sel_type__ops __CLU_COMMON;
struct OPS *sequence_of_record_sel_type__ops __CLU_COMMON;
static int make_sel_name_own_init = 0;
CLUREF make_sel_nameOPtable;

errcode
make_sel_name(CLUREF fl, CLUREF *ret_1)
{
    errcode err;
    CLUREF nth;
    CLUREF already_here;
    CLUREF ithfl;
    CLUREF i;
    CLUREF nm;
    CLUREF first;
    CLUREF each_field;
    if (make_sel_name_own_init == 0) {
        add_selector_info("sel", 0, (struct OPS *)string_ops);
        add_selector_info("type_", 1, (struct OPS *)typespec_ops);
        find_selector_ops("record", 2, &(record_sel_type__ops));
        add_parm_info_type(0, (const struct OPS *)record_sel_type__ops, sequence_of_t_reqs);
        find_type_instance(sequence_ops, 1, &sequence_ownreqs, &(sequence_of_record_sel_type__ops));
        stringOPcons("_", CLU_1, CLUREF_make_num(1), &STR__137);
        make_sel_name_own_init = 1;
        {
        CLUREF T_0_1;
        CLUREF T_0_2;
        T_0_1.num = 100;
        err = arrayOPpredict(CLU_1, T_0_1, &T_0_2);
        if (err != ERR_ok)
            goto ex_0;
        make_sel_nameOPtable.num = T_0_2.num;
        }
    }
    enter_proc(801);

  LINE(806);
    {
    nth.num = 0;
    }

  LINE(807);
    {
    already_here.tf = false;
    }

  LINE(808);
    { /* for array$elements */
    CLUREF T_2_1;
    CLUREF T_2_2;
    CLUREF T_2_3;
    T_2_2.num = make_sel_nameOPtable.array->ext_high;
    T_2_3 = make_sel_nameOPtable;
    for (T_2_1.num = make_sel_nameOPtable.array->ext_low; T_2_1.num <= T_2_2.num; T_2_1.num++) {
        if (T_2_1.num > T_2_3.array->ext_high || T_2_1.num < T_2_3.array->ext_low) {
            err = ERR_failure;
            elist[0] = array_bounds_exception_STRING;
            goto ex_1;
        }
        ithfl.num = T_2_3.array->store->data[T_2_1.num - T_2_3.array->ext_low + T_2_3.array->int_low];

  LINE(809);
        { /* if */
        CLUREF T_3_1;
        CLUREF T_3_2;
        CLUREF T_3_3;
        CLUREF T_3_4;
        T_3_1.num = fl.vec->size;
        T_3_2.num = ithfl.vec->size;
        T_3_3.num = (T_3_1.num == T_3_2.num);
        T_3_4.num = !T_3_3.num;
        if (T_3_4.num == true) { /* if */

  LINE(810);
            continue;
        }
        } /* end if */

  LINE(811);
        { /* if */
        CLUREF T_3_1;
        generic_CLU_proc.type_owns = sequence_of_record_sel_type__ops->type_owns;
        generic_CLU_proc.proc = sequenceOPsimilar;
        CUR_PROC_VAR.proc = &generic_CLU_proc;
        err = sequenceOPsimilar(ithfl, fl, &T_3_1);
        if (err != ERR_ok)
            goto ex_1;
        if (T_3_1.num == true) { /* if */
            { /* exit */
                err = ERR_found;
                goto ex_1;
            }
        }
        } /* end if */

  LINE(812);
        { /* for sequence$indexes */
        CLUREF T_4_1;
        CLUREF T_4_2;
        T_4_2.num = fl.vec->size;
        for (T_4_1.num = 1; T_4_1.num <= T_4_2.num; T_4_1.num++) {
            i.num = T_4_1.num;

  LINE(813);
            { /* if */
            CLUREF T_5_1;
            CLUREF T_5_2;
            CLUREF T_5_3;
            CLUREF T_5_4;
            CLUREF T_5_5;
            CLUREF T_5_6;
            if (i.num < 1 || i.num > fl.vec->size) {
                err = ERR_bounds;
                goto ex_2;
            }
            T_5_1.num = fl.vec->data[i.num - 1];
            T_5_2.num = T_5_1.vec->data[0];
            if (i.num < 1 || i.num > ithfl.vec->size) {
                err = ERR_bounds;
                goto ex_2;
            }
            T_5_3.num = ithfl.vec->data[i.num - 1];
            T_5_4.num = T_5_3.vec->data[0];
            T_5_5.num = ((T_5_2.str->size != T_5_4.str->size)? false :
                !(memcmp(T_5_2.str->data, T_5_4.str->data, T_5_2.str->size)));
            T_5_6.num = !T_5_5.num;
            if (T_5_6.num == true) { /* if */

  LINE(814);
                { /* exit */
                    err = ERR_cont;
                    goto ex_2;
                }
            }
            } /* end if */
        }
        }
        end_inline_for_2:
        __CLU_END_LABEL;
        goto end_2;
      ex_2: /* except */
        __CLU_EX_HANDLER;
        if (err == ERR_cont) {

  LINE(816);
            continue;
        }
        else { /* not handled */
            goto ex_1;
        }
      end_2:;

  LINE(817);
        {
        CLUREF T_3_1;
        T_3_1.num = nth.num + 1;
        if ((T_3_1.num > 0 && nth.num < 0 && 1 < 0) ||
            (T_3_1.num < 0 && nth.num > 0 && 1 > 0)) {
            err = ERR_overflow;
            goto ex_1;
        }
        nth.num = T_3_1.num;
        }
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;
    goto end_1;
  ex_1: /* except */
    __CLU_EX_HANDLER;
    if (err == ERR_found) {

  LINE(820);
        {
        already_here.tf = true;
        }
    }
    else { /* not handled */
        goto ex_0;
    }
  end_1:;

  LINE(822);
    { /* if */
    CLUREF T_1_1;
    T_1_1.num = !already_here.num;
    if (T_1_1.num == true) { /* if */
        {
        {
        if ((make_sel_nameOPtable.array->int_low + make_sel_nameOPtable.array->ext_size + 1) < make_sel_nameOPtable.array->int_size) {
            make_sel_nameOPtable.array->store->data[make_sel_nameOPtable.array->int_low + make_sel_nameOPtable.array->ext_size] = fl.num;
            make_sel_nameOPtable.array->ext_size++;
            make_sel_nameOPtable.array->ext_high++;
        }
        else {
            err = arrayOPaddh(make_sel_nameOPtable, fl);
            if (err != ERR_ok)
                goto ex_0;
        }
        }
        }
    }
    } /* end if */

  LINE(824);
    {
    nm = CLU_empty_string;
    }

  LINE(825);
    {
    first.tf = true;
    }

  LINE(826);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = fl.vec->size;
    T_1_3 = fl;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        each_field.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(827);
        { /* if */
        if (first.num == true) { /* if */
            {
            first.tf = false;
            }
        }
        else { /* else */

  LINE(828);
            {
            CLUREF T_3_1;
            err = stringOPconcat(nm, STR__137, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            nm.num = T_3_1.num;
            }
        }} /* end if */

  LINE(829);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = each_field.vec->data[0];
        err = stringOPconcat(nm, T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        nm.num = T_2_2.num;
        }
    }
    }
    end_inline_for_3:
    __CLU_END_LABEL;

  LINE(831);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = (nth.num == 0);
    T_1_2.num = !T_1_1.num;
    if (T_1_2.num == true) { /* if */
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        err = stringOPconcat(nm, STR__137, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        err = intOPunparse(nth, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        err = stringOPconcat(T_2_1, T_2_2, &T_2_3);
        if (err != ERR_ok)
            goto ex_0;
        nm.num = T_2_3.num;
        }
    }
    } /* end if */

  LINE(832);
    { /* return */
    {
    ret_1->num = nm.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE make_sel_name ****/



/**** BEGIN PROCEDURE g_own_build_one ****/

extern errcode pb_gen();
extern errcode oneofOPis_6();
extern errcode is_op_parmd();
extern errcode c_fixup_opname();
extern errcode oneofOPvalue_6();
extern errcode s_expr4();
extern errcode intOPsub();
extern errcode s_expr5();
extern errcode cluster_parm_count();
extern errcode g_idnlit();
extern errcode g_expr_arg();
extern errcode g_expr5();
extern errcode g_typespec();
extern errcode g_envOPnewline();
extern errcode s_owns_prefix_type();
extern errcode g_name_typespec();
static CLUREF STR__137op_137;
static CLUREF STR__137of;
static CLUREF STR_add_137parm_137info_137type_050;
static CLUREF STR__050const_040struct_040OPS_040_052_051;
static CLUREF STR__137ops_054_040;
static CLUREF STR__137of_137;
static CLUREF STR__137reqs_051_073;
static CLUREF STR_add_137parm_137info_137const_050;
static CLUREF STR__051_073;
static CLUREF STR_add_137parm_137info_072_040probably_040wrong;
static CLUREF STR_add_137parm_137info_137type_0500_054_040;
static CLUREF STR__137of_137t_137reqs_051_073;
static CLUREF STR_g_137parm_137blocks_040array_040type_040unhandled;
static CLUREF STR__137anyize_137of_137t_137reqs_051_073;
static CLUREF STR_g_137parm_137blocks_072_040t_057ainfo_0404;
static int g_own_build_one_own_init = 0;

errcode
g_own_build_one(CLUREF e, CLUREF each_pb)
{
    errcode err;
    CLUREF index;
    CLUREF formals;
    CLUREF actuals;
    CLUREF gen;
    CLUREF each_parm;
    CLUREF op_name;
    CLUREF tail;
    CLUREF inst_table_name;
    CLUREF each_e;
    CLUREF a;
    CLUREF ct;
    CLUREF ex;
    CLUREF ty;
    if (g_own_build_one_own_init == 0) {
        stringOPcons("_op_", CLU_1, CLUREF_make_num(4), &STR__137op_137);
        stringOPcons("_of", CLU_1, CLUREF_make_num(3), &STR__137of);
        stringOPcons("_", CLU_1, CLUREF_make_num(1), &STR__137);
        stringOPcons("add_parm_info_type(", CLU_1, CLUREF_make_num(19), &STR_add_137parm_137info_137type_050);
        stringOPcons(", ", CLU_1, CLUREF_make_num(2), &STR__054_040);
        stringOPcons("(const struct OPS *)", CLU_1, CLUREF_make_num(20), &STR__050const_040struct_040OPS_040_052_051);
        stringOPcons("_ops, ", CLU_1, CLUREF_make_num(6), &STR__137ops_054_040);
        stringOPcons("_of_", CLU_1, CLUREF_make_num(4), &STR__137of_137);
        stringOPcons("_reqs);", CLU_1, CLUREF_make_num(7), &STR__137reqs_051_073);
        stringOPcons("add_parm_info_const(", CLU_1, CLUREF_make_num(20), &STR_add_137parm_137info_137const_050);
        stringOPcons(");", CLU_1, CLUREF_make_num(2), &STR__051_073);
        stringOPcons("add_parm_info: probably wrong", CLU_1, CLUREF_make_num(29), &STR_add_137parm_137info_072_040probably_040wrong);
        stringOPcons("add_parm_info_type(0, ", CLU_1, CLUREF_make_num(22), &STR_add_137parm_137info_137type_0500_054_040);
        stringOPcons("_of_t_reqs);", CLU_1, CLUREF_make_num(12), &STR__137of_137t_137reqs_051_073);
        stringOPcons("g_parm_blocks array type unhandled", CLU_1, CLUREF_make_num(34), &STR_g_137parm_137blocks_040array_040type_040unhandled);
        stringOPcons("_anyize_of_t_reqs);", CLU_1, CLUREF_make_num(19), &STR__137anyize_137of_137t_137reqs_051_073);
        stringOPcons("g_parm_blocks: t/ainfo 4", CLU_1, CLUREF_make_num(24), &STR_g_137parm_137blocks_072_040t_057ainfo_0404);
        g_own_build_one_own_init = 1;
    }
    enter_proc(839);

  LINE(842);
    { /* qtagcase */
    switch (each_pb.cell->tag) {
    case 4: /* apply */ /* FALLTHROUGH */
    case 6: /* op */ {

  LINE(844);
        {
        CLUREF T_2_1;
        err = pb_formals(each_pb, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        formals.num = T_2_1.num;
        }

  LINE(845);
        {
        CLUREF T_2_1;
        err = pb_actuals(each_pb, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        actuals.num = T_2_1.num;
        }

  LINE(846);
        {
        CLUREF T_2_1;
        err = pb_gen(each_pb, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        gen.num = T_2_1.num;
        }

  LINE(847);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        T_2_1.num = formals.vec->size;
        T_2_2.num = actuals.vec->size;
        T_2_3.num = (T_2_1.num == T_2_2.num);
        if (T_2_3.num == true) { /* if */

  LINE(848);
            {
            index.num = 1;
            }

  LINE(849);
            { /* for sequence$elements */
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            T_3_2.num = formals.vec->size;
            T_3_3 = formals;
            for (T_3_1.num = 1; T_3_1.num <= T_3_2.num; T_3_1.num++) {
                each_parm.num = T_3_3.vec->data[T_3_1.num - 1];

  LINE(850);
                {
                op_name = CLU_empty_string;
                }

  LINE(851);
                { /* if */
                CLUREF T_4_1;
                if (each_pb.cell->tag == 6) T_4_1.num = true; else T_4_1.num = false;
                if (T_4_1.num == true) { /* if */

  LINE(852);
                    { /* if */
                    CLUREF T_5_1;
                    err = is_op_parmd(each_pb, &T_5_1);
                    if (err != ERR_ok)
                        goto ex_0;
                    if (T_5_1.num == true) { /* if */

  LINE(853);
                        {
                        CLUREF T_6_1;
                        CLUREF T_6_2;
                        CLUREF T_6_3;
                        if (each_pb.cell->tag != 6) {
                            err = ERR_wrong_tag;
                            goto ex_0;
                        }
                        T_6_1.num = each_pb.cell->value;
                        T_6_2.num = T_6_1.vec->data[0];
                        err = c_fixup_opname(T_6_2, &T_6_3);
                        if (err != ERR_ok)
                            goto ex_0;
                        tail.num = T_6_3.num;
                        }

  LINE(854);
                        {
                        CLUREF T_6_1;
                        err = stringOPconcat(STR__137op_137, tail, &T_6_1);
                        if (err != ERR_ok)
                            goto ex_0;
                        op_name.num = T_6_1.num;
                        }
                    }
                    } /* end if */
                }
                } /* end if */

  LINE(856);
                {
                CLUREF T_4_1;
                CLUREF T_4_2;
                CLUREF T_4_3;
                err = duOPget_common(gen, &T_4_1);
                if (err != ERR_ok)
                    goto ex_0;
                err = stringOPconcat(T_4_1, op_name, &T_4_2);
                if (err != ERR_ok)
                    goto ex_0;
                err = stringOPconcat(T_4_2, STR__137of, &T_4_3);
                if (err != ERR_ok)
                    goto ex_0;
                inst_table_name.num = T_4_3.num;
                }

  LINE(857);
                { /* for sequence$elements */
                CLUREF T_4_1;
                CLUREF T_4_2;
                CLUREF T_4_3;
                T_4_2.num = actuals.vec->size;
                T_4_3 = actuals;
                for (T_4_1.num = 1; T_4_1.num <= T_4_2.num; T_4_1.num++) {
                    each_e.num = T_4_3.vec->data[T_4_1.num - 1];

  LINE(858);
                    {
                    CLUREF T_5_1;
                    CLUREF T_5_2;
                    CLUREF T_5_3;
                    err = stringOPconcat(inst_table_name, STR__137, &T_5_1);
                    if (err != ERR_ok)
                        goto ex_0;
                    err = s_expr4(each_e, &T_5_2);
                    if (err != ERR_ok)
                        goto ex_0;
                    err = stringOPconcat(T_5_1, T_5_2, &T_5_3);
                    if (err != ERR_ok)
                        goto ex_0;
                    inst_table_name.num = T_5_3.num;
                    }
                }
                }
                end_inline_for_2:
                __CLU_END_LABEL;

  LINE(862);
                { /* qtagcase */
                CLUREF T_4_1;
                CLUREF T_4_2;
                if (index.num < 1 || index.num > actuals.vec->size) {
                    err = ERR_bounds;
                    goto ex_0;
                }
                T_4_1.num = actuals.vec->data[index.num - 1];
                err = exprOPget_abs(T_4_1, &T_4_2);
                if (err != ERR_ok)
                    goto ex_0;
                switch (T_4_2.cell->tag) {
                case 25: /* type_ */ {

  LINE(865);
                    {
                    CLUREF T_5_1;
                    CLUREF T_5_2;
                    CLUREF T_5_3;
                    CLUREF T_5_4;
                    T_5_1.num = index.num - 1;
                    if ((T_5_1.num >= 0 && index.num < 0 && (-1) < 0) ||
                        (T_5_1.num <= 0 && index.num > 0 && (-1) > 0)) {
                        err = ERR_overflow;
                        goto ex_0;
                    }
                    err = intOPunparse(T_5_1, &T_5_2);
                    if (err != ERR_ok)
                        goto ex_0;
                    err = stringOPconcat(STR_add_137parm_137info_137type_050, T_5_2, &T_5_3);
                    if (err != ERR_ok)
                        goto ex_0;
                    err = stringOPconcat(T_5_3, STR__054_040, &T_5_4);
                    if (err != ERR_ok)
                        goto ex_0;
                    err = g_envOPputs(e, T_5_4);
                    if (err != ERR_ok)
                        goto ex_0;
                    }

  LINE(866);
                    {
                    err = g_envOPputs(e, STR__050const_040struct_040OPS_040_052_051);
                    if (err != ERR_ok)
                        goto ex_0;
                    }

  LINE(867);
                    {
                    CLUREF T_5_1;
                    CLUREF T_5_2;
                    CLUREF T_5_3;
                    if (index.num < 1 || index.num > actuals.vec->size) {
                        err = ERR_bounds;
                        goto ex_0;
                    }
                    T_5_1.num = actuals.vec->data[index.num - 1];
                    err = s_expr5(T_5_1, &T_5_2);
                    if (err != ERR_ok)
                        goto ex_0;
                    err = stringOPconcat(T_5_2, STR__137ops_054_040, &T_5_3);
                    if (err != ERR_ok)
                        goto ex_0;
                    err = g_envOPputs(e, T_5_3);
                    if (err != ERR_ok)
                        goto ex_0;
                    }

  LINE(868);
                    {
                    CLUREF T_5_1;
                    err = duOPget_common(gen, &T_5_1);
                    if (err != ERR_ok)
                        goto ex_0;
                    err = g_envOPputs(e, T_5_1);
                    if (err != ERR_ok)
                        goto ex_0;
                    }

  LINE(869);
                    { /* if */
                    CLUREF T_5_1;
                    CLUREF T_5_2;
                    err = cluster_parm_count(gen, &T_5_1);
                    if (err != ERR_ok)
                        goto ex_0;
                    T_5_2.num = (index.num > T_5_1.num);
                    if (T_5_2.num == true) { /* if */

  LINE(870);
                        {
                        err = g_envOPputs(e, op_name);
                        if (err != ERR_ok)
                            goto ex_0;
                        }
                    }
                    } /* end if */

  LINE(872);
                    {
                    err = g_envOPputs(e, STR__137of_137);
                    if (err != ERR_ok)
                        goto ex_0;
                    }

  LINE(873);
                    {
                    CLUREF T_5_1;
                    if (index.num < 1 || index.num > formals.vec->size) {
                        err = ERR_bounds;
                        goto ex_0;
                    }
                    T_5_1.num = formals.vec->data[index.num - 1];
                    err = g_idnlit(e, T_5_1);
                    if (err != ERR_ok)
                        goto ex_0;
                    }

  LINE(874);
                    {
                    err = g_envOPputl(e, STR__137reqs_051_073);
                    if (err != ERR_ok)
                        goto ex_0;
                    }
                    break;
                }
                case 19: /* null_ */ /* FALLTHROUGH */
                case 15: /* int_ */ /* FALLTHROUGH */
                case 21: /* real_ */ /* FALLTHROUGH */
                case 7: /* char_ */ /* FALLTHROUGH */
                case 5: /* bool_ */ /* FALLTHROUGH */
                case 24: /* str */ /* FALLTHROUGH */
                case 13: /* idn */ {

  LINE(876);
                    {
                    CLUREF T_5_1;
                    CLUREF T_5_2;
                    CLUREF T_5_3;
                    CLUREF T_5_4;
                    T_5_1.num = index.num - 1;
                    if ((T_5_1.num >= 0 && index.num < 0 && (-1) < 0) ||
                        (T_5_1.num <= 0 && index.num > 0 && (-1) > 0)) {
                        err = ERR_overflow;
                        goto ex_0;
                    }
                    err = intOPunparse(T_5_1, &T_5_2);
                    if (err != ERR_ok)
                        goto ex_0;
                    err = stringOPconcat(STR_add_137parm_137info_137const_050, T_5_2, &T_5_3);
                    if (err != ERR_ok)
                        goto ex_0;
                    err = stringOPconcat(T_5_3, STR__054_040, &T_5_4);
                    if (err != ERR_ok)
                        goto ex_0;
                    err = g_envOPputs(e, T_5_4);
                    if (err != ERR_ok)
                        goto ex_0;
                    }

  LINE(877);
                    {
                    CLUREF T_5_1;
                    if (index.num < 1 || index.num > actuals.vec->size) {
                        err = ERR_bounds;
                        goto ex_0;
                    }
                    T_5_1.num = actuals.vec->data[index.num - 1];
                    err = g_expr_arg(e, T_5_1);
                    if (err != ERR_ok)
                        goto ex_0;
                    }

  LINE(878);
                    {
                    err = g_envOPputl(e, STR__051_073);
                    if (err != ERR_ok)
                        goto ex_0;
                    }
                    break;
                }
                default: {

  LINE(880);
                    {
                    CLUREF T_5_1;
                    T_5_1.num = 712;
                    err = compiler_logit(T_5_1, STR_add_137parm_137info_072_040probably_040wrong);
                    if (err != ERR_ok)
                        goto ex_0;
                    }
                    break;
                }
                }
                } /* end qtagcase */

  LINE(882);
                {
                CLUREF T_4_1;
                T_4_1.num = index.num + 1;
                if ((T_4_1.num > 0 && index.num < 0 && 1 < 0) ||
                    (T_4_1.num < 0 && index.num > 0 && 1 > 0)) {
                    err = ERR_overflow;
                    goto ex_0;
                }
                index.num = T_4_1.num;
                }
            }
            }
            end_inline_for_1:
            __CLU_END_LABEL;
        }
        } /* end if */
        break;
    }
    case 1: /* a_cons */ {
        CLUREF T_1_1;
        T_1_1.num = each_pb.cell->value;
        a.num = T_1_1.num;

  LINE(886);
        { /* if */
        CLUREF T_2_1;
        err = dbg_infoOPactive(&T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_1.num == true) { /* if */

  LINE(887);
            { /* qtagcase */
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = a.vec->data[2];
            err = typespecOPget_abs(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            switch (T_3_2.cell->tag) {
            case 3: /* cluster_ */ {
                CLUREF T_3_3;
                T_3_3.num = T_3_2.cell->value;
                ct.num = T_3_3.num;

  LINE(891);
                {
                err = g_envOPputs(e, STR_add_137parm_137info_137type_0500_054_040);
                if (err != ERR_ok)
                    goto ex_0;
                }

  LINE(894);
                {
                CLUREF T_4_1;
                CLUREF T_4_2;
                T_4_1.num = ct.vec->data[1];
                if (1 < 1 || 1 > T_4_1.vec->size) {
                    err = ERR_bounds;
                    goto ex_0;
                }
                T_4_2.num = T_4_1.vec->data[1 - 1];
                err = g_expr5(e, T_4_2);
                if (err != ERR_ok)
                    goto ex_0;
                }

  LINE(895);
                {
                err = g_envOPputs(e, STR__137ops_054_040);
                if (err != ERR_ok)
                    goto ex_0;
                }

  LINE(898);
                {
                CLUREF T_4_1;
                T_4_1.num = a.vec->data[2];
                err = g_typespec(e, T_4_1);
                if (err != ERR_ok)
                    goto ex_0;
                }

  LINE(899);
                {
                err = g_envOPputl(e, STR__137of_137t_137reqs_051_073);
                if (err != ERR_ok)
                    goto ex_0;
                }

  LINE(901);
                {
                err = g_envOPnewline(e);
                if (err != ERR_ok)
                    goto ex_0;
                }
                break;
            }
            default: {

  LINE(903);
                {
                CLUREF T_4_1;
                T_4_1.num = 713;
                err = compiler_logit(T_4_1, STR_g_137parm_137blocks_040array_040type_040unhandled);
                if (err != ERR_ok)
                    goto ex_0;
                }

  LINE(904);
                {
                CLUREF T_4_1;
                T_4_1.num = a.vec->data[2];
                err = typespec_print(T_4_1);
                if (err != ERR_ok)
                    goto ex_0;
                }
                break;
            }
            }
            } /* end qtagcase */
        }
        } /* end if */
        break;
    }
    case 3: /* any_ */ {
        CLUREF T_1_2;
        T_1_2.num = each_pb.cell->value;
        ex.num = T_1_2.num;

  LINE(910);
        {
        err = g_envOPputs(e, STR_add_137parm_137info_137type_0500_054_040);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(913);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        err = exprOPget_typespec(ex, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        err = s_owns_prefix_type(T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        err = g_envOPputs(e, T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(914);
        {
        CLUREF T_2_1;
        err = exprOPget_typespec(ex, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        err = g_name_typespec(e, T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(915);
        {
        err = g_envOPputs(e, STR__137ops_054_040);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(918);
        {
        err = g_envOPputl(e, STR__137anyize_137of_137t_137reqs_051_073);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(919);
        {
        err = g_envOPnewline(e);
        if (err != ERR_ok)
            goto ex_0;
        }
        break;
    }
    case 5: /* force_ */ {
        CLUREF T_1_3;
        T_1_3.num = each_pb.cell->value;
        ty.num = T_1_3.num;

  LINE(923);
        {
        err = g_envOPputs(e, STR_add_137parm_137info_137type_0500_054_040);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(926);
        {
        CLUREF T_2_1;
        err = s_owns_prefix_type(ty, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        err = g_envOPputs(e, T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(927);
        {
        err = g_name_typespec(e, ty);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(928);
        {
        err = g_envOPputs(e, STR__137ops_054_040);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(931);
        {
        err = g_envOPputl(e, STR__137anyize_137of_137t_137reqs_051_073);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(932);
        {
        err = g_envOPnewline(e);
        if (err != ERR_ok)
            goto ex_0;
        }
        break;
    }
    default: {

  LINE(935);
        {
        CLUREF T_2_1;
        T_2_1.num = 714;
        err = compiler_logit(T_2_1, STR_g_137parm_137blocks_072_040t_057ainfo_0404);
        if (err != ERR_ok)
            goto ex_0;
        }
        break;
    }
    }
    } /* end qtagcase */

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE g_own_build_one ****/


/**** BEGIN CLUSTER own_defn ****/

static int own_defn_own_init = 0;
const OWN_req own_defn_ownreqs = { 0, 0 };
CLUREF own_defnOPold;
CLUREF own_defnOPactive;

errcode
own_defn_own_init_proc(void)
{
    errcode err;
    enter_own_init_proc();
    if (own_defn_own_init == 0) {
        own_defn_own_init = 1;
        {
        CLUREF T_0_1;
        err = arrayOPnew(&T_0_1);
        if (err != ERR_ok)
            goto ex_0;
        own_defnOPold.num = T_0_1.num;
        }
        {
        own_defnOPactive.tf = false;
        }
        signal(ERR_ok);
      ex_0:
        __CLU_EX_HANDLER;
        pclu_unhandled(err);
        signal(ERR_failure);
    }
    signal(ERR_ok);
}


/**** BEGIN PROCEDURE start ****/


errcode
own_defnOPstart(void)
{
    errcode err;
    if (own_defn_own_init == 0) {
        err = own_defn_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(946);

  LINE(947);
    {
    CLUREF T_1_1;
    err = arrayOPnew(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    own_defnOPold.num = T_1_1.num;
    }

  LINE(948);
    {
    own_defnOPactive.tf = true;
    }

  LINE(949);
    { /* return */
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE start ****/


/**** BEGIN PROCEDURE test ****/


errcode
own_defnOPtest(CLUREF s, CLUREF *ret_1)
{
    errcode err;
    CLUREF each_s;
    if (own_defn_own_init == 0) {
        err = own_defn_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(952);

  LINE(954);
    { /* if */
    CLUREF T_1_1;
    T_1_1.num = !own_defnOPactive.num;
    if (T_1_1.num == true) { /* if */
        { /* return */
        {
        ret_1->tf = true;
        }
        signal (ERR_ok);
        }
    }
    } /* end if */

  LINE(955);
    { /* for array$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = own_defnOPold.array->ext_high;
    T_1_3 = own_defnOPold;
    for (T_1_1.num = own_defnOPold.array->ext_low; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        if (T_1_1.num > T_1_3.array->ext_high || T_1_1.num < T_1_3.array->ext_low) {
            err = ERR_failure;
            elist[0] = array_bounds_exception_STRING;
            goto ex_0;
        }
        each_s.num = T_1_3.array->store->data[T_1_1.num - T_1_3.array->ext_low + T_1_3.array->int_low];

  LINE(956);
        { /* if */
        CLUREF T_2_1;
        T_2_1.num = ((each_s.str->size != s.str->size)? false :
            !(memcmp(each_s.str->data, s.str->data, each_s.str->size)));
        if (T_2_1.num == true) { /* if */
            { /* return */
            {
            ret_1->tf = false;
            }
            signal (ERR_ok);
            }
        }
        } /* end if */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(958);
    {
    {
    if ((own_defnOPold.array->int_low + own_defnOPold.array->ext_size + 1) < own_defnOPold.array->int_size) {
        own_defnOPold.array->store->data[own_defnOPold.array->int_low + own_defnOPold.array->ext_size] = s.num;
        own_defnOPold.array->ext_size++;
        own_defnOPold.array->ext_high++;
    }
    else {
        err = arrayOPaddh(own_defnOPold, s);
        if (err != ERR_ok)
            goto ex_0;
    }
    }
    }

  LINE(959);
    { /* return */
    {
    ret_1->tf = true;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE test ****/


/**** BEGIN PROCEDURE stop ****/


errcode
own_defnOPstop(void)
{
    errcode err;
    if (own_defn_own_init == 0) {
        err = own_defn_own_init_proc();
        if (err != ERR_ok)
            goto ex_0;
    }
    enter_proc(962);

  LINE(963);
    {
    own_defnOPactive.tf = false;
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE stop ****/

typedef struct{
    long count;
    OWNPTR type_owns;
    OWNPTR op_owns;
    struct OP_ENTRY entry[3];
} own_defn_OPS;

static CLU_proc own_defn_oe_start = { .proc = own_defnOPstart };
static CLU_proc own_defn_oe_stop = { .proc = own_defnOPstop };
static CLU_proc own_defn_oe_test = { .proc = own_defnOPtest };

static own_defn_OPS own_defn_ops_actual = {3, (OWNPTR)&own_defn_own_init, (OWNPTR)&own_defn_own_init, {
    {&own_defn_oe_start, "start"},
    {&own_defn_oe_stop, "stop"},
    {&own_defn_oe_test, "test"}}};

struct OPS *own_defn_ops = (struct OPS *)&own_defn_ops_actual;

/**** END CLUSTER own_defn ****/


/**** BEGIN PROCEDURE base_cluster_test ****/

static int base_cluster_test_own_init = 0;

errcode
base_cluster_test(CLUREF cop, CLUREF ct, CLUREF *ret_1)
{
    errcode err;
    if (base_cluster_test_own_init == 0) {
        stringOPcons("array", CLU_1, CLUREF_make_num(5), &STR_array);
        stringOPcons("sequence", CLU_1, CLUREF_make_num(8), &STR_sequence);
        stringOPcons("_vec", CLU_1, CLUREF_make_num(4), &STR__137vec);
        base_cluster_test_own_init = 1;
    }
    enter_proc(970);

  LINE(971);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    CLUREF T_1_5;
    CLUREF T_1_6;
    CLUREF T_1_7;
    CLUREF T_1_8;
    CLUREF T_1_9;
    CLUREF T_1_10;
    CLUREF T_1_11;
    CLUREF T_1_12;
    CLUREF T_1_13;
    CLUREF T_1_14;
    CLUREF T_1_15;
    CLUREF T_1_16;
    T_1_4.num = ct.vec->data[0];
    err = duOPget_common(T_1_4, &T_1_5);
    if (err != ERR_ok)
        goto ex_0;
    T_1_6.num = ((T_1_5.str->size != STR_array.str->size)? false :
        !(memcmp(T_1_5.str->data, STR_array.str->data, T_1_5.str->size)));
    T_1_3.num = T_1_6.num;
    if (!T_1_6.num) {
        T_1_7.num = ct.vec->data[0];
        err = duOPget_common(T_1_7, &T_1_8);
        if (err != ERR_ok)
            goto ex_0;
        T_1_9.num = ((T_1_8.str->size != STR_sequence.str->size)? false :
            !(memcmp(T_1_8.str->data, STR_sequence.str->data, T_1_8.str->size)));
        T_1_3.num = T_1_9.num;
    }
    T_1_2.num = T_1_3.num;
    if (!T_1_3.num) {
        T_1_10.num = ct.vec->data[0];
        err = duOPget_common(T_1_10, &T_1_11);
        if (err != ERR_ok)
            goto ex_0;
        T_1_12.num = ((T_1_11.str->size != STR__137vec.str->size)? false :
            !(memcmp(T_1_11.str->data, STR__137vec.str->data, T_1_11.str->size)));
        T_1_2.num = T_1_12.num;
    }
    T_1_1.num = T_1_2.num;
    if (T_1_2.num) {
        T_1_13.num = ct.vec->data[0];
        T_1_14.num = cop.vec->data[0];
        err = parmd_op(T_1_13, T_1_14, &T_1_15);
        if (err != ERR_ok)
            goto ex_0;
        T_1_16.num = !T_1_15.num;
        T_1_1.num = T_1_16.num;
    }
    if (T_1_1.num == true) { /* if */

  LINE(975);
        { /* return */
        {
        ret_1->tf = true;
        }
        signal (ERR_ok);
        }
    }
    } /* end if */

  LINE(976);
    { /* return */
    {
    ret_1->tf = false;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE base_cluster_test ****/



/**** BEGIN PROCEDURE base_apply_test ****/

static int base_apply_test_own_init = 0;

errcode
base_apply_test(CLUREF ct, CLUREF *ret_1)
{
    errcode err;
    if (base_apply_test_own_init == 0) {
        stringOPcons("_cvt", CLU_1, CLUREF_make_num(4), &STR__137cvt);
        base_apply_test_own_init = 1;
    }
    enter_proc(979);

  LINE(980);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_1.num = ct.vec->data[0];
    err = duOPget_common(T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    T_1_3.num = ((T_1_2.str->size != STR__137cvt.str->size)? false :
        !(memcmp(T_1_2.str->data, STR__137cvt.str->data, T_1_2.str->size)));
    if (T_1_3.num == true) { /* if */

  LINE(981);
        { /* return */
        {
        ret_1->tf = true;
        }
        signal (ERR_ok);
        }
    }
    } /* end if */

  LINE(983);
    { /* return */
    {
    ret_1->tf = false;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE base_apply_test ****/

