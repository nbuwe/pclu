
/* This file was automatically generated by pclu. */

#include "pclu_err.h"
#include "pclu_sys.h"



/**** BEGIN PROCEDURE c_typedefn ****/

extern errcode c_envOPset_line();
extern errcode recordOPget_6();
extern errcode recordOPget_4();
extern errcode sequenceOPempty();
extern errcode recordOPget_8();
extern errcode c_new_module();
extern errcode boolOPnot();
extern errcode stringOPequal();
extern errcode duOPget_unique();
extern errcode idnOPget_str();
extern errcode idnOPcreate();
extern errcode idnOPget_kind();
extern errcode recordOPset_4();
extern errcode c_envOPbegin_scope();
extern errcode c_setup_opers();
extern errcode c_type_specs();
extern errcode b_typeinfo();
extern errcode intOPequal();
extern errcode oneofOPmake_3();
extern errcode oneofOPmake_5();
extern errcode oneofOPmake_2();
extern errcode fixup_new_module();
extern errcode c_type_main();
extern errcode c_envOPend_scope();
extern errcode recordOPset_1();
extern errcode sequenceOPsubseq();
extern errcode recordOPget_1();

errcode
c_typedefn(CLUREF e, CLUREF def, CLUREF kind)
{
    errcode err;
    CLUREF i;
    CLUREF want;
    CLUREF mod;
    CLUREF specs;
    CLUREF info;
    CLUREF extsize;
    CLUREF ninfo;
    CLUREF nspecs;
    enter_proc(6);

  LINE(7);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[5];
    err = c_envOPset_line(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(8);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[3];
    i.num = T_1_1.num;
    }

  LINE(10);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = def.vec->data[7];
    err = sequenceOPempty(T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    if (T_1_2.num == true) { /* if */

  LINE(11);
        {
        want.num = 1;
        }
    }
    else { /* else */

  LINE(12);
        {
        want.num = 0;
        }
    }} /* end if */

  LINE(14);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    err = c_new_module(e, i, want, &T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    mod.num = T_1_1.num;
    specs.num = T_1_2.num;
    }

  LINE(15);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    err = duOPget_unique(mod, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    err = idnOPget_str(i, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    T_1_3.num = ((T_1_1.str->size != T_1_2.str->size)? false :
        !(memcmp(T_1_1.str->data, T_1_2.str->data, T_1_1.str->size)));
    T_1_4.num = !T_1_3.num;
    if (T_1_4.num == true) { /* if */

  LINE(16);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        err = duOPget_unique(mod, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        err = idnOPget_kind(i, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        err = idnOPcreate(T_2_1, T_2_2, &T_2_3);
        if (err != ERR_ok)
            goto ex_0;
        i.num = T_2_3.num;
        }

  LINE(17);
        {
        def.vec->data[3] = i.num;
        }
    }
    } /* end if */

  LINE(19);
    {
    err = c_envOPbegin_scope(e);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(20);
    {
    err = c_setup_opers(e, def);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(21);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    err = c_type_specs(e, def, mod, &T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    info.num = T_1_1.num;
    extsize.num = T_1_2.num;
    }

  LINE(22);
    {
    CLUREF T_1_1;
    err = b_typeinfo(e, info, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    ninfo.num = T_1_1.num;
    }

  LINE(24);
    { /* if */
    CLUREF T_1_1;
    T_1_1.num = (kind.num == 0);
    if (T_1_1.num == true) { /* if */

  LINE(25);
        {
        CLUREF T_2_1;
        CellAlloc(3, ninfo.num, T_2_1);
        nspecs.num = T_2_1.num;
        }
    }
    else {

  LINE(26);
    CLUREF T_1_2;
    T_1_2.num = (kind.num == 1);
    if (T_1_2.num == true) { /* elseif */

  LINE(27);
        {
        CLUREF T_2_1;
        CellAlloc(5, ninfo.num, T_2_1);
        nspecs.num = T_2_1.num;
        }
    }
    else { /* else */

  LINE(28);
        {
        CLUREF T_2_1;
        CellAlloc(2, ninfo.num, T_2_1);
        nspecs.num = T_2_1.num;
        }
    }}} /* end if */

  LINE(29);
    {
    err = fixup_new_module(e, i, mod, nspecs);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(30);
    {
    err = c_type_main(e, def, info);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(31);
    {
    err = c_envOPend_scope(e);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(32);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = ninfo.vec->data[0];
    err = sequenceOPsubseq(T_1_1, CLU_1, extsize, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    ninfo.vec->data[0] = T_1_2.num;
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE c_typedefn ****/



/**** BEGIN PROCEDURE c_setup_opers ****/

extern errcode recordOPget_7();
extern errcode oneofOPmake_8();
extern errcode sequenceOPelements();
extern errcode c_envOPdeclare();
extern errcode recordOPget_5();
extern errcode c_member();
extern errcode oneofOPis_8();
extern errcode idnOPset_kind();
extern errcode c_envOPerr();
extern errcode stringOPconcat();
extern errcode recordOPset_5();
static CLUREF STR_redeclaration_040of_040_047;
static CLUREF STR__047;
static CLUREF STR__045;
static CLUREF STR_operation_040_047;
static CLUREF STR__047_040not_040defined;
static int c_setup_opers_own_init = 0;

errcode
c_setup_opers(CLUREF e, CLUREF def)
{
    errcode err;
    CLUREF extops;
    CLUREF uk;
    CLUREF i;
    CLUREF op;
    CLUREF n;
    if (c_setup_opers_own_init == 0) {
        stringOPcons("redeclaration of \'", CLU_1, CLUREF_make_num(18), &STR_redeclaration_040of_040_047);
        stringOPcons("\'", CLU_1, CLUREF_make_num(1), &STR__047);
        stringOPcons("%", CLU_1, CLUREF_make_num(1), &STR__045);
        stringOPcons("operation \'", CLU_1, CLUREF_make_num(11), &STR_operation_040_047);
        stringOPcons("\' not defined", CLU_1, CLUREF_make_num(13), &STR__047_040not_040defined);
        c_setup_opers_own_init = 1;
    }
    enter_proc(35);

  LINE(36);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[6];
    extops.num = T_1_1.num;
    }

  LINE(37);
    {
    CLUREF T_1_1;
    CellAlloc(8, nil, T_1_1);
    uk.num = T_1_1.num;
    }

  LINE(38);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = extops.vec->size;
    T_1_3 = extops;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        i.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(39);
        {
        err = c_envOPdeclare(e, i, uk);
        if (err != ERR_ok)
            goto ex_0;
        }
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(41);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    T_1_1.num = def.vec->data[0];
    T_1_3.num = T_1_1.vec->size;
    T_1_4 = T_1_1;
    for (T_1_2.num = 1; T_1_2.num <= T_1_3.num; T_1_2.num++) {
        op.num = T_1_4.vec->data[T_1_2.num - 1];

  LINE(42);
        {
        CLUREF T_2_1;
        T_2_1.num = op.vec->data[6];
        err = c_envOPset_line(e, T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        }

  LINE(43);
        {
        CLUREF T_2_1;
        T_2_1.num = op.vec->data[4];
        i.num = T_2_1.num;
        }

  LINE(44);
        {
        CLUREF T_2_1;
        err = idnOPget_str(i, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        n.num = T_2_1.num;
        }

  LINE(45);
        { /* if */
        CLUREF T_2_1;
        err = c_member(i, extops, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_1.num == true) { /* if */

  LINE(46);
            { /* if */
            CLUREF T_3_1;
            CLUREF T_3_2;
            err = idnOPget_kind(i, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_1.cell->tag == 8) T_3_2.num = true; else T_3_2.num = false;
            if (T_3_2.num == true) { /* if */

  LINE(47);
                {
                CLUREF T_4_1;
                CellAlloc(3, n.num, T_4_1);
                err = idnOPset_kind(i, T_4_1);
                if (err != ERR_ok)
                    goto ex_0;
                }
            }
            else { /* else */

  LINE(48);
                {
                CLUREF T_4_1;
                CLUREF T_4_2;
                sequenceOPnew2(CLU_3, &T_4_1);
                T_4_1.vec->data[0] = STR_redeclaration_040of_040_047.num;
                err = idnOPget_str(i, &T_4_2);
                if (err != ERR_ok)
                    goto ex_0;
                T_4_1.vec->data[1] = T_4_2.num;
                T_4_1.vec->data[2] = STR__047.num;
                err = c_envOPerr(e, T_4_1);
                if (err != ERR_ok)
                    goto ex_0;
                }
            }} /* end if */
        }
        else { /* else */

  LINE(51);
            {
            CLUREF T_3_1;
            err = stringOPconcat(STR__045, n, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            n.num = T_3_1.num;
            }

  LINE(52);
            {
            CLUREF T_3_1;
            CellAlloc(3, n.num, T_3_1);
            err = c_envOPdeclare(e, i, T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(53);
            {
            CLUREF T_3_1;
            err = idnOPcreate(n, uk, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            op.vec->data[4] = T_3_1.num;
            }
        }} /* end if */
    }
    }
    end_inline_for_2:
    __CLU_END_LABEL;

  LINE(56);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[5];
    err = c_envOPset_line(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(57);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = extops.vec->size;
    T_1_3 = extops;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        i.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(58);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        err = idnOPget_kind(i, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_1.cell->tag == 8) T_2_2.num = true; else T_2_2.num = false;
        if (T_2_2.num == true) { /* if */

  LINE(59);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            sequenceOPnew2(CLU_3, &T_3_1);
            T_3_1.vec->data[0] = STR_operation_040_047.num;
            err = idnOPget_str(i, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            T_3_1.vec->data[1] = T_3_2.num;
            T_3_1.vec->data[2] = STR__047_040not_040defined.num;
            err = c_envOPerr(e, T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(60);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            err = idnOPget_str(i, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            CellAlloc(3, T_3_1.num, T_3_2);
            err = idnOPset_kind(i, T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            }
        }
        } /* end if */
    }
    }
    end_inline_for_3:
    __CLU_END_LABEL;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE c_setup_opers ****/



/**** BEGIN PROCEDURE c_fixup_opname ****/

extern errcode charOPequal();
extern errcode stringOPfetch();
extern errcode stringOPrest();

errcode
c_fixup_opname(CLUREF nm, CLUREF *ret_1)
{
    errcode err;
    enter_proc(68);

  LINE(69);
    { /* if */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    err = stringOPfetch(nm, CLU_1, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    T_1_2.ch = '%';
    T_1_3.num = (T_1_1.ch == T_1_2.ch);
    if (T_1_3.num == true) { /* if */
        {
        CLUREF T_2_1;
        err = stringOPrest(nm, CLU_2, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        nm.num = T_2_1.num;
        }
    }
    } /* end if */

  LINE(70);
    { /* return */
    {
    ret_1->num = nm.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE c_fixup_opname ****/



/**** BEGIN PROCEDURE c_member ****/

extern errcode idnOPequal();

errcode
c_member(CLUREF i, CLUREF idns, CLUREF *ret_1)
{
    errcode err;
    CLUREF id;
    enter_proc(74);

  LINE(75);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = idns.vec->size;
    T_1_3 = idns;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        id.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(76);
        { /* if */
        CLUREF T_2_1;
        err = idnOPequal(i, id, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_1.num == true) { /* if */
            { /* return */
            {
            ret_1->tf = true;
            }
            signal (ERR_ok);
            }
        }
        } /* end if */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(78);
    { /* return */
    {
    ret_1->tf = false;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE c_member ****/



/**** BEGIN PROCEDURE c_type_specs ****/

extern errcode recordOPget_10();
extern errcode recordOPget_3();
extern errcode c_envOPbegin_specs();
extern errcode c_envOPeval_parms();
extern errcode c_parameters();
extern errcode recordOPset_9();
extern errcode c_up_type();
extern errcode c_envOPset_up_type();
extern errcode recordOPget_9();
extern errcode c_envOPeval_equates();
extern errcode recordOPset_2();
extern errcode c_down_type();
extern errcode c_envOPset_down_type();
extern errcode recordOPget_2();
extern errcode c_restrictlist();
extern errcode c_add_restricts();
extern errcode sequenceOPnew();
extern errcode c_oper_specs();
extern errcode sequenceOPaddh();
extern errcode c_envOPend_specs();
extern errcode sequenceOPconcat();
extern errcode sequenceOPsize();

errcode
c_type_specs(CLUREF e, CLUREF def, CLUREF mod, CLUREF *ret_1, CLUREF *ret_2)
{
    errcode err;
    CLUREF dparms;
    CLUREF reqs;
    CLUREF equates;
    CLUREF opers;
    CLUREF nparms;
    CLUREF extinfo;
    CLUREF intinfo;
    CLUREF op;
    CLUREF inf;
    enter_proc(81);

  LINE(82);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[7];
    dparms.num = T_1_1.num;
    }

  LINE(83);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[9];
    reqs.num = T_1_1.num;
    }

  LINE(84);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[2];
    equates.num = T_1_1.num;
    }

  LINE(85);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[0];
    opers.num = T_1_1.num;
    }

  LINE(86);
    {
    err = c_envOPbegin_specs(e);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(87);
    {
    err = c_envOPeval_parms(e, dparms, equates);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(88);
    {
    CLUREF T_1_1;
    err = c_parameters(e, dparms, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    nparms.num = T_1_1.num;
    }

  LINE(89);
    {
    CLUREF T_1_1;
    err = c_up_type(e, mod, nparms, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    def.vec->data[8] = T_1_1.num;
    }

  LINE(90);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[8];
    err = c_envOPset_up_type(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(91);
    {
    err = c_envOPeval_equates(e);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(92);
    {
    CLUREF T_1_1;
    err = c_down_type(e, equates, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    def.vec->data[1] = T_1_1.num;
    }

  LINE(93);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[1];
    err = c_envOPset_down_type(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(94);
    {
    err = c_restrictlist(e, reqs);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(95);
    {
    err = c_add_restricts(e, reqs);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(96);
    {
    CLUREF T_1_1;
    err = sequenceOPnew(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    extinfo.num = T_1_1.num;
    }

  LINE(97);
    {
    CLUREF T_1_1;
    err = sequenceOPnew(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    intinfo.num = T_1_1.num;
    }

  LINE(98);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = opers.vec->size;
    T_1_3 = opers;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        op.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(99);
        {
        CLUREF T_2_1;
        err = c_oper_specs(e, op, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        inf.num = T_2_1.num;
        }

  LINE(100);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        CLUREF T_2_4;
        T_2_1.num = inf.vec->data[1];
        err = stringOPfetch(T_2_1, CLU_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        T_2_3.ch = '%';
        T_2_4.num = (T_2_2.ch == T_2_3.ch);
        if (T_2_4.num == true) { /* if */

  LINE(101);
            {
            CLUREF T_3_1;
            err = sequenceOPaddh(intinfo, inf, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            intinfo.num = T_3_1.num;
            }
        }
        else { /* else */

  LINE(102);
            {
            CLUREF T_3_1;
            err = sequenceOPaddh(extinfo, inf, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            extinfo.num = T_3_1.num;
            }
        }} /* end if */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(105);
    {
    err = c_envOPend_specs(e);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(106);
    { /* return */
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    RecordAlloc(2, T_1_1);
    T_1_1.vec->data[1] = nparms.num;
    err = sequenceOPconcat(extinfo, intinfo, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    T_1_1.vec->data[0] = T_1_2.num;
    ret_1->num = T_1_1.num;
    }
    {
    CLUREF T_1_3;
    T_1_3.num = extinfo.vec->size;
    ret_2->num = T_1_3.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE c_type_specs ****/



/**** BEGIN PROCEDURE c_type_main ****/

extern errcode c_push_parms();
extern errcode c_envOPbegin_recheck();
extern errcode c_envOPequates();
extern errcode c_envOPend_recheck();
extern errcode c_initlist();
extern errcode c_oper_main();

errcode
c_type_main(CLUREF e, CLUREF def, CLUREF info)
{
    errcode err;
    CLUREF opers;
    CLUREF op;
    enter_proc(111);

  LINE(112);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[5];
    err = c_envOPset_line(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(113);
    {
    err = c_envOPbegin_scope(e);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(114);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = def.vec->data[7];
    T_1_2.num = info.vec->data[1];
    err = c_push_parms(e, T_1_1, T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(115);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_1.num = info.vec->data[1];
    err = sequenceOPempty(T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    T_1_3.num = !T_1_2.num;
    err = c_envOPbegin_recheck(e, T_1_3);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(116);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[2];
    err = c_envOPequates(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(117);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[9];
    err = c_restrictlist(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(118);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_1.num = info.vec->data[1];
    err = sequenceOPempty(T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    T_1_3.num = !T_1_2.num;
    err = c_envOPend_recheck(e, T_1_3);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(119);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[4];
    err = c_initlist(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(120);
    {
    CLUREF T_1_1;
    T_1_1.num = info.vec->data[0];
    opers.num = T_1_1.num;
    }

  LINE(121);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    T_1_1.num = def.vec->data[0];
    T_1_3.num = T_1_1.vec->size;
    T_1_4 = T_1_1;
    for (T_1_2.num = 1; T_1_2.num <= T_1_3.num; T_1_2.num++) {
        op.num = T_1_4.vec->data[T_1_2.num - 1];

  LINE(122);
        {
        err = c_oper_main(e, op, opers);
        if (err != ERR_ok)
            goto ex_0;
        }
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(124);
    {
    err = c_envOPend_scope(e);
    if (err != ERR_ok)
        goto ex_0;
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE c_type_main ****/



/**** BEGIN PROCEDURE c_up_type ****/

extern errcode c_envOPget_type_type();
extern errcode oneofOPmake_25();
extern errcode c_envOPget_type();
extern errcode exprOPcreate();
extern errcode oneofOPmake_13();

errcode
c_up_type(CLUREF e, CLUREF gen, CLUREF parms, CLUREF *ret_1)
{
    errcode err;
    CLUREF exprs;
    CLUREF tt;
    CLUREF i;
    CLUREF ta;
    CLUREF xa;
    CLUREF k;
    enter_proc(127);

  LINE(128);
    {
    CLUREF T_1_1;
    err = sequenceOPnew(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    exprs.num = T_1_1.num;
    }

  LINE(129);
    {
    CLUREF T_1_1;
    err = c_envOPget_type_type(e, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    tt.num = T_1_1.num;
    }

  LINE(130);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = parms.vec->size;
    T_1_3 = parms;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        i.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(131);
        { /* qtagcase */
        CLUREF T_2_1;
        err = idnOPget_kind(i, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        switch (T_2_1.cell->tag) {
        case 6: /* tparm */ {

  LINE(133);
            {
            CLUREF T_3_1;
            CellAlloc(5, i.num, T_3_1);
            ta.num = T_3_1.num;
            }

  LINE(134);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            err = c_envOPget_type(e, ta, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            CellAlloc(25, T_3_1.num, T_3_2);
            xa.num = T_3_2.num;
            }

  LINE(135);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            err = exprOPcreate(xa, tt, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            err = sequenceOPaddh(exprs, T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            exprs.num = T_3_2.num;
            }
            break;
        }
        case 10: /* vparm */ {
            CLUREF T_2_2;
            T_2_2.num = T_2_1.cell->value;
            k.num = T_2_2.num;

  LINE(137);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CellAlloc(13, i.num, T_3_1);
            err = exprOPcreate(T_3_1, k, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            err = sequenceOPaddh(exprs, T_3_2, &T_3_3);
            if (err != ERR_ok)
                goto ex_0;
            exprs.num = T_3_3.num;
            }
            break;
        }
        }
        } /* end qtagcase */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(142);
    { /* return */
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    RecordAlloc(2, T_1_1);
    T_1_1.vec->data[0] = gen.num;
    T_1_1.vec->data[1] = exprs.num;
    CellAlloc(3, T_1_1.num, T_1_2);
    err = c_envOPget_type(e, T_1_2, &T_1_3);
    if (err != ERR_ok)
        goto ex_0;
    ret_1->num = T_1_3.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE c_up_type ****/



/**** BEGIN PROCEDURE c_down_type ****/

extern errcode equateOPis_rep();
extern errcode equateOPget_line();
extern errcode equateOPget_idn();
extern errcode exprOPget_abs();
extern errcode oneofOPis_6();
extern errcode typespecOPget_abs();
extern errcode exprOPget_typespec();
extern errcode exprOPset_abs();
extern errcode exprOPset_typespec();
extern errcode c_envOPerr1();
extern errcode c_envOPget_unknown_type();
static CLUREF STR_REP_040not_040equated_040to_040a_040type;
static CLUREF STR_REP_040undefined;
static int c_down_type_own_init = 0;

errcode
c_down_type(CLUREF e, CLUREF eqs, CLUREF *ret_1)
{
    errcode err;
    CLUREF eq;
    CLUREF k;
    CLUREF xa;
    CLUREF ta;
    CLUREF t;
    if (c_down_type_own_init == 0) {
        stringOPcons("REP not equated to a type", CLU_1, CLUREF_make_num(25), &STR_REP_040not_040equated_040to_040a_040type);
        stringOPcons("REP undefined", CLU_1, CLUREF_make_num(13), &STR_REP_040undefined);
        c_down_type_own_init = 1;
    }
    enter_proc(146);

  LINE(147);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = eqs.vec->size;
    T_1_3 = eqs;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        eq.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(148);
        { /* if */
        CLUREF T_2_1;
        err = equateOPis_rep(eq, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_1.num == true) { /* if */

  LINE(149);
            {
            CLUREF T_3_1;
            err = equateOPget_line(eq, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            err = c_envOPset_line(e, T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(150);
            { /* qtagcase */
            CLUREF T_3_1;
            CLUREF T_3_2;
            err = equateOPget_idn(eq, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            err = idnOPget_kind(T_3_1, &T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            switch (T_3_2.cell->tag) {
            case 1: /* expr */ {
                CLUREF T_3_3;
                T_3_3.num = T_3_2.cell->value;
                k.num = T_3_3.num;

  LINE(152);
                { /* qtagcase */
                CLUREF T_4_1;
                err = exprOPget_abs(k, &T_4_1);
                if (err != ERR_ok)
                    goto ex_0;
                switch (T_4_1.cell->tag) {
                case 25: /* type_ */ {
                    CLUREF T_4_2;
                    T_4_2.num = T_4_1.cell->value;
                    xa.num = T_4_2.num;

  LINE(154);
                    { /* return */
                    {
                    ret_1->num = xa.num;
                    }
                    signal (ERR_ok);
                    }
                    break;
                }
                case 3: /* apply */ {
                    CLUREF T_4_3;
                    T_4_3.num = T_4_1.cell->value;
                    xa.num = T_4_3.num;

  LINE(156);
                    { /* if */
                    CLUREF T_5_1;
                    CLUREF T_5_2;
                    CLUREF T_5_3;
                    err = exprOPget_typespec(k, &T_5_1);
                    if (err != ERR_ok)
                        goto ex_0;
                    err = typespecOPget_abs(T_5_1, &T_5_2);
                    if (err != ERR_ok)
                        goto ex_0;
                    if (T_5_2.cell->tag == 6) T_5_3.num = true; else T_5_3.num = false;
                    if (T_5_3.num == true) { /* if */

  LINE(157);
                        {
                        CLUREF T_6_1;
                        CellAlloc(3, xa.num, T_6_1);
                        ta.num = T_6_1.num;
                        }

  LINE(158);
                        {
                        CLUREF T_6_1;
                        err = c_envOPget_type(e, ta, &T_6_1);
                        if (err != ERR_ok)
                            goto ex_0;
                        t.num = T_6_1.num;
                        }

  LINE(159);
                        {
                        CLUREF T_6_1;
                        CellAlloc(25, t.num, T_6_1);
                        err = exprOPset_abs(k, T_6_1);
                        if (err != ERR_ok)
                            goto ex_0;
                        }

  LINE(160);
                        {
                        CLUREF T_6_1;
                        err = c_envOPget_type_type(e, &T_6_1);
                        if (err != ERR_ok)
                            goto ex_0;
                        err = exprOPset_typespec(k, T_6_1);
                        if (err != ERR_ok)
                            goto ex_0;
                        }

  LINE(161);
                        { /* return */
                        {
                        ret_1->num = t.num;
                        }
                        signal (ERR_ok);
                        }
                    }
                    } /* end if */
                    break;
                }
                }
                } /* end qtagcase */
                break;
            }
            }
            } /* end qtagcase */

  LINE(167);
            {
            err = c_envOPerr1(e, STR_REP_040not_040equated_040to_040a_040type);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(168);
            { /* return */
            {
            CLUREF T_3_1;
            err = c_envOPget_unknown_type(e, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            ret_1->num = T_3_1.num;
            }
            signal (ERR_ok);
            }
        }
        } /* end if */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(171);
    {
    err = c_envOPerr1(e, STR_REP_040undefined);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(172);
    { /* return */
    {
    CLUREF T_1_1;
    err = c_envOPget_unknown_type(e, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    ret_1->num = T_1_1.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE c_down_type ****/



/**** BEGIN PROCEDURE c_oper_specs ****/

extern errcode c_envOPset_varlist();
extern errcode recordOPget_12();
extern errcode recordOPget_13();
extern errcode c_decllist1();
extern errcode c_typelist1();
extern errcode recordOPget_11();
extern errcode recordOPset_11();
extern errcode c_exceptionlist1();
extern errcode c_oper_requires();
extern errcode recordOPset_10();

errcode
c_oper_specs(CLUREF e, CLUREF def, CLUREF *ret_1)
{
    errcode err;
    CLUREF dparms;
    CLUREF reqs;
    CLUREF nparms;
    CLUREF args;
    CLUREF vals;
    CLUREF ivals;
    CLUREF sigs;
    CLUREF at;
    CLUREF xreqs;
    CLUREF t;
    CLUREF n;
    enter_proc(175);

  LINE(176);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[6];
    err = c_envOPset_line(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(177);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[11];
    err = c_envOPset_varlist(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(178);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[7];
    dparms.num = T_1_1.num;
    }

  LINE(179);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[12];
    reqs.num = T_1_1.num;
    }

  LINE(180);
    {
    err = c_envOPbegin_scope(e);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(181);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[2];
    err = c_envOPeval_parms(e, dparms, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(182);
    {
    CLUREF T_1_1;
    err = c_parameters(e, dparms, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    nparms.num = T_1_1.num;
    }

  LINE(183);
    {
    err = c_envOPeval_equates(e);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(184);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = def.vec->data[0];
    err = c_decllist1(e, T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    args.num = T_1_2.num;
    }

  LINE(185);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_1.num = def.vec->data[10];
    err = c_typelist1(e, T_1_1, &T_1_2, &T_1_3);
    if (err != ERR_ok)
        goto ex_0;
    vals.num = T_1_2.num;
    ivals.num = T_1_3.num;
    }

  LINE(186);
    {
    def.vec->data[10] = ivals.num;
    }

  LINE(187);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = def.vec->data[8];
    err = c_exceptionlist1(e, T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    sigs.num = T_1_2.num;
    }

  LINE(188);
    {
    err = c_restrictlist(e, reqs);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(189);
    {
    err = c_envOPend_scope(e);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(190);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    RecordAlloc(4, T_1_1);
    T_1_2.num = def.vec->data[3];
    T_1_1.vec->data[1] = T_1_2.num;
    T_1_1.vec->data[0] = args.num;
    T_1_1.vec->data[3] = vals.num;
    T_1_1.vec->data[2] = sigs.num;
    at.num = T_1_1.num;
    }

  LINE(194);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = def.vec->data[12];
    err = c_oper_requires(e, T_1_1, nparms, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    xreqs.num = T_1_2.num;
    }

  LINE(195);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    CellAlloc(2, at.num, T_1_1);
    err = c_envOPget_type(e, T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    t.num = T_1_2.num;
    }

  LINE(196);
    {
    def.vec->data[9] = t.num;
    }

  LINE(197);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = def.vec->data[4];
    err = idnOPget_str(T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    n.num = T_1_2.num;
    }

  LINE(198);
    { /* return */
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    RecordAlloc(3, T_1_1);
    T_1_1.vec->data[1] = n.num;
    T_1_1.vec->data[2] = xreqs.num;
    RecordAlloc(2, T_1_2);
    T_1_2.vec->data[0] = nparms.num;
    T_1_2.vec->data[1] = t.num;
    T_1_1.vec->data[0] = T_1_2.num;
    ret_1->num = T_1_1.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE c_oper_specs ****/



/**** BEGIN PROCEDURE c_oper_main ****/

extern errcode c_add_requires();
extern errcode c_apply_main1();
extern errcode c_rem_requires();

errcode
c_oper_main(CLUREF e, CLUREF def, CLUREF infos)
{
    errcode err;
    CLUREF n;
    CLUREF info;
    CLUREF reqs;
    enter_proc(204);

  LINE(205);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = def.vec->data[4];
    err = idnOPget_str(T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    n.num = T_1_2.num;
    }

  LINE(206);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = infos.vec->size;
    T_1_3 = infos;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        info.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(207);
        { /* if */
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = info.vec->data[1];
        T_2_2.num = ((n.str->size != T_2_1.str->size)? false :
            !(memcmp(n.str->data, T_2_1.str->data, n.str->size)));
        if (T_2_2.num == true) { /* if */

  LINE(208);
            {
            CLUREF T_3_1;
            T_3_1.num = info.vec->data[2];
            reqs.num = T_3_1.num;
            }

  LINE(209);
            {
            err = c_add_requires(e, reqs);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(210);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = info.vec->data[0];
            T_3_2.num = T_3_1.vec->data[0];
            err = c_apply_main1(e, def, T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(211);
            {
            err = c_rem_requires(e, reqs);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(212);
            { /* return */
            signal (ERR_ok);
            }
        }
        } /* end if */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE c_oper_main ****/



/**** BEGIN PROCEDURE c_apply_main1 ****/

extern errcode c_type();
extern errcode c_envOPnew_apply();
extern errcode arrayOPtrim();
extern errcode c_stmt();

errcode
c_apply_main1(CLUREF e, CLUREF def, CLUREF nparms)
{
    errcode err;
    CLUREF args;
    CLUREF vals;
    CLUREF ivals;
    CLUREF sigs;
    CLUREF s;
    enter_proc(217);

  LINE(218);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[6];
    err = c_envOPset_line(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(219);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[11];
    err = c_envOPset_varlist(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(220);
    {
    err = c_envOPbegin_scope(e);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(221);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[7];
    err = c_push_parms(e, T_1_1, nparms);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(222);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    err = sequenceOPempty(nparms, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    T_1_2.num = !T_1_1.num;
    err = c_envOPbegin_recheck(e, T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(223);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = def.vec->data[0];
    err = c_decllist1(e, T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    args.num = T_1_2.num;
    }

  LINE(224);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_1.num = def.vec->data[10];
    err = c_typelist1(e, T_1_1, &T_1_2, &T_1_3);
    if (err != ERR_ok)
        goto ex_0;
    vals.num = T_1_2.num;
    ivals.num = T_1_3.num;
    }

  LINE(225);
    {
    def.vec->data[10] = ivals.num;
    }

  LINE(226);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = def.vec->data[8];
    err = c_exceptionlist1(e, T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    sigs.num = T_1_2.num;
    }

  LINE(227);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[12];
    err = c_restrictlist(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(228);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[2];
    err = c_envOPequates(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(229);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[6];
    err = c_envOPset_line(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(230);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_1.num = def.vec->data[9];
    err = c_type(e, T_1_1, &T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    def.vec->data[9] = T_1_2.num;
    }

  LINE(231);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    RecordAlloc(4, T_1_1);
    T_1_2.num = def.vec->data[3];
    T_1_1.vec->data[1] = T_1_2.num;
    T_1_1.vec->data[0] = args.num;
    T_1_1.vec->data[3] = vals.num;
    T_1_1.vec->data[2] = sigs.num;
    err = c_envOPnew_apply(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(235);
    {
    CLUREF T_1_1;
    CLUREF T_1_2;
    err = sequenceOPempty(nparms, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    T_1_2.num = !T_1_1.num;
    err = c_envOPend_recheck(e, T_1_2);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(236);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[5];
    err = c_initlist(e, T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(237);
    {
    CLUREF T_1_1;
    T_1_1.num = def.vec->data[11];
    err = arrayOPtrim(T_1_1, CLU_1, CLU_0);
    if (err != ERR_ok)
        goto ex_0;
    }

  LINE(238);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    CLUREF T_1_4;
    T_1_1.num = def.vec->data[1];
    T_1_3.num = T_1_1.vec->size;
    T_1_4 = T_1_1;
    for (T_1_2.num = 1; T_1_2.num <= T_1_3.num; T_1_2.num++) {
        s.num = T_1_4.vec->data[T_1_2.num - 1];

  LINE(239);
        {
        err = c_stmt(e, s);
        if (err != ERR_ok)
            goto ex_0;
        }
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(241);
    {
    err = c_envOPend_scope(e);
    if (err != ERR_ok)
        goto ex_0;
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE c_apply_main1 ****/



/**** BEGIN PROCEDURE c_add_requires ****/

extern errcode oneofOPmake_6();

errcode
c_add_requires(CLUREF e, CLUREF reqs)
{
    errcode err;
    CLUREF req;
    CLUREF k;
    enter_proc(244);

  LINE(245);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = reqs.vec->size;
    T_1_3 = reqs;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        req.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(246);
        { /* qtagcase */
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = req.vec->data[1];
        err = idnOPget_kind(T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        switch (T_2_2.cell->tag) {
        case 6: /* tparm */ {
            CLUREF T_2_3;
            T_2_3.num = T_2_2.cell->value;
            k.num = T_2_3.num;

  LINE(248);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            T_3_1.num = req.vec->data[1];
            T_3_2.num = req.vec->data[0];
            err = sequenceOPconcat(k, T_3_2, &T_3_3);
            if (err != ERR_ok)
                goto ex_0;
            CellAlloc(6, T_3_3.num, T_3_4);
            err = idnOPset_kind(T_3_1, T_3_4);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        }
        } /* end qtagcase */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE c_add_requires ****/



/**** BEGIN PROCEDURE c_rem_requires ****/

extern errcode intOPsub();

errcode
c_rem_requires(CLUREF e, CLUREF reqs)
{
    errcode err;
    CLUREF req;
    CLUREF k;
    enter_proc(254);

  LINE(255);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = reqs.vec->size;
    T_1_3 = reqs;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        req.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(256);
        { /* qtagcase */
        CLUREF T_2_1;
        CLUREF T_2_2;
        T_2_1.num = req.vec->data[1];
        err = idnOPget_kind(T_2_1, &T_2_2);
        if (err != ERR_ok)
            goto ex_0;
        switch (T_2_2.cell->tag) {
        case 6: /* tparm */ {
            CLUREF T_2_3;
            T_2_3.num = T_2_2.cell->value;
            k.num = T_2_3.num;

  LINE(258);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            CLUREF T_3_3;
            CLUREF T_3_4;
            CLUREF T_3_5;
            T_3_1.num = k.vec->size;
            T_3_2.num = req.vec->data[0];
            T_3_3.num = T_3_2.vec->size;
            T_3_4.num = T_3_1.num - T_3_3.num;
            if ((T_3_4.num >= 0 && T_3_1.num < 0 && (-T_3_3.num) < 0) ||
                (T_3_4.num <= 0 && T_3_1.num > 0 && (-T_3_3.num) > 0)) {
                err = ERR_overflow;
                goto ex_0;
            }
            err = sequenceOPsubseq(k, CLU_1, T_3_4, &T_3_5);
            if (err != ERR_ok)
                goto ex_0;
            k.num = T_3_5.num;
            }

  LINE(260);
            {
            CLUREF T_3_1;
            CLUREF T_3_2;
            T_3_1.num = req.vec->data[1];
            CellAlloc(6, k.num, T_3_2);
            err = idnOPset_kind(T_3_1, T_3_2);
            if (err != ERR_ok)
                goto ex_0;
            }
            break;
        }
        }
        } /* end qtagcase */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    signal(ERR_ok);
}

/**** END PROCEDURE c_rem_requires ****/



/**** BEGIN PROCEDURE c_decllist1 ****/

extern errcode c_envOPget_cvt_type();
extern errcode c_envOPget_down_type();
extern errcode c_envOPbuilding_specs();
extern errcode c_envOPget_up_type();
extern errcode typespecOPequal();
extern errcode c_envOPadd_var();

errcode
c_decllist1(CLUREF e, CLUREF decls, CLUREF *ret_1)
{
    errcode err;
    CLUREF types;
    CLUREF cvt_;
    CLUREF down_;
    CLUREF nt;
    CLUREF d;
    CLUREF dt;
    CLUREF at;
    CLUREF i;
    enter_proc(266);

  LINE(267);
    {
    CLUREF T_1_1;
    err = sequenceOPnew(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    types.num = T_1_1.num;
    }

  LINE(268);
    {
    CLUREF T_1_1;
    err = c_envOPget_cvt_type(e, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    cvt_.num = T_1_1.num;
    }

  LINE(269);
    {
    CLUREF T_1_1;
    err = c_envOPget_down_type(e, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    down_.num = T_1_1.num;
    }

  LINE(271);
    { /* if */
    CLUREF T_1_1;
    err = c_envOPbuilding_specs(e, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    if (T_1_1.num == true) { /* if */

  LINE(272);
        {
        CLUREF T_2_1;
        err = c_envOPget_up_type(e, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        nt.num = T_2_1.num;
        }
    }
    else { /* else */

  LINE(273);
        {
        nt.num = cvt_.num;
        }
    }} /* end if */

  LINE(275);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = decls.vec->size;
    T_1_3 = decls;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        d.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(276);
        {
        CLUREF T_2_1;
        T_2_1.num = d.vec->data[1];
        dt.num = T_2_1.num;
        }

  LINE(278);
        { /* if */
        CLUREF T_2_1;
        err = typespecOPequal(dt, cvt_, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_1.num == true) { /* if */

  LINE(279);
            {
            dt.num = down_.num;
            }

  LINE(280);
            {
            at.num = nt.num;
            }
        }
        else { /* else */

  LINE(281);
            {
            CLUREF T_3_1;
            err = c_type(e, dt, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            dt.num = T_3_1.num;
            }

  LINE(282);
            {
            d.vec->data[1] = dt.num;
            }

  LINE(283);
            {
            at.num = dt.num;
            }
        }} /* end if */

  LINE(285);
        { /* for sequence$elements */
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        CLUREF T_2_4;
        T_2_1.num = d.vec->data[0];
        T_2_3.num = T_2_1.vec->size;
        T_2_4 = T_2_1;
        for (T_2_2.num = 1; T_2_2.num <= T_2_3.num; T_2_2.num++) {
            i.num = T_2_4.vec->data[T_2_2.num - 1];

  LINE(286);
            {
            err = c_envOPadd_var(e, i, dt);
            if (err != ERR_ok)
                goto ex_0;
            }

  LINE(287);
            {
            CLUREF T_3_1;
            err = sequenceOPaddh(types, at, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            types.num = T_3_1.num;
            }
        }
        }
        end_inline_for_2:
        __CLU_END_LABEL;
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(290);
    { /* return */
    {
    ret_1->num = types.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE c_decllist1 ****/



/**** BEGIN PROCEDURE c_typelist1 ****/

extern errcode sequenceOPindexes();
extern errcode sequenceOPfetch();

errcode
c_typelist1(CLUREF e, CLUREF types, CLUREF *ret_1, CLUREF *ret_2)
{
    errcode err;
    CLUREF cvt_;
    CLUREF nt;
    CLUREF xtypes;
    CLUREF itypes;
    CLUREF i;
    CLUREF t;
    CLUREF xt;
    enter_proc(293);

  LINE(294);
    {
    CLUREF T_1_1;
    err = c_envOPget_cvt_type(e, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    cvt_.num = T_1_1.num;
    }

  LINE(296);
    { /* if */
    CLUREF T_1_1;
    err = c_envOPbuilding_specs(e, &T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    if (T_1_1.num == true) { /* if */

  LINE(297);
        {
        CLUREF T_2_1;
        err = c_envOPget_up_type(e, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        nt.num = T_2_1.num;
        }
    }
    else { /* else */

  LINE(298);
        {
        nt.num = cvt_.num;
        }
    }} /* end if */

  LINE(300);
    {
    CLUREF T_1_1;
    err = sequenceOPnew(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    xtypes.num = T_1_1.num;
    }

  LINE(301);
    {
    CLUREF T_1_1;
    err = sequenceOPnew(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    itypes.num = T_1_1.num;
    }

  LINE(302);
    { /* for sequence$indexes */
    CLUREF T_1_1;
    CLUREF T_1_2;
    T_1_2.num = types.vec->size;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        i.num = T_1_1.num;

  LINE(303);
        {
        CLUREF T_2_1;
        if (i.num < 1 || i.num > types.vec->size) {
            err = ERR_bounds;
            goto ex_0;
        }
        T_2_1.num = types.vec->data[i.num - 1];
        t.num = T_2_1.num;
        }

  LINE(305);
        { /* if */
        CLUREF T_2_1;
        err = typespecOPequal(t, cvt_, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        if (T_2_1.num == true) { /* if */

  LINE(306);
            {
            xt.num = nt.num;
            }
        }
        else { /* else */

  LINE(307);
            {
            CLUREF T_3_1;
            err = c_type(e, t, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            t.num = T_3_1.num;
            }

  LINE(308);
            {
            xt.num = t.num;
            }
        }} /* end if */

  LINE(310);
        {
        CLUREF T_2_1;
        err = sequenceOPaddh(xtypes, xt, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        xtypes.num = T_2_1.num;
        }

  LINE(311);
        {
        CLUREF T_2_1;
        err = sequenceOPaddh(itypes, t, &T_2_1);
        if (err != ERR_ok)
            goto ex_0;
        itypes.num = T_2_1.num;
        }
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(313);
    { /* return */
    {
    ret_1->num = xtypes.num;
    }
    {
    ret_2->num = itypes.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE c_typelist1 ****/



/**** BEGIN PROCEDURE c_exceptionlist1 ****/


errcode
c_exceptionlist1(CLUREF e, CLUREF sigs, CLUREF *ret_1)
{
    errcode err;
    CLUREF nsigs;
    CLUREF sig;
    CLUREF types;
    CLUREF itypes;
    enter_proc(316);

  LINE(317);
    {
    CLUREF T_1_1;
    err = sequenceOPnew(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    nsigs.num = T_1_1.num;
    }

  LINE(318);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = sigs.vec->size;
    T_1_3 = sigs;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        sig.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(319);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        T_2_1.num = sig.vec->data[1];
        err = c_typelist1(e, T_2_1, &T_2_2, &T_2_3);
        if (err != ERR_ok)
            goto ex_0;
        types.num = T_2_2.num;
        itypes.num = T_2_3.num;
        }

  LINE(320);
        {
        sig.vec->data[1] = itypes.num;
        }

  LINE(321);
        {
        CLUREF T_2_1;
        CLUREF T_2_2;
        CLUREF T_2_3;
        RecordAlloc(2, T_2_1);
        T_2_2.num = sig.vec->data[0];
        T_2_1.vec->data[0] = T_2_2.num;
        T_2_1.vec->data[1] = types.num;
        err = sequenceOPaddh(nsigs, T_2_1, &T_2_3);
        if (err != ERR_ok)
            goto ex_0;
        nsigs.num = T_2_3.num;
        }
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(324);
    { /* return */
    {
    ret_1->num = nsigs.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE c_exceptionlist1 ****/



/**** BEGIN PROCEDURE c_oper_requires ****/

extern errcode c_add_opspecs();
extern errcode c_new_requires();

errcode
c_oper_requires(CLUREF e, CLUREF reqs, CLUREF parms, CLUREF *ret_1)
{
    errcode err;
    CLUREF xreqs;
    CLUREF req;
    CLUREF i;
    CLUREF rk;
    CLUREF opers;
    enter_proc(327);

  LINE(329);
    {
    CLUREF T_1_1;
    err = sequenceOPnew(&T_1_1);
    if (err != ERR_ok)
        goto ex_0;
    xreqs.num = T_1_1.num;
    }

  LINE(330);
    { /* for sequence$elements */
    CLUREF T_1_1;
    CLUREF T_1_2;
    CLUREF T_1_3;
    T_1_2.num = reqs.vec->size;
    T_1_3 = reqs;
    for (T_1_1.num = 1; T_1_1.num <= T_1_2.num; T_1_1.num++) {
        req.num = T_1_3.vec->data[T_1_1.num - 1];

  LINE(331);
        {
        CLUREF T_2_1;
        T_2_1.num = req.vec->data[0];
        i.num = T_2_1.num;
        }

  LINE(332);
        { /* qtagcase */
        CLUREF T_2_1;
        T_2_1.num = req.vec->data[1];
        switch (T_2_1.cell->tag) {
        case 1: /* has_ */ {
            CLUREF T_2_2;
            T_2_2.num = T_2_1.cell->value;
            rk.num = T_2_2.num;

  LINE(334);
            { /* if */
            CLUREF T_3_1;
            err = c_member(i, parms, &T_3_1);
            if (err != ERR_ok)
                goto ex_0;
            if (T_3_1.num == true) { /* if */

  LINE(335);
                {
                err = c_add_opspecs(e, i, rk);
                if (err != ERR_ok)
                    goto ex_0;
                }
            }
            else { /* else */

  LINE(336);
                {
                CLUREF T_4_1;
                CLUREF T_4_2;
                err = sequenceOPnew(&T_4_1);
                if (err != ERR_ok)
                    goto ex_0;
                err = c_new_requires(T_4_1, rk, &T_4_2);
                if (err != ERR_ok)
                    goto ex_0;
                opers.num = T_4_2.num;
                }

  LINE(338);
                {
                CLUREF T_4_1;
                CLUREF T_4_2;
                RecordAlloc(2, T_4_1);
                T_4_1.vec->data[1] = i.num;
                T_4_1.vec->data[0] = opers.num;
                err = sequenceOPaddh(xreqs, T_4_1, &T_4_2);
                if (err != ERR_ok)
                    goto ex_0;
                xreqs.num = T_4_2.num;
                }
            }} /* end if */
            break;
        }
        }
        } /* end qtagcase */
    }
    }
    end_inline_for_1:
    __CLU_END_LABEL;

  LINE(345);
    { /* return */
    {
    ret_1->num = xreqs.num;
    }
    signal (ERR_ok);
    }

    goto end_0;
  ex_0:
    __CLU_EX_HANDLER;
    if (err != ERR_failure)
        elist[0] = _pclu_erstr(err);
    signal(ERR_failure);
  end_0:
    elist[0] = no_return_values_STRING;
    signal(ERR_failure);
}

/**** END PROCEDURE c_oper_requires ****/

